openapi: 3.0.0
info:
  title: NetBackup Security API
  version: '12.0'
  description: >
    The NetBackup Security APIs provide access to the security-related resources
    of NetBackup. These APIs manage authorization tokens, host ID-based
    certificates, security configuration options, and auditing.
externalDocs:
  description: Getting Started Guide
  url: >-
    http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started/
servers:
  - url: 'https://<masterserver>:1556/netbackup'
    description: NetBackup Master
paths:
  /security/auditlogs:
    get:
      description: >
        Views the NetBackup audit logs.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|AUDIT-LOGS|`\

        Requires Operation: `|OPERATIONS|VIEW|`
      tags:
        - Audit Logs
      parameters:
        - name: filter
          description: >
            Filter criteria syntax is based on OData standards. Filtering is
            supported on the following attributes:

            |Name|Supported Operators|Description|Schema|

            |---|---|---|---|

            |id|eq ne lt gt le ge|The audit ID|integer|

            |category|eq ne|The category of audit record|string|

            |operation|eq ne|The operation on audit record|string|

            |userName|eq ne|The name of the user|string|

            |domainName|eq ne|The domain name of the user|string|

            |auditDateTime|lt gt|The audited date time of the audit
            record.|date-time|
          in: query
          required: false
          schema:
            type: string
        - name: 'page[offset]'
          description: The audit record number offset.
          in: query
          required: false
          schema:
            type: integer
        - name: 'page[limit]'
          description: The number of records on one page after the offset.
          in: query
          required: false
          schema:
            type: integer
        - name: sort
          description: >
            Sorts values of the specified property in ascending order. Use
            `-sort` to sort the values in descending order.
          in: query
          required: false
          schema:
            type: string
      responses:
        '200':
          description: The list of audit records.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: &ref_110
                type: object
                properties:
                  links:
                    type: object
                    properties:
                      self:
                        type: object
                        properties:
                          href:
                            type: string
                      next:
                        type: object
                        properties:
                          href:
                            type: string
                      prev:
                        type: object
                        properties:
                          href:
                            type: string
                      first:
                        type: object
                        properties:
                          href:
                            type: string
                      last:
                        type: object
                        properties:
                          href:
                            type: string
                  data:
                    type: array
                    items: &ref_1
                      type: object
                      properties:
                        type:
                          type: string
                          description: The response for audit.
                          enum:
                            - audit
                        id:
                          type: string
                        links:
                          type: object
                          properties:
                            self: &ref_215
                              type: object
                              properties:
                                href:
                                  type: string
                        attributes: &ref_114
                          type: object
                          properties:
                            messageId:
                              type: integer
                              description: The UMI message ID of the fetched audit record.
                            category:
                              type: string
                              description: >-
                                The resolved category value from the categoryId
                                field.
                              enum:
                                - GENERAL
                                - POLICY
                                - AUDITCFG
                                - JOB
                                - AUDITSVC
                                - STU
                                - POOL
                                - STORAGESRV
                                - BPCONF
                                - AUDITDB
                                - HOLD
                                - USER
                                - AZFAILURE
                                - CATALOG
                                - TOKEN
                                - CERT
                                - LOGIN
                                - SEC_CONFIG
                                - HOST
                                - CONNECTION
                                - DATAACCESS
                                - SLOENGINE
                                - CONFIG
                                - ALERT
                                - RETENTION_LEVEL
                                - SLP
                                - LICENSING
                                - ASSET
                                - ASSETGROUP
                                - DISCOVERY
                                - CREDENTIALS
                                - EVENT_LOG
                                - CREDENTIAL_SCHEMA
                                - ANOMALY
                                - BMR
                                - UI_CONFIG
                                - ANOMALY_NEW
                                - MALWARE_SCAN_TRIGGER
                                - MALWARE_SCAN_STATUS
                                - MALWARE_IMPACTED
                                - PAUSED_CLIENTS
                                - EVENT_AUDIT
                                - ECMS
                                - AUDIT_LOG_FORWARD
                                - IRE
                                - ANOMALY_EXTENSIONS
                                - ANOMALY_EXTENSIONS_DETAILS
                                - ANOMALY_RULES_RESULTS
                                - MALWARE_SCAN_CANCELLATION_TRIGGER
                                - MALWARE_SCAN_RESUMED
                                - MALWARE_SCAN_RESULT_DELETED
                                - MALWARE_SCAN_HOST_STATE_MODIFIED
                                - MALWARE_SCAN_HOST_ADDED_TO_SH_POOL
                                - MALWARE_SCAN_HOST_REMOVED_FR_SH_POOL
                            operation:
                              type: string
                              description: >-
                                The resolved operation value from the
                                operationId field.
                              enum:
                                - GENERAL
                                - CREATE
                                - MODIFY
                                - DELETE
                                - START
                                - STOP
                                - CANCEL
                                - RESUME
                                - ACCESS
                                - ENROLL
                            message:
                              type: string
                              description: >-
                                The resolved message value from the messageId
                                UMI.
                            reason:
                              type: string
                              description: The reason value of the audit record.
                            auditDateTime:
                              type: string
                              format: date-time
                              description: >-
                                A UTC timestamp of audit when the record was
                                created.
                            auditKeyList:
                              type: array
                              items: &ref_115
                                type: object
                                properties:
                                  typeId:
                                    type: integer
                                    description: The data type of the placeholder.
                                  typeIdDisplayString:
                                    type: string
                                    description: >-
                                      The value of the placeholder for the audit
                                      description message.
                              description: The list of the audit placeholder values.
                            auditRecordAttributeList:
                              type: array
                              items: &ref_116
                                type: object
                                properties:
                                  oldValue:
                                    type: string
                                    description: The old field value of the audit record.
                                  newValue:
                                    type: string
                                    description: The new field value of the audit record.
                                  oldValueDisplayString:
                                    type: string
                                    description: The resolved old value.
                                  newValueDisplayString:
                                    type: string
                                    description: The resolved new value.
                                  typeId:
                                    type: integer
                                    description: The data type of the audit record.
                                  attributeName:
                                    type: string
                                    description: The attribute name.
                                  attributeId:
                                    type: string
                                    description: The attribute ID.
                              description: The list of the audit record attributes.
                            auditUserIdentity:
                              type: object
                              items: &ref_117
                                type: object
                                required:
                                  - userName
                                  - domainName
                                  - domainType
                                properties:
                                  userName:
                                    type: string
                                    description: The name of the user.
                                  domainName:
                                    type: string
                                    description: The domain name of the user.
                                  domainType:
                                    type: string
                                    description: The domain type of the user.
                                    enum:
                                      - INVALID
                                      - ACTIVE_DIRECTORY
                                      - NIS_PLUS
                                      - VXAT_PRIVATE
                                      - UNIX_PASSWORD
                                      - LDAP
                                      - NIS
                                      - LOCAL_HOST
                                      - UNRECOGNIZED_VALUE
                              description: User information.
                    description: The list of audit record details.
                  meta:
                    type: object
                    properties:
                      pagination:
                        type: object
                        properties:
                          prev:
                            type: integer
                          next:
                            type: integer
                          first:
                            type: integer
                          last:
                            type: integer
                          count:
                            type: integer
                          page:
                            type: integer
                          offset:
                            type: integer
                          pages:
                            type: integer
                          limit:
                            type: integer
                example:
                  links:
                    self:
                      href: >-
                        /security/auditlogs?page[offset]=0&page[limit]=10&sort
                        =-auditDateTime
                    next:
                      href: >-
                        /security/auditlogs?page[offset]=10&page[limit]=10&sort=-auditDateTime
                    prev:
                      href: >-
                        /security/auditlogs?page[offset]=10&page[limit]=10&sort=-auditDateTime
                    first:
                      href: >-
                        /security/auditlogs?page[offset]=0&page[limit]=10&sort=-auditDateTime
                    last:
                      href: >-
                        /security/auditlogs?page[offset]=70&page[limit]=10&sort=-auditDateTime
                  data:
                    - type: audit
                      id: 2
                      links:
                        self:
                          href: /security/auditlogs/2
                      attributes:
                        messageId: 1401
                        category: LOGIN
                        operation: ACCESS
                        message: User 'Administrator' authenticated successfully
                        reason: ''
                        auditDateTime: 2019-07-08T13:10:01.486Z
                        auditKeyList:
                          - typeId: 1
                            typeIdDisplayString: Administrator
                        auditRecordAttributeList:
                          - oldValue: ''
                            newValue: '2'
                            oldValueDisplayString: ''
                            newValueDisplayString: Master Server
                            typeId: 2
                            attributeName: Host Type
                            attributeId: __UMI__1102
                        auditUserIdentity:
                          - userName: Administrator
                            domainName: win-teporqd6k6p
                            domainType: LOCAL_HOST
                  meta:
                    pagination:
                      prev: 0
                      next: 10
                      first: 0
                      last: 70
                      count: 0
                      page: 0
                      offset: 0
                      pages: 8
                      limit: 0
            application/vnd.netbackup+ocsf+json;version=12.0:
              schema: &ref_106
                type: object
                properties:
                  links:
                    type: object
                    properties:
                      self:
                        type: object
                        properties:
                          href:
                            type: string
                      next:
                        type: object
                        properties:
                          href:
                            type: string
                      prev:
                        type: object
                        properties:
                          href:
                            type: string
                      first:
                        type: object
                        properties:
                          href:
                            type: string
                      last:
                        type: object
                        properties:
                          href:
                            type: string
                  data:
                    type: array
                    items: &ref_107
                      type: object
                      properties:
                        attributes: &ref_108
                          type: object
                          properties:
                            activity_id:
                              type: integer
                              description: >-
                                The normalized identifier of the activity that
                                triggered the event.
                            category_uid:
                              type: integer
                              description: The unique identifier of the event category.
                            class_uid:
                              type: integer
                              description: >-
                                The unique identifier of the class of event
                                attributes.
                            time:
                              type: string
                              description: The normalized event occurrence time.
                            message:
                              type: string
                              description: >-
                                The description of the event, as defined by the
                                event source.
                            severity_id:
                              type: integer
                              description: The normalized identifier of the event severity.
                            status_id:
                              type: integer
                              description: The normalized identifier of the event status.
                            type_uid:
                              type: integer
                              description: >-
                                The event type ID. It identifies the event's
                                semantics and structure.
                            metadata:
                              type: object
                              description: The metadata associated with the event.
                              properties:
                                product:
                                  type: object
                                  description: The product that reported the event.
                                  properties:
                                    name:
                                      type: string
                                      description: The name of the product as NetBackup.
                                    verison:
                                      type: string
                                      description: >-
                                        The version of NetBackup that generated
                                        the event.
                                    vendor_name:
                                      type: string
                                      description: >-
                                        The vendor name of the product as
                                        Vertias Technologies.
                                version:
                                  type: string
                                  description: The version of the OCSF schema.
                            enrichments:
                              type: array
                              items: &ref_109
                                type: object
                                properties:
                                  oldValue:
                                    type: string
                                    description: The old field value of the audit record.
                                  newValue:
                                    type: string
                                    description: The new field value of the audit record.
                                  oldValueDisplayString:
                                    type: string
                                    description: The resolved old value.
                                  newValueDisplayString:
                                    type: string
                                    description: The resolved new value.
                                  typeId:
                                    type: integer
                                    description: The data type of the audit record.
                                  attributeName:
                                    type: string
                                    description: The attribute name.
                                  attributeId:
                                    type: string
                                    description: The attribute ID.
                                  name:
                                    type: string
                                    description: >-
                                      The name of the attribute to which the
                                      enriched data pertains.
                                  value:
                                    type: string
                                    description: >-
                                      The value of the attribute to which the
                                      enriched data pertains.
                    description: The list of Ocsf formatted audit record details.
                  meta:
                    type: object
                    properties:
                      pagination:
                        type: object
                        properties:
                          prev:
                            type: integer
                          next:
                            type: integer
                          first:
                            type: integer
                          last:
                            type: integer
                          count:
                            type: integer
                          page:
                            type: integer
                          offset:
                            type: integer
                          pages:
                            type: integer
                          limit:
                            type: integer
        '400': &ref_5
          description: Bad request.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: &ref_0
                type: object
                properties:
                  errorCode:
                    type: integer
                    format: int64
                    description: The NetBackup error code.
                  errorMessage:
                    type: string
                    description: The NetBackup error code description.
                  attributeErrors:
                    type: object
                    description: >
                      Maps the attributes with the invalid values to an error
                      that describes why the value is invalid, to provide more
                      context to the nature of the error.
                  errorDetails:
                    type: array
                    description: >-
                      A list that contains additional information about the
                      error.
                    items:
                      type: string
                  fileUploadErrors:
                    type: array
                    description: >
                      If an API is supporting content-type multipart/form-data,
                      then this holds a list of objects that contains names of
                      failed files and associated error messages.
                    items:
                      type: object
                required:
                  - errorCode
                  - errorMessage
        '401': &ref_2
          description: >
            The `Authorization` header is missing, the token is invalid, or you
            do not have permission for this action.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_0
        '406': &ref_3
          description: >-
            Invalid `Accept` type. Make sure your `Accept` header matches what
            this API produces.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_0
        '500': &ref_4
          description: An unexpected system error occurred.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_0
  '/security/auditlogs/{auditId}':
    get:
      description: >
        Retrieve the NetBackup audit record for the specified audit Id.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|AUDIT-LOGS|`\

        Requires Operation: `|OPERATIONS|VIEW|`
      tags:
        - Audit Logs
      parameters:
        - name: auditId
          description: The auditId is the unique identifier of audit
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Successfully fetched the audit record for the specified auditId.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: &ref_111
                type: object
                description: A single record of unique audit event.
                properties:
                  data: *ref_1
                example:
                  data:
                    type: audit
                    id: 2
                    links:
                      self:
                        href: /security/auditlogs/2
                    attributes:
                      messageId: 1401
                      category: LOGIN
                      operation: ACCESS
                      message: User 'Administrator' authenticated successfully
                      reason: ''
                      auditDateTime: 2019-07-08T13:10:01.486Z
                      auditKeyList:
                        - typeId: 1
                          typeIdDisplayString: Administrator
                      auditRecordAttributeList:
                        - oldValue: ''
                          newValue: '2'
                          oldValueDisplayString: ''
                          newValueDisplayString: Master Server
                          typeId: 2
                          attributeName: Host Type
                          attributeId: __UMI__1102
                      auditUserIdentity:
                        - userName: Administrator
                          domainName: win-teporqd6k6p
                          domainType: LOCAL_HOST
        '401': *ref_2
        '404':
          description: No audit record found for the specified auditId.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_0
        '406': *ref_3
        '500': *ref_4
  /security/logindetails:
    get:
      description: >
        Views the audit logs that are specific to the NetBackup login audit
        records.


        **Access Control**\

        Enforcement Type: `None`
      tags:
        - Audit Logs
      parameters:
        - name: filter
          description: >
            Filter criteria syntax is based on OData standards. Filtering is
            supported on the following attributes:

            |Name|Supported Operators|Description|Schema|

            |---|---|---|---|

            |id|eq ne lt gt le ge|The audit ID|integer|

            |auditDateTime|lt gt|The audited date time of the audit
            record.|date-time|
          in: query
          required: false
          schema:
            type: string
        - name: 'page[offset]'
          description: The audit record number offset.
          in: query
          required: false
          schema:
            type: integer
        - name: 'page[limit]'
          description: The number of records on one page after the offset.
          in: query
          required: false
          schema:
            type: integer
        - name: sort
          description: >
            Sorts values of the specified property in ascending order. Use
            `-sort` to sort the values in descending order.
          in: query
          required: false
          schema:
            type: string
      responses:
        '200':
          description: The list of audit records related with user login activity.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: &ref_112
                type: object
                properties:
                  links:
                    type: object
                    properties:
                      self:
                        type: object
                        properties:
                          href:
                            type: string
                      next:
                        type: object
                        properties:
                          href:
                            type: string
                      prev:
                        type: object
                        properties:
                          href:
                            type: string
                      first:
                        type: object
                        properties:
                          href:
                            type: string
                      last:
                        type: object
                        properties:
                          href:
                            type: string
                  data:
                    type: array
                    items: *ref_1
                    description: The list of audit record details.
                  meta:
                    type: object
                    properties:
                      pagination:
                        type: object
                        properties:
                          prev:
                            type: integer
                          next:
                            type: integer
                          first:
                            type: integer
                          last:
                            type: integer
                          count:
                            type: integer
                          page:
                            type: integer
                          offset:
                            type: integer
                          pages:
                            type: integer
                          limit:
                            type: integer
                example:
                  links:
                    self:
                      href: >-
                        /security/logindetails?page[offset]=0&page[limit]=10&sort
                        =-auditDateTime
                    next:
                      href: >-
                        /security/logindetails?page[offset]=10&page[limit]=10&sort=-auditDateTime
                    prev:
                      href: >-
                        /security/logindetails?page[offset]=10&page[limit]=10&sort=-auditDateTime
                    first:
                      href: >-
                        /security/logindetails?page[offset]=0&page[limit]=10&sort=-auditDateTime
                    last:
                      href: >-
                        /security/logindetails?page[offset]=70&page[limit]=10&sort=-auditDateTime
                  data:
                    - type: audit
                      id: 2
                      links:
                        self:
                          href: /security/logindetails/2
                      attributes:
                        messageId: 1401
                        category: LOGIN
                        operation: ACCESS
                        message: User 'Administrator' authenticated successfully
                        reason: ''
                        auditDateTime: 2019-07-08T13:10:01.486Z
                        auditKeyList:
                          - typeId: 1
                            typeIdDisplayString: Administrator
                        auditRecordAttributeList:
                          - oldValue: ''
                            newValue: '2'
                            oldValueDisplayString: ''
                            newValueDisplayString: Master Server
                            typeId: 2
                            attributeName: Host Type
                            attributeId: __UMI__1102
                        auditUserIdentity:
                          - userName: Administrator
                            domainName: win-teporqd6k6p
                            domainType: LOCAL_HOST
                  meta:
                    pagination:
                      prev: 0
                      next: 10
                      first: 0
                      last: 70
                      count: 0
                      page: 0
                      offset: 0
                      pages: 8
                      limit: 0
        '400': *ref_5
        '401': *ref_2
        '406': *ref_3
        '500': *ref_4
  '/security/logindetails/{auditId}':
    get:
      description: |
        Get the login audit record based on specified auditId.

        **Access Control**\
        Enforcement Type: `None`
      tags:
        - Audit Logs
      parameters:
        - name: auditId
          description: The auditId is the unique identifier of audit record.
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: >-
            Successfully fetched the login audit record details for the
            specified auditId.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: &ref_113
                type: object
                description: A record of login category.
                properties:
                  data: *ref_1
                example:
                  data:
                    type: audit
                    id: 2
                    links:
                      self:
                        href: /security/logindetails/2
                    attributes:
                      messageId: 1401
                      category: LOGIN
                      operation: ACCESS
                      message: User 'Administrator' authenticated successfully
                      reason: ''
                      auditDateTime: 2019-07-08T13:10:01.486Z
                      auditKeyList:
                        - typeId: 1
                          typeIdDisplayString: Administrator
                      auditRecordAttributeList:
                        - oldValue: ''
                          newValue: '2'
                          oldValueDisplayString: ''
                          newValueDisplayString: Master Server
                          typeId: 2
                          attributeName: Host Type
                          attributeId: __UMI__1102
                      auditUserIdentity:
                        - userName: Administrator
                          domainName: win-teporqd6k6p
                          domainType: LOCAL_HOST
        '401': *ref_2
        '404':
          description: No audit record found.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_0
        '406': *ref_3
        '500': *ref_4
  /security/cacert:
    get:
      description: >
        Returns the certificate of the NetBackup web service certificate
        authority(CA) and the list of certificates of

        the NetBackup CA in the pem formatted string as well as extracted
        details from these certificates. Each

        NetBackup host must establish trust with the NetBackup web service CA
        before it can make secure calls to

        NetBackup APIs.


        **Access Control**\

        Enforcement Type: `None`
      tags:
        - Certificates
      security: []
      responses:
        '200':
          description: 'On successful response, the CA certificate is sent.'
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: &ref_118
                type: object
                properties:
                  trustVersion:
                    type: string
                    description: >
                      Trust version maintained by NetBackup master, which is
                      updated with every new CA being added or existing CA being
                      revoked.   
                  webRootCertificateData:
                    type: array
                    items: &ref_119
                      type: object
                      required:
                        - caCertDetails
                      properties:
                        caCertDetails: &ref_6
                          type: object
                          properties:
                            subjectCN:
                              type: string
                              description: The subject common name (CN)
                            serialNumber: &ref_7
                              type: integer
                              description: The serial number of the certificate.
                            notBefore:
                              type: string
                              format: date-time
                              description: >-
                                Gets the date and time on which a certificate
                                becomes valid.
                            notAfter:
                              type: string
                              format: date-time
                              description: >-
                                Gets the date and time after which a certificate
                                is no longer valid.
                            subjectOU:
                              type: string
                              description: The subject Organizational Unit (OU)
                            subjectName:
                              type: string
                              description: Complete subject name.
                            fingerprint:
                              type: string
                              description: >
                                A certificate's SHA-1 fingerprint is the unique
                                identifier of the certificate. It is a digest
                                (hash function) of a certificate in x509 binary
                                format calculated using SHA1 algorithm.
                            sha-256Fingerprint:
                              type: string
                              description: >
                                A certificate's SHA-256 fingerprint is the
                                unique identifier of the certificate. It is a
                                digest (hash function) of a certificate in x509
                                binary format calculated using SHA256 algorithm.
                        caCert:
                          type: string
                          description: >
                            An x.509 certificate in a PEM-formatted string. This
                            field is optional.  It will be sent when the
                            caCertAction is ADD and its value will stored on the
                            NetBackup host. This field will not be sent when
                            caCertAction is REMOVE, as the fingerprint sent as a
                            part of caCertDetails should be used to remove the
                            CA certificate from the trust store of the NetBackup
                            host.
                  caCertificateData:
                    type: array
                    items: &ref_120
                      type: object
                      required:
                        - caCertAction
                        - caCertDetails
                      properties:
                        caCertAction: &ref_141
                          type: string
                          description: >
                            The action to be taken for the CA certificate with
                            respect to adding or removing

                            it from the trust store of a NetBackup host.
                          enum:
                            - ADD
                            - REMOVE
                        caCertDetails: *ref_6
                        caCert:
                          type: string
                          description: >
                            An x.509 certificate in a PEM-formatted string. This
                            field is optional.  It will be sent when the
                            caCertAction is ADD and its value will stored on the
                            NetBackup host. This field will not be sent when
                            caCertAction is REMOVE, as the fingerprint sent as a
                            part of caCertDetails should be used to remove the
                            CA certificate from the trust store of the NetBackup
                            host.
                    description: >-
                      A list of certificates of the NetBackup certificate
                      authority (VxAT) in a PEM-formatted string.
                required:
                  - webRootCertificateData
                  - caCertificateData
        '406': *ref_3
  /security/certificates/current:
    get:
      description: >
        Returns the list of details for the latest certificate for each host
        from the certificate database.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|CERTIFICATE-MANAGEMENT|NETBACKUP-CERTIFICATES|`\

        Requires Operation: `|OPERATIONS|VIEW|`
      tags:
        - Certificates
      responses:
        '200':
          description: >-
            On successful response, the list of details for the latest
            certificate for each host is sent.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: &ref_136
                type: object
                properties:
                  certificateList:
                    type: array
                    items: &ref_10
                      type: object
                      properties:
                        certificateKey:
                          type: integer
                          description: For internal use.
                        hostId: &ref_57
                          type: string
                          description: The unique ID assigned to the NetBackup host.
                        hostName: &ref_121
                          type: string
                          description: >-
                            The name of the host for which the certificate is
                            issued or is to be issued.
                        serialNumber: *ref_7
                        notBefore: &ref_8
                          type: integer
                          format: int64
                          description: >-
                            The number of milliseconds since the Epoch,
                            1970-01-01 00:00:00 +0000.
                        notAfter: *ref_8
                        tokenType: &ref_139
                          type: integer
                          description: >
                            Indicates the type of token that was used to issue
                            the certificate or the scenario in which the
                            certificate was

                            issued. Here are the defined values for token types:

                            0 - No token.

                            1 - Single-use token.

                            2 - Multi-use token.

                            3 - Reissue token.

                            Here are the defined values based on these
                            scenarios.

                            4 - Certificate renewal.

                            5 - Auto created (catalog recovery).
                        state: &ref_140
                          type: integer
                          description: >
                            The certificate state. Here are the defined values
                            for the certificate state:

                            1 - Active.

                            2 - Revoked.
                        publicKey:
                          type: string
                          description: >-
                            The public key of the host for which the certificate
                            is issued.
                        keySize:
                          type: integer
                          description: Key size of the Certificate.
                        revocationReason: &ref_9
                          type: integer
                          description: >
                            The reason for a certificate revocation. Here are
                            the defined values for the revocation reason:

                            0 = Unspecified.

                            1 = Key Compromise.

                            2 = CA Compromise.

                            3 = Affiliation Changed.

                            4 = Superseded.

                            5 = Cessation Of Operation.

                            6 = Certificate Hold.

                            7 = Others.
                        hostType: &ref_142
                          type: integer
                          description: >
                            The type of host (server or client). Here are the
                            defined values for the host type:

                            0 - Unknown.

                            1 - Server.

                            2 - Client.
                        createOn: *ref_8
                        updatedOn: *ref_8
                      required:
                        - certificateKey
                        - hostId
                        - hostName
                        - serialNumber
                        - notBefore
                        - notAfter
                        - state
                        - publicKey
                        - revocationReason
                        - hostType
                        - createOn
                        - updatedOn
                    description: A list of certificate details.
                required:
                  - certificateList
        '401': *ref_2
        '406': *ref_3
  /security/certificates/revoke:
    post:
      description: >
        Revokes the NetBackup host ID-based certificate for the specified host
        ID.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|CERTIFICATE-MANAGEMENT|NETBACKUP-CERTIFICATES|`\

        Requires Operation:
        `|OPERATIONS|SECURITY|CERTIFICATE-MANAGEMENT|NETBACKUP-CERTIFICATES|REVOKE|`
      tags:
        - Certificates
      parameters:
        - name: hostId
          in: query
          required: true
          description: The unique ID assigned to the NetBackup host.
          schema:
            type: string
      requestBody: &ref_105
        content:
          application/vnd.netbackup+json;version=12.0:
            schema: &ref_143
              type: object
              properties:
                revocationReason: *ref_9
        description: The reason for a certification revocation.
      responses:
        '200':
          description: Request successful.
        '400':
          description: >
            Bad request. The request contains an invalid parameter, or the
            certificate has already been revoked.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_0
        '401': *ref_2
        '404':
          description: The specified host was not found.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_0
        '415': &ref_11
          description: >
            Unsupported Media Type. The media type specified in the
            `Content-Type` header is not supported by this API.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_0
  '/security/certificates/{serialNumber}':
    get:
      description: >
        Returns the certificate details of the certificate with the specified
        serial number.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|CERTIFICATE-MANAGEMENT|NETBACKUP-CERTIFICATES|`\

        Requires Operation: `|OPERATIONS|VIEW|`
      tags:
        - Certificates
      parameters:
        - name: serialNumber
          in: path
          required: true
          description: The serial number of the certificate.
          schema:
            type: string
      responses:
        '200':
          description: 'On successful response, the certificate details are sent.'
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_10
        '401': *ref_2
        '404':
          description: The certificate entry does not exist.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_0
        '406': *ref_3
  /security/certificates/crl:
    get:
      description: >
        Returns the latest Certificate Revocation List (CRL) as a DER-encoded
        file. The file conforms to the standard

        X.509 CRL format and semantics.


        **Access Control**\

        Enforcement Type: `None`
      tags:
        - Certificates
      security: []
      responses:
        '200':
          description: 'On successful response, the latest CRL file is sent.'
          content:
            application/pkix-crl:
              schema:
                type: string
                format: binary
        '406': *ref_3
        '500':
          description: >-
            There was an internal error with output of the Certificate
            Revocation List (CRL).
          content:
            application/pkix-crl:
              schema:
                type: string
        '503':
          description: 'Not found, the CRL is not generated yet.'
          headers:
            Retry-After:
              schema:
                type: integer
          content:
            application/pkix-crl:
              schema:
                type: string
  /security/domains/vxat:
    get:
      description: >
        Retrieves the list of all the domains that are configured with Veritas
        NetBackup Authentication Service (AT).


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|IDP|`\

        Requires Operation: `|OPERATIONS|VIEW|`
      tags:
        - Domains
      responses:
        '200':
          description: >
            Retrieved the list of all the domains that are configured with
            Veritas NetBackup Authentication Service (AT) successfully.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: &ref_127
                type: object
                properties:
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        type:
                          type: string
                          description: The resource type. This must be set to "domain".
                        id:
                          type: string
                          description: The name of the domain.
                        links:
                          type: object
                          description: >-
                            A list of URIs to get more information about each
                            domain.
                          properties:
                            self:
                              type: object
                              properties:
                                href:
                                  type: string
                                  description: A link to get the domain details.
                        attributes:
                          type: object
                          properties:
                            domainType:
                              type: string
                              description: The domain type.
                              enum:
                                - LDAP_DOMAIN
                required:
                  - data
                example:
                  data:
                    - type: domain
                      id: myDomain1
                      attributes:
                        domainType: LDAP_DOMAIN
                      links:
                        self:
                          href: /security/domains/myDomain1
                    - type: domain
                      id: myDomain2
                      attributes:
                        domainType: LDAP_DOMAIN
                      links:
                        self:
                          href: /security/domains/myDomain2
        '401': *ref_2
        '406': *ref_3
        '415': *ref_11
        '500': *ref_4
        '503': &ref_13
          description: The server is busy.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_0
    post:
      description: >
        Adds a new domain to the Veritas NetBackup Authentication Service (AT).
        Currently, only ldap-domain is supported.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|IDP|`\

        Requires Operation: `|OPERATIONS|ADD|`
      tags:
        - Domains
      requestBody:
        content:
          application/vnd.netbackup+json;version=12.0:
            schema: &ref_12
              type: object
              properties:
                data:
                  type: object
                  properties:
                    type:
                      type: string
                      description: The resource type. This must be set to "domain".
                    links:
                      type: object
                      properties:
                        self:
                          type: object
                          properties:
                            href:
                              type: string
                              description: The URI to get the details of the domain.
                    id:
                      description: The name of the domain.
                      type: string
                    attributes:
                      type: object
                      description: The attributes of the domain.
                      properties:
                        domainType:
                          type: string
                          description: >
                            The type of the domain. Currently only "LDAP_DOMAIN"
                            is supported.
                          enum:
                            - LDAP_DOMAIN
                        ldapDomain: &ref_128
                          type: object
                          description: >
                            The LDAP domain configuration settings. To configure
                            an Active Directory domain, the schema type can be
                            'msad' (Microsoft Active Directory), rfc2307 or no
                            specified type. For `msad` (Microsoft Active
                            Directory) and rfc2307 only the required attributes
                            must be included. For `non specified schema's LDAP
                            servers, all the attributes must be included.
                          properties:
                            attributes:
                              type: object
                              properties:
                                serverURL:
                                  description: >
                                    The server URL of the LDAP directory. The
                                    URL must start with either "ldap://" or
                                    "ldaps://". "ldaps://" indicates that the
                                    server requires an SSL connection.
                                  type: string
                                isSecureConnection:
                                  description: >-
                                    Flag to indicate whether the connection to
                                    the LDAP server is secure or insecure.
                                  type: boolean
                                trustedCACert:
                                  description: >
                                    The trusted CA certificate in text format
                                    needs to be provided when the LDAP server
                                    URL starts with "ldaps://", "ldaps://
                                    indicates that the server requires an SSL
                                    connection.
                                  type: string
                                schemaType:
                                  description: >
                                    The type of LDAP schema to use. The LDAP
                                    schema can be any one of the following -
                                    `rfc2307`, `msad` or no specified schema
                                    type. If schema type is not specified, then
                                    all the attributes are required.
                                  type: string
                                adminUserDN:
                                  description: >
                                    Contains the distinguished name of the
                                    administrator or any user that has search
                                    permissions to the user container or user
                                    subtree.
                                  type: string
                                adminUserPassword:
                                  description: >-
                                    Contains the password for an administrator
                                    user.
                                  type: string
                                userBaseDN:
                                  description: >-
                                    The LDAP distinguished name for the user
                                    container.
                                  type: string
                                groupBaseDN:
                                  description: >-
                                    The LDAP distinguished name for the group
                                    container.
                                  type: string
                                disableTLSProtocol:
                                  type: string
                                  description: >
                                    Disables the specified and all the earlier
                                    versions of the TLS protocol. You must use
                                    this parameter when the LDAP server URL
                                    starts with ldaps://.
                                  default: TLSv1.1
                                cipherSuiteList:
                                  description: >
                                    List of TLS cipher suites. You must use this
                                    parameter when the LDAP server URL starts
                                    with ldaps://.
                                  default:
                                    - ECDHE-RSA-AES256-GCM-SHA384
                                    - DHE-RSA-AES256-GCM-SHA384
                                    - ECDHE-RSA-AES256-SHA384
                                    - ECDHE-RSA-AES256-SHA
                                    - DHE-RSA-AES256-SHA
                                  type: array
                                  items:
                                    type: string
                                domainSchema:
                                  type: object
                                  properties:
                                    userObjectClass:
                                      description: >-
                                        The LDAP object class for the user
                                        object.
                                      type: string
                                    userSearchAttribute:
                                      description: >-
                                        The user attribute within the user
                                        object class.
                                      type: string
                                    userGIDAttribute:
                                      description: >-
                                        The attribute within the user object
                                        class to retrieve the groups the user
                                        belongs to.
                                      type: string
                                    userDisplayNameAttribute:
                                      description: >-
                                        The attribute field to use when loading
                                        the user's full name.
                                      type: string
                                    userUniqueIDAttribute:
                                      description: >-
                                        The attribute used as a unique immutable
                                        identifier for user objects.
                                      type: string
                                    userDescriptionAttribute:
                                      description: >-
                                        The attribute field to use when loading
                                        the user's description.
                                      type: string
                                    groupObjectClass:
                                      description: >-
                                        The LDAP object class for the group
                                        object.
                                      type: string
                                    groupSearchAttribute:
                                      description: >-
                                        The group attribute within the group
                                        object class.
                                      type: string
                                    groupMembersAttribute:
                                      description: >-
                                        The attribute within the group object
                                        class to retrieve the group.
                                      type: string
                                    groupDisplayNameAttribute:
                                      description: >-
                                        The attribute field to use when loading
                                        the group's full name.
                                      type: string
                                    groupUniqueIDAttribute:
                                      description: >-
                                        The attribute used as a unique immutable
                                        identifier for group object.
                                      type: string
                                    groupDescriptionAttribute:
                                      description: >-
                                        The attribute field to use when loading
                                        the group's description.
                                      type: string
                              required:
                                - serverURL
                                - schemaType
                                - adminUserDN
                                - adminUserPassword
                                - userBaseDN
                                - groupBaseDN
                      required:
                        - domainType
                        - ldapDomain
                  required:
                    - type
                    - id
                    - attributes
              required:
                - data
              example:
                data:
                  type: domain
                  id: myDomain
                  attributes:
                    domainType: LDAP_DOMAIN
                    ldapDomain:
                      serverURL: 'ldaps://myServerUrl:port'
                      isSecureConnection: true
                      trustedCACert: |-
                        -----BEGIN CERTIFICATE-----
                        MIIF/DCCA+SgAgIJAI0wUAMIGKMQswCQYD
                        -----END CERTIFICATE-----
                      schemaType: rfc2307
                      adminUserDN: adminUserDN
                      adminUserPassword: adminUserPassword
                      userBaseDN: userBaseDN
                      groupBaseDN: groupBaseDN
                      authenticationType: BOB
                      searchScope: SUB
        description: >-
          The properties of the domain to be added in Veritas NetBackup
          Authentication Service (AT).
        required: true
      responses:
        '201':
          description: >-
            Created a domain entry in Veritas NetBackup Authentication Service
            (AT) successfully.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_12
        '400': *ref_5
        '401': *ref_2
        '409':
          description: The given domain already exists.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_0
        '415': *ref_11
        '500': *ref_4
        '503': *ref_13
  '/security/domains/vxat/{domainName}':
    get:
      description: >
        Retrieves the domain for the given domainName that is configured with
        Veritas NetBackup Authentication Service (AT).


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|IDP|`\

        Requires Operation: `|OPERATIONS|VIEW|`
      tags:
        - Domains
      parameters:
        - name: domainName
          in: path
          description: >-
            The name of the domain that is configured with Veritas NetBackup
            Authentication Service (AT).
          required: true
          schema:
            type: string
      responses:
        '200':
          description: >-
            Retrieved the given domain that is configured with Veritas NetBackup
            Authentication Service (AT).
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_12
        '401': *ref_2
        '404': &ref_14
          description: No entity found.
          content: &ref_89
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_0
        '406': *ref_3
        '415': *ref_11
        '500': *ref_4
        '503': *ref_13
    delete:
      description: >
        Deletes a domain that was configured with the Veritas NetBackup
        Authentication Service (AT).


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|IDP|`\

        Requires Operation: `|OPERATIONS|DELETE|`
      tags:
        - Domains
      parameters:
        - name: domainName
          in: path
          description: The name of the domain.
          required: true
          schema:
            type: string
      responses:
        '204':
          description: Successfully deleted the domain resource.
        '401': *ref_2
        '404': *ref_14
        '500': *ref_4
        '503': *ref_13
  /security/domains/vxat/validate:
    post:
      description: >
        Tests the connectivity to the domain server provided in the request
        body.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|IDP|`\

        Requires Operation: `|OPERATIONS|ADD|`
      tags:
        - Domains
      requestBody:
        content:
          application/vnd.netbackup+json;version=12.0:
            schema: &ref_129
              type: object
              properties:
                data:
                  type: object
                  properties:
                    type:
                      type: string
                      description: >-
                        The resource type. Must be set to
                        "validateDomainRequest".
                    id:
                      type: string
                      description: The name of the domain.
                    attributes:
                      type: object
                      description: The attrinutes of the domain.
                      properties:
                        domainType:
                          type: string
                          description: >
                            The type of the domain. Currently only "LDAP_DOMAIN"
                            is supported.
                          enum:
                            - LDAP_DOMAIN
                        ldapDomain:
                          type: object
                          properties:
                            serverURL:
                              type: string
                              description: The URL of the domain server.
                            adminUserDN:
                              type: string
                              description: >
                                Contains the distinguished name of the
                                administrator or any user that has search
                                permissions to the user container or user
                                subtree.
                            adminUserPassword:
                              type: string
                              description: Contains the password for an administrator user.
                          required:
                            - serverURL
                            - adminUserDN
                            - adminUserPassword
                      required:
                        - domainType
                        - ldapDomain
                  required:
                    - id
                    - type
                    - attributes
              required:
                - data
              example:
                data:
                  type: validateDomainRequest
                  id: myDomainServer
                  attributes:
                    domainType: LDAP_DOMAIN
                    ldapDomain:
                      serverURL: 'ldap://myServerUrl:port'
                      adminUserDN: myAdminUserDN
                      adminUserPassword: adminUserPassword
        description: The properties of the domain required to test the connectivity.
        required: true
      responses:
        '200':
          description: Successfully validated the connectivity for the domain.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: &ref_130
                type: object
                properties:
                  data:
                    type: object
                    properties:
                      type:
                        type: string
                        description: >-
                          The resource type. Must be set to
                          "validateDomainResponse".
                        enum:
                          - validateDomainResponse
                      id:
                        type: string
                        description: The name of the domain.
                      attributes:
                        type: object
                        properties:
                          validationResult:
                            type: object
                            properties:
                              domainType:
                                type: string
                                description: |
                                  The type of the domain.
                              serverURL:
                                type: string
                                description: The URL of the domain server.
                              adminUserDN:
                                type: string
                                description: >
                                  Contains the distinguished name of the
                                  administrator or any user that has search
                                  permissions to the user container or user
                                  subtree.
                              status:
                                type: string
                                description: The status of the validate request.
                                enum:
                                  - SUCCESS
                                  - FAILURE
                              statusMessage:
                                type: string
                                description: The message corresponding to the status.
                            required:
                              - domainType
                              - serverURL
                              - adminUserDN
                              - status
                              - statusMessage
                        required:
                          - validationResult
                    required:
                      - type
                      - id
                      - attributes
                required:
                  - data
                example:
                  data:
                    type: validateDomainResponse
                    id: myDomainServer
                    attributes:
                      validationResult:
                        domainType: LDAP_DOMAIN
                        serverURL: 'ldap://myServerUrl:port'
                        adminUserDN: myAdminUserDN
                        status: SUCCESS
                        statusMessage: status message
        '400': *ref_5
        '401': *ref_2
        '415': *ref_11
        '500': *ref_4
        '503': *ref_13
  /security/external-certificates:
    post:
      description: >
        Associates the specified external certificate subject name with the
        given host ID of the host.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|CERTIFICATE-MANAGEMENT|ECA|`\

        Requires Operation: `|OPERATIONS|ADD|`
      tags:
        - Certificates
      requestBody:
        content:
          application/vnd.netbackup+json;version=12.0:
            schema: &ref_123
              description: The request for external certificate to NetBackup host ID entry.
              type: object
              required:
                - data
              properties:
                data:
                  description: >
                    The payload for creating entry of external certificate by
                    provided subject name and host ID of NetBackup.
                  type: object
                  required:
                    - type
                    - attributes
                  properties:
                    type:
                      description: The type of the extenal certificate entry request.
                      type: string
                      enum:
                        - certificateEntryRequest
                    attributes:
                      description: Contains the payload attributes.
                      type: object
                      required:
                        - hostId
                        - subjectName
                      properties:
                        hostId:
                          type: string
                          description: The unique ID assigned to the NetBackup host.
                        subjectName:
                          type: string
                          description: The subject of the certificate.
              example:
                data:
                  type: certificateEntryRequest
                  attributes:
                    hostId: fc3ef0c4-3539-43bf-8e02-18e4bewqsd6r
                    subjectName: 'O=xyz, OU=test_machine@localhost, CN=xyz.com'
        description: >
          The data required to create a entry for provided subject name of
          external certificate and host ID of the NetBackup host.
        required: true
      responses:
        '201':
          description: Returns the certificateEntryResponse.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: &ref_124
                type: object
                required:
                  - data
                properties:
                  data:
                    description: >-
                      The response of external certificate subject name to host
                      ID of NetBackup entry.
                    type: object
                    required:
                      - type
                      - id
                      - attributes
                    properties:
                      type:
                        description: The type of the certificate entry response.
                        type: string
                        enum:
                          - certificateEntryResponse
                      id:
                        type: string
                        description: The response identifier.
                      links:
                        type: object
                        properties:
                          self:
                            type: object
                            properties:
                              href:
                                type: string
                      attributes:
                        description: The attributes of the certificate enrollment response.
                        type: object
                        required:
                          - hostId
                          - subjectName
                          - createdDateTime
                        properties:
                          hostId:
                            type: string
                            description: The unique ID assigned to the NetBackup host.
                          subjectName:
                            type: string
                            description: The subject of the certificate.
                          createdDateTime:
                            type: string
                            description: >-
                              A UTC timestamp of when the certifcate entry was
                              created.
                example:
                  data:
                    links:
                      self:
                        href: >-
                          /security/external-certificate/O=xyz,
                          OU=test_machine@localhost, CN=xyz.com
                    type: certificateEntryResponse
                    id: 'O=xyz, OU=test_machine@localhost, CN=xyz.com'
                    attributes:
                      hostId: fc3ef0c4-3539-43bf-8e02-18e4bewqsd6r
                      subjectName: 'O=xyz, OU=test_machine@localhost, CN=xyz.com'
                      createdDateTime: 2019-05-04T10:18:36.271Z
        '400': *ref_5
        '401': *ref_2
        '404': *ref_14
        '409':
          description: The resource already exists.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_0
        '500': *ref_4
  '/security/external-certificates/{subject}':
    delete:
      description: >
        Removes the certificate.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|CERTIFICATE-MANAGEMENT|ECA|`\

        Requires Operation: `|OPERATIONS|DELETE|`
      tags:
        - Certificates
      parameters:
        - name: subject
          description: >
            The subject name of the certificate. If the subject name contains
            characters that are not handled by the standard URI encoding, you
            should use Base64 encoding.
          in: path
          required: true
          schema:
            type: string
      responses:
        '204':
          description: The certificate is successfully removed.
        '400': *ref_5
        '401': *ref_2
        '404': *ref_14
        '500': *ref_4
  '/security/external-certificates/{subject}/reset':
    post:
      description: >
        Updates the subject of the specified certificate by clearing out all the
        other certificate fields except the

        subject. The certificate fields are populated again during certificate
        enrollment.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|CERTIFICATE-MANAGEMENT|ECA|`\

        Requires Operation:
        `|OPERATIONS|SECURITY|CERTIFICATE-MANAGEMENT|ECA|RESET|`
      tags:
        - Certificates
      parameters:
        - name: subject
          description: >
            The subject name of the certificate. If the subject name contains
            characters that are not handled by the standard URI encoding, you
            should use Base64 encoding.
          in: path
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/vnd.netbackup+json;version=12.0:
            schema: &ref_135
              type: object
              required:
                - data
              properties:
                data:
                  type: object
                  required:
                    - type
                    - attributes
                  properties:
                    type:
                      type: string
                      description: Request payload of the certificate to be updated.
                      enum:
                        - externalCertificateRequest
                    id:
                      type: string
                    attributes:
                      type: object
                      required:
                        - subjectName
                      description: The attributes of the certificate.
                      properties:
                        subjectName:
                          type: string
                          description: The subject of the certificate.
        description: Request data of the certificate to be updated.
        required: true
      responses:
        '204':
          description: The certificate details are successfully updated.
        '400': *ref_5
        '401': *ref_2
        '404': *ref_14
        '409':
          description: The certificate already exists.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_0
        '500': *ref_4
  /security/external-certificates/validate:
    post:
      description: >
        Validate the revocation status of the external certificate against
        Certificate Revocation List (CRL) of the external certificate authority
        (CA).

        If requested, the API can also return the CA certificate chain that is
        associated with the given server certificates.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|CERTIFICATE-MANAGEMENT|ECA|`\

        Requires Operation: `|OPERATIONS|VIEW|`
      tags:
        - Certificates
      requestBody:
        content:
          application/vnd.netbackup+json;version=12.0:
            schema: &ref_125
              description: The request to validate the external certificate.
              type: object
              required:
                - data
              properties:
                data:
                  description: |
                    The payload to validate the external certificate.
                  type: object
                  required:
                    - type
                    - attributes
                  properties:
                    type:
                      description: The type of the external certificate validation request.
                      type: string
                      enum:
                        - externalCertificateValidateRequest
                    attributes:
                      description: The payload attributes.
                      type: object
                      required:
                        - serverCertificates
                        - certValidationType
                      properties:
                        serverCertificates:
                          type: array
                          items:
                            type: string
                            description: >
                              An ordered list with leaf/server certificate
                              listed first, followed by zero or more certificate
                              authorities.

                              The string must include X.509 certificate that is
                              in PEM-format.
                        certValidationType:
                          type: string
                          description: >-
                            Determines the settings for the certificate
                            validation. For example CRL check level or trust
                            store path.
                          enum:
                            - CERT_VALIDATION_TYPE_VIRTUALIZATION
                        fetchCACertChain:
                          type: boolean
                          description: >-
                            If true, the response includes certificate authority
                            (CA) certificate chain that is associated with the
                            specified server certificates.
              example:
                data:
                  type: externalCertificateValidateRequest
                  attributes:
                    serverCertificates:
                      - |-
                        -----BEGIN CERTIFICATE-----
                        MIIF/DCCA+SgAgIJAI0wUAMIGKMQswCQYD
                        -----END CERTIFICATE-----
                    certValidationType: CERT_VALIDATION_TYPE_VIRTUALIZATION
                    fetchCACertChain: true
        description: |
          The data required to validate the external certificate.
        required: true
      responses:
        '200':
          description: The request for the certificate validation was processed.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: &ref_126
                description: The response for the external certificate validation request.
                type: object
                required:
                  - data
                properties:
                  data:
                    description: >
                      The response for the external certificate validation
                      request.
                    type: object
                    required:
                      - type
                      - attributes
                    properties:
                      type:
                        description: >-
                          The type of the external certificate validation
                          response.
                        type: string
                        enum:
                          - externalCertificateValidateResponse
                      attributes:
                        description: The payload attributes.
                        type: object
                        required:
                          - crlCheckLevel
                          - crlCheckStatus
                        properties:
                          crlCheckLevel:
                            type: string
                            description: >
                              The revocation check level.

                              Based on the check, revocation status of the
                              server certificate is validated against the
                              certificate revocation list (CRL).

                              - DISABLE - Revocation check is disabled.
                              Revocation status of the certificate is not
                              validated against the CRL.

                              - LEAF - Revocation status of the leaf certificate
                              is validated against the CRL.

                              - CHAIN - Revocation status of all certificates
                              from the certificate chain are validated against
                              the CRL.
                            enum:
                              - DISABLE
                              - LEAF
                              - CHAIN
                          crlCheckStatus:
                            type: string
                            description: |
                              Status of the CRL check.
                                - CRL_STATUS_PASSED - The certificate is not revoked.
                                - CRL_STATUS_REVOKED - The certificate is revoked.
                                - CRL_STATUS_DISABLED - Revocation check is disabled.
                                - CRL_STATUS_FAILED - Failed to check the revocation status.
                            enum:
                              - CRL_STATUS_PASSED
                              - CRL_STATUS_DISABLED
                              - CRL_STATUS_REVOKED
                              - CRL_STATUS_FAILED
                          crlCheckStatusDetails:
                            type: string
                            description: >-
                              CRL check status details. Applicable only in the
                              case of CRL_STATUS_FAILED.
                          caCertChain:
                            type: array
                            items:
                              type: string
                              description: >
                                Certificate authority (CA) certificate chain
                                that is associated with the specified server
                                certificates.

                                The X.509 certificate in the PEM format.
                example:
                  data:
                    type: externalCertificateValidateResponse
                    attributes:
                      caCertChain:
                        - |-
                          -----BEGIN CERTIFICATE-----
                          MIIF/DCCA+SgAgIJAI0wUAMIGKMQswCQYD
                          -----END CERTIFICATE-----
                      crlCheckStatus: CRL_STATUS_PASSED
                      crlCheckLevel: CHAIN
        '400': *ref_5
        '401': *ref_2
        '500': *ref_4
  /security/properties:
    post:
      description: >
        Configures NetBackup security options, such as certificate deployment
        security level, secure communication with

        hosts, automatic addition of host ID-to-host name mappings and use of
        external Certificate Authority (CA).


        Note: In case multi-person authorization is configured, modifications to
        security settings are not reflected 

        immediately. However, a multi-person authorization ticket is initiated
        that needs approval. The ticket ID is

        returned in the response header.


        If this operation is subjected to adaptive MFA, then response shall
        indicate HTTP status code 202. The invoker of this API must

        invoke URI mentioned in **X-NetBackup-MFA-Request** HTTP response header
        of the request to prove authenticity of the requestor.

        Please refer the adaptive MFA validate
        [API](/api-docs/?urls.primaryName=security#/MFA/post_security_adaptive_mfa__requestId__validate)

        documentation for more information.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|SETTINGS|`\

        Requires Operation: `|OPERATIONS|UPDATE|`
      tags:
        - Configuration
      requestBody:
        content:
          application/vnd.netbackup+json;version=12.0:
            schema: &ref_144
              type: object
              properties:
                allowInsecureBackLevelHost: &ref_16
                  type: integer
                  description: >
                    Here are the defined values for the
                    allowInsecureBackLevelHost setting:

                    0 - OFF - The NetBackup host cannot communicate with
                    insecure hosts.

                    1 - ON - The NetBackup host can communicate with insecure
                    hosts.
                aliasAutoAdd: &ref_17
                  type: integer
                  description: >
                    Here are the defined values for the aliasAutoAdd setting:

                    0 - OFF - The NetBackup administrator's approval is required
                    to add host aliases.

                    1 - ON - Aliases can be automatically added without the
                    NetBackup administrator's approval.
                certificateAutoDeployLevel: &ref_18
                  type: integer
                  description: >
                    The following are the defined values for the
                    certificateAutoDeployLevel:

                    * 0 - Very High - Automatic certificate deployment is
                    disabled.

                    * 1 - High      - Certificates are automatically deployed on
                    known hosts.

                    * 2 - Medium    - Certificates are automatically deployed on
                    all hosts.
                cacpivEnabled: &ref_19
                  type: integer
                  description: |
                    Here are the defined values for CAC/PIV enabled parameter:
                    0 - Disabled  - CAC/PIV authentication is disabled.
                    1 - Enabled   - CAC/PIV authentication is enabled.
                cacpivADLDAPDomainMapping: &ref_20
                  type: integer
                  description: >
                    Here are the defined values for CAC/PIV AD/LDAP domain
                    mapping parameter:

                    0 - Disabled  - AD/LDAP mapping is disabled.

                    1 - Enabled   - AD/LDAP mapping is enabled.
                cacpivCertMappingAttribute: &ref_21
                  type: integer
                  description: >
                    Here are defined values for CAC/PIV certificate mapping
                    attribute:

                    0 - CN  - Common name from certificate that is used as the
                    mapping attribute.

                    1 - UPN - User principal name from certificate that is used
                    as mapping attribute.
                cacpivUserDomainName: &ref_22
                  type: string
                  description: >
                    This field stores the value of the domain name that is used
                    for user lookups in active directory or LDAP.
                cacpivOcspUri: &ref_23
                  type: string
                  description: >-
                    This field stores the value of the OCSP URI that is used for
                    certificate revocation checks.
                cacpivMSADCNMappingAttribute: &ref_24
                  type: string
                  description: >
                    This field stores the value of the CAC/PIV certificate
                    mapping attribute that is used to perform a search in active
                    directory.
                cacpivMSADUPNMappingAttribute: &ref_25
                  type: string
                  description: >
                    This field stores the value of the CAC/PIV certificate
                    mapping attribute that is used to perform a search in active
                    directory.
                cacpivLDAPCNMappingAttribute: &ref_26
                  type: string
                  description: >
                    This field stores the value of the CAC/PIV certificate
                    mapping attribute that is used to perform a search in LDAP
                    directory.
                cacpivLDAPUPNMappingAttribute: &ref_27
                  type: string
                  description: >
                    This field stores the value of the CAC/PIV certificate
                    mapping attribute that is used to perform a search in LDAP
                    directory.
                dteGlobalMode: &ref_28
                  type: string
                  description: >
                    This field specifies the domain level setting for
                    data-in-transit encryption (DTE).

                    Here are the defined values for the DTE setting:

                    * 'PREFERRED_OFF' - Disables the data-in-transit encryption
                    for the entire domain but it can be overridden at the client
                    host level. 

                    * 'PREFERRED_ON'  - Enables the data-in-transit encryption
                    for the entire domain but it can be overridden at the client
                    host level.

                    * 'ENFORCED'      - Enables the data-in-transit encryption
                    for the entire domain and cannot be overridden at the client
                    host level.
                  enum:
                    - PREFERRED_OFF
                    - PREFERRED_ON
                    - ENFORCED
                externalCertificateIdentityField: &ref_29
                  type: integer
                  description: >
                    This field specifies the unique identifier for external
                    certificates.

                    Here are defined values for external certificates identity:

                    0 - Subject Distinguished Name(DN)  - Subject Name from
                    certificate is used as unique identifier.

                    1 - Common Name(CN) - Common Name from certificate is used
                    as unique identifier.
                performAdminUserCheck: &ref_183
                  type: integer
                  description: >
                    This field allows OS administrators from giving membership
                    to the RBAC Administrator role:

                    0 - Disabled  - Need to explicitly add users to RBAC
                    Administrator role.

                    1 - Enabled   - OS administrators are considered NetBackup
                    Administrators.


                    WARNING: You must assign the RBAC administrator role to at
                    least one user to continue accessing the NetBackup web UI as
                    specified in response headers.
                cliAccessSettings: &ref_30
                  type: object
                  properties:
                    defaultCLIAccessToOSAdmins: &ref_192
                      type: integer
                      default: 0
                      description: >
                        Enable/Disbale the default NetBackup command line
                        interfaces (CLI) access for root/admin users.

                        0 - Disabled - Admin users must login using bpnbat to
                        access command line interfaces.

                        1 - Enabled  - Admin users can access command line
                        interfaces by default.
                    cliSessionMaxExpiryInSec: &ref_193
                      type: integer
                      default: 86400
                      description: The maximum number of seconds cli session can be live.
                blockClientProtection: &ref_31
                  type: integer
                  description: |
                    This field blocks client protection
                blockClientImageExpiration: &ref_32
                  type: integer
                  description: |
                    This field blocks client image expiration.
                tlsSessionResumption: &ref_122
                  type: object
                  oneOf:
                    - &ref_184
                      type: object
                      oneOf:
                        - &ref_185
                          description: >
                            Represents the schema for enabling TLS session
                            resumption with "customOrDefaultHandshakeInterval"
                            as DEFAULT.

                            The following values are the intervals (in minutes)
                            that will be used based on
                            certificateAutoDeployLevel:

                            * '0 - Very High' - 10

                            * '1 - High'      - 30

                            * '2 - Medium'    - 60
                          required:
                            - enableOrDisable
                            - customOrDefaultHandshakeInterval
                          properties:
                            enableOrDisable: &ref_15
                              type: string
                              description: >-
                                Indicates whether the TLS session resumption is
                                enabled or disabled.
                              enum:
                                - ENABLE
                            customOrDefaultHandshakeInterval: &ref_35
                              type: string
                              description: >-
                                Indicates whether DEFAULT or CUSTOM handshake
                                interval was used.
                              enum:
                                - DEFAULT
                        - &ref_186
                          description: >-
                            The schema for enabling TLS session resumption with
                            "customOrDefaultHandshakeInterval" as CUSTOM.
                          required:
                            - enableOrDisable
                            - customOrDefaultHandshakeInterval
                            - customHandshakeIntervalInMinutes
                          properties:
                            enableOrDisable: *ref_15
                            customOrDefaultHandshakeInterval: &ref_33
                              type: string
                              description: >-
                                Indicates whether DEFAULT or CUSTOM handshake
                                interval was used.
                              enum:
                                - CUSTOM
                            customHandshakeIntervalInMinutes: &ref_34
                              type: integer
                              description: Returns the handshake interval (in minutes).
                              minimum: 1
                              maximum: 720
                    - &ref_191
                      description: >-
                        The schema configuration value for the TLS session
                        resumption when disabled.
                      required:
                        - enableOrDisable
                      properties:
                        enableOrDisable: &ref_37
                          type: string
                          description: >-
                            Indicates whether the TLS session resumption is
                            enabled or disabled.
                          enum:
                            - DISABLE
                userJwtTokenValidityInSeconds: &ref_39
                  type: integer
                  description: >-
                    This field defines the time in seconds that user
                    authenticated JWT token will be valid.
                  minimum: 7200
                  maximum: 86400
                ssoEntityId: &ref_40
                  type: string
                  description: >
                    This field stores the value of the single sign-on (SSO)
                    entity ID that is used to identify the service provider
                    during the SAML authentication process.

                    This field overrides the default entity ID that is unique to
                    each primary server.

                    Consider the following example: If you want to configure
                    multiple primary servers in a single application at Okta
                    IDP, you can use this field to set the the entity ID of each
                    primary server (for example: https://netbackup.com) to the
                    default entity ID.
                ruleEngineEnableOrDisable:
                  type: integer
                  description: |
                    This field enables/disables rule engine.  
                mfaConfigurationSettings: &ref_194
                  type: object
                  properties:
                    mfaEnforced: &ref_41
                      type: boolean
                      default: false
                      description: |
                        Enable or disable the MFA for the NetBackup users.
                auditRetentionPeriodInDays: &ref_42
                  type: integer
                  description: >
                    This field defines number of days audit records are to be
                    retained for the audit report.

                    The value (in days) should be either 0 or more than 27.
                  default: 90
                  minimum: 0
        description: The security configurations that need to be updated.
        required: true
      responses:
        '200':
          headers:
            X-NetBackup-Warning:
              schema:
                type: string
              description: >-
                You must assign the RBAC administrator role to at least one user
                to continue accessing the NetBackup web UI.
          description: Request successful.
        '202':
          description: >-
            The request to update the security properties is sent to the server
            and it needs an approval from either the multi-person authorization
            or multifactor authentication process.
          headers:
            X-NetBackup-MPA-Ticket:
              description: >-
                The Ticket ID of newly-generated multi-person authorization
                ticket.
              schema:
                type: string
            X-NetBackup-MFA-Request:
              description: The URI link for MFA authentication.
              schema:
                type: string
        '400': *ref_5
        '401': *ref_2
        '415': *ref_11
    get:
      description: >
        Fetches the configuration settings for NetBackup security.


        **API Versioned:**\

        This API has a major update starting with version 5.0. Requests made
        using the previous format may fail or may not be served as expected.

        For more details on the new changes and API versioning, see the Getting
        Started Guide:

        http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|SETTINGS|`\

        Requires Operation: `|OPERATIONS|VIEW|`
      tags:
        - Configuration
      responses:
        '200':
          description: Successfully sent the security configurations. format.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: &ref_43
                type: object
                description: List of security settings.
                properties:
                  allowInsecureBackLevelHost: *ref_16
                  aliasAutoAdd: *ref_17
                  certificateAutoDeployLevel: *ref_18
                  externalCaUsage: &ref_62
                    type: integer
                    description: >
                      ECA = External certificate authority.

                      NBCA = NetBackup certificate authority.

                      Here are the defined values for the external CA usage
                      parameter:

                      0 - Disabled - Only NBCA is used for NetBackup
                      communication

                      1 - Enabled  - NetBackup allows communication with either
                      NetBackup CA or external CA certificates.
                                     If one of the communicating hosts is only configured to use a NetBackup CA certificate,
                                     NetBackup certificates are used. If both hosts have an external CA certificate enrolled,
                                     external certificates are used.
                      2 - Enforced - NetBackup only allows communication with
                      external CA certificates.
                                     Communication with NetBackup CA certificates is not allowed.
                  cacpivEnabled: *ref_19
                  cacpivADLDAPDomainMapping: *ref_20
                  cacpivCertMappingAttribute: *ref_21
                  cacpivUserDomainName: *ref_22
                  cacpivOcspUri: *ref_23
                  cacpivMSADCNMappingAttribute: *ref_24
                  cacpivMSADUPNMappingAttribute: *ref_25
                  cacpivLDAPCNMappingAttribute: *ref_26
                  cacpivLDAPUPNMappingAttribute: *ref_27
                  ssoEnabled: &ref_63
                    type: boolean
                    default: false
                    description: >-
                      Determines if the Single Sign-On (SSO) feature is enabled
                      in NetBackup.
                  nbuKeySize:
                    type: integer
                    description: >-
                      Displays the key size for new certificate key pair that
                      NetBackup generates.
                  dteGlobalMode: *ref_28
                  externalCertificateIdentityField: *ref_29
                  performAdminUserCheck: &ref_182
                    type: integer
                    description: >
                      This field allows OS administrators from giving membership
                      to the RBAC Administrator role:

                      0 - Disabled  - Need to explicitly add users to RBAC
                      Administrator role.

                      1 - Enabled   - OS administrators are considered NetBackup
                      Administrators.
                  cliAccessSettings: *ref_30
                  blockClientProtection: *ref_31
                  blockClientImageExpiration: *ref_32
                  tlsSessionResumption: &ref_187
                    type: object
                    description: The configuration value for the TLS session resumption.
                    oneOf:
                      - &ref_188
                        description: >-
                          The schema configuration value for the TLS session
                          resumption when enabled with
                          "customOrDefaultHandshakeInterval" as CUSTOM.
                        properties:
                          enableOrDisable: *ref_15
                          customOrDefaultHandshakeInterval: *ref_33
                          customHandshakeIntervalInMinutes: *ref_34
                          certificateAutoDeployLevelToHandshakeMappings: &ref_36
                            type: array
                            items:
                              type: object
                              properties:
                                certificateAutoDeployLevel: *ref_18
                                handshakeIntervalInMinutes: &ref_38
                                  type: integer
                                  description: >
                                    The following are the defined values for the
                                    handshake interval (in minutes) for each
                                    certificateAutoDeployLevel:

                                    * 'Very High'  - 10

                                    * 'High'       - 30

                                    * 'Medium'     - 60
                      - &ref_189
                        description: >-
                          The schema configuration value for the TLS session
                          resumption when enabled with
                          "customOrDefaultHandshakeInterval" as DEFAULT.
                        properties:
                          enableOrDisable: *ref_15
                          customOrDefaultHandshakeInterval: *ref_35
                          certificateAutoDeployLevelToHandshakeMappings: *ref_36
                      - &ref_190
                        description: >-
                          The schema configuration value for the TLS session
                          resumption when disabled.
                        properties:
                          enableOrDisable: *ref_37
                          certificateAutoDeployLevelToHandshakeMappings:
                            type: array
                            items:
                              type: object
                              properties:
                                certificateAutoDeployLevel: *ref_18
                                handshakeIntervalInMinutes: *ref_38
                  userJwtTokenValidityInSeconds: *ref_39
                  ssoEntityId: *ref_40
                  mfaConfigurationSettings: &ref_195
                    type: object
                    properties:
                      mfaEnforced: *ref_41
                      hashAlgorithm: &ref_196
                        type: string
                        default: HS1
                        enum:
                          - HS1
                          - HS256
                          - HS384
                          - HS512
                        description: >
                          The hash algorithm used for TOTP generation and
                          validation.

                          |Name|MAC Algorithm|

                          |---|---|

                          |HS1|HMAC using SHA-1|

                          |HS256|HMAC using SHA-256|

                          |HS384|HMAC using SHA-384|

                          |HS512|HMAC using SHA-512|
                      otpLength: &ref_197
                        type: integer
                        default: 6
                        description: |
                          The length of the TOTP.
                      randomBits: &ref_198
                        type: integer
                        default: 160
                        description: |
                          The random bits used for secret generation.
                  auditRetentionPeriodInDays: *ref_42
                required:
                  - allowInsecureBackLevelHost
                  - aliasAutoAdd
                  - certificateAutoDeployLevel
                  - cacpivEnabled
                  - cacpivADLDAPDomainMapping
                  - cacpivCertMappingAttribute
                  - cacpivUserDomainName
                  - cacpivOcspUri
                  - cacpivMSADCNMappingAttribute
                  - cacpivMSADUPNMappingAttribute
                  - cacpivLDAPCNMappingAttribute
                  - cacpivLDAPUPNMappingAttribute
                  - ssoEnabled
                  - nbuKeySize
                  - externalCertificateIdentityField
                  - performAdminUserCheck
                  - cliAccessSettings
                  - blockClientProtection
                  - blockClientImageExpiration
                  - userJwtTokenValidityInSeconds
                  - ssoEntityId
                  - ruleEngineEnableOrDisable
                  - mfaConfigurationSettings
                  - auditRetentionPeriodInDays
        '406': *ref_3
        '503':
          description: Unable to fetch the security configuration details. Try again later.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_0
  /security/properties/default:
    get:
      description: |
        Fetches the default settings specific to NetBackup security.

        **Access Control**\
        Enforcement Type: `None`
      tags:
        - Configuration
      security: []
      responses:
        '200':
          description: >-
            On successful response, default security configuration settings are
            sent in the JSON format.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_43
        '406': *ref_3
  /security/key-management-services:
    post:
      description: >
        Adds an entry for the KMS configuration in the NetBackup database.


        Note: In case multi-person authorization is configured, KMS
        configuration is not added immediately.

        However, a multi-person authorization ticket is initiated that needs
        approval. The ticket ID is

        returned in the response header.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|KMS|`\

        Requires Operation: `|OPERATIONS|ADD|`
      tags:
        - Key Management Services
      parameters:
        - &ref_48
          name: X-NetBackup-Audit-Reason
          in: header
          description: >
            Audit reason for the action being performed. This value must be
            URL-encoded. Maximum 512 bytes, in UTF-8 encoding. The remaining
            bytes are truncated.
          schema:
            type: string
          required: false
      requestBody:
        description: KMS configuration details.
        required: true
        content:
          application/vnd.netbackup+json;version=12.0:
            schema: &ref_145
              type: object
              properties:
                data:
                  type: object
                  properties:
                    type:
                      type: string
                      description: >-
                        The resource definition type returned for the key
                        management service API.
                      enum:
                        - keyManagementServiceConfiguration
                    attributes:
                      type: object
                      properties:
                        name:
                          type: string
                          description: >-
                            Specifies a unique display name for the KMS
                            configuration.
                        kmsType:
                          type: string
                          description: Specifies the KMS type.
                          enum:
                            - NBKMS
                            - KMIP
                        description:
                          type: string
                          default: null
                          description: User remarks for key management service.
                        enabledForBackup:
                          type: boolean
                          default: true
                          description: >-
                            Specifies whether keys from this KMS should be used
                            for backup or not.
                        priority:
                          type: integer
                          default: 0
                          description: >
                            Defines which KMS server is to be used when
                            NetBackup checks for keys during encryption or
                            decryption.

                            By default, the KMS server priority is set to 0. A
                            KMS server with the highest value gets the first 

                            priority to be used during encryption or
                            decryption. 
                        nbkmsAttributes: &ref_146
                          type: object
                          description: The properties of NetBackup key management service.
                          properties:
                            useRandomPassphrase:
                              type: boolean
                              default: false
                              description: >-
                                Specifies whether random passphrases should be
                                used or not. This should be set to true if
                                hmkPassphrase and kpkPassphrase are not
                                provided.
                            hmkPassphrase:
                              type: string
                              description: >-
                                The host master key(HMK) for protecting the key
                                database.
                            hmkId:
                              type: string
                              description: >-
                                Specifies the host master key (HMK) ID to
                                identify HMK passphrase.
                            kpkPassphrase:
                              type: string
                              description: >-
                                The key protection key (KPK) to protect
                                individual records in the key database.
                            kpkId:
                              type: string
                              description: >-
                                Specifies the key protection key (KPK) ID to
                                identify KPK passphrase.
                          required:
                            - hmkId
                            - kpkId
                        kmipAttributes: &ref_45
                          type: object
                          description: The properties of external key management service.
                          properties:
                            port:
                              type: integer
                              description: >-
                                Specifies the port to be used to connect to
                                external KMS server.
                            kmsServerName:
                              type: string
                              description: Specifies the network name for the KMS server.
                            credId:
                              type: string
                              description: >-
                                Specifies the credential ID of the KMS
                                configuration.
                          required:
                            - port
                            - kmsServerName
                            - credId
                      required:
                        - name
                        - kmsType
                  required:
                    - type
                    - attributes
              required:
                - data
      responses:
        '201':
          description: >-
            The KMS configuration is successfully added in the NetBackup
            database.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: &ref_152
                type: object
                properties:
                  data: &ref_156
                    type: object
                    properties:
                      links:
                        type: object
                        properties:
                          self: &ref_44
                            type: object
                            description: Link to the resource.
                            properties:
                              href:
                                type: string
                      type:
                        type: string
                        description: >-
                          The resource definition type returned for the key
                          management service API.
                        enum:
                          - keyManagementServiceConfigurationResponse
                      id:
                        type: string
                        description: >-
                          Specifies a unique display name for the KMS
                          configuration.
                    required:
                      - links
                      - type
                      - id
                required:
                  - data
        '202':
          description: >-
            The request was successfully received by the server and is awaiting
            MPA approval.
          headers:
            X-NetBackup-MPA-Ticket:
              description: >-
                The Ticket ID of newly-generated multi-person authorization
                ticket.
              schema:
                type: string
        '400': *ref_5
        '401': *ref_2
        '409':
          description: The KMS is already configured.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_0
        '500': *ref_4
    get:
      description: >
        Lists the configuration details of all key management services
        configured in NetBackup.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|KMS|`\

        Requires Operation: `|OPERATIONS|VIEW|`
      tags:
        - Key Management Services
      parameters:
        - name: 'page[limit]'
          description: The number of key-details records on one page after the offset.
          in: query
          required: false
          schema:
            type: integer
            default: 10
        - name: 'page[offset]'
          description: The key-details record offset.
          in: query
          required: false
          schema:
            type: integer
            default: 0
      responses:
        '200':
          description: >
            Successfully retrieved configuration details of all key management
            services.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: &ref_151
                type: object
                properties:
                  data:
                    type: array
                    items: &ref_46
                      type: object
                      properties:
                        links:
                          type: object
                          properties:
                            self: *ref_44
                        type:
                          type: string
                          description: >-
                            The resource definition type returned for the key
                            management service API.
                          enum:
                            - keyManagementServiceConfiguration
                        id:
                          type: string
                          description: >-
                            Specifies a unique display name for the KMS
                            configuration.
                        attributes: &ref_53
                          type: object
                          properties:
                            name:
                              type: string
                              description: >-
                                Specifies a unique display name for the KMS
                                configuration.
                            kmsType:
                              type: string
                              description: Specifies the KMS type.
                              enum:
                                - NBKMS
                                - KMIP
                            description:
                              type: string
                              description: The user remarks for key management service.
                            enabledForBackup:
                              type: boolean
                              description: >-
                                Specifies whether keys from this KMS should be
                                used for backup or not.
                            priority:
                              type: integer
                              description: >
                                Defines which KMS server is to be used when
                                NetBackup checks for keys during encryption or
                                decryption.

                                By default, the KMS server priority is set to 0.
                                A KMS server with the highest value gets the
                                first

                                priority to be used during encryption or
                                decryption.
                            netbackupAttributes: &ref_154
                              type: object
                              description: The properties of NetBackup KMS.
                              properties:
                                hmkId:
                                  type: string
                                  description: >-
                                    Specifies the host master key (HMK) ID to
                                    identify HMK passphrase.
                                kpkId:
                                  type: string
                                  description: >-
                                    Specifies the key protection key (KPK) ID to
                                    identify KPK passphrase.
                            kmipAttributes: *ref_45
                          required:
                            - name
                            - kmsType
                            - description
                            - enabledForBackup
                            - priority
                      required:
                        - links
                        - type
                        - id
                        - attributes
                  links: &ref_54
                    type: object
                    properties:
                      self:
                        type: object
                        description: Link to the current page.
                        properties:
                          href:
                            type: string
                      first:
                        type: object
                        description: Link to the first page.
                        properties:
                          href:
                            type: string
                      last:
                        type: object
                        description: Link to the last page.
                        properties:
                          href:
                            type: string
                      next:
                        type: object
                        description: Link to the next page.
                        properties:
                          href:
                            type: string
                      prev:
                        type: object
                        description: Link to the previous page.
                        properties:
                          href:
                            type: string
                  meta:
                    type: object
                    properties:
                      pagination: &ref_55
                        type: object
                        properties:
                          count:
                            type: integer
                            description: Total number of records.
                          pages:
                            type: integer
                            description: Total number of pages.
                          page:
                            type: integer
                            description: The current page number.
                          offset:
                            type: integer
                            description: The offset value for the current page.
                          limit:
                            type: integer
                            description: The number of records per page.
                          first:
                            type: integer
                            description: The offset value for the first page.
                          last:
                            type: integer
                            description: The offset value for the last page.
                          next:
                            type: integer
                            description: The offset value for the next page.
                          prev:
                            type: integer
                            description: The offset value for the previous page.
                required:
                  - data
        '401': *ref_2
        '500': *ref_4
  '/security/key-management-services/{kmsId}':
    get:
      description: >
        Lists configuration details of the specified KMS.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|KMS|`\

        Requires Operation: `|OPERATIONS|VIEW|`
      tags:
        - Key Management Services
      parameters:
        - &ref_47
          in: path
          description: Specifies a unique display name for the KMS configuration.
          name: kmsId
          required: true
          schema:
            type: string
      responses:
        '200':
          description: |
            Successfully retrieved configuration details of the specified KMS.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: &ref_153
                type: object
                properties:
                  data: *ref_46
                required:
                  - data
        '401': *ref_2
        '404':
          description: The specified KMS does not exist.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_0
        '500': *ref_4
    delete:
      description: >
        Deletes the KMS configuration of the specified KMS.


        Note: In case multi-person authorization is configured, KMS
        configuration is not deleted immediately.

        However, a multi-person authorization ticket is initiated that needs
        approval. The ticket ID is

        returned in the response header.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|KMS|`\

        Requires Operation: `|OPERATIONS|DELETE|`
      tags:
        - Key Management Services
      parameters:
        - *ref_47
        - *ref_48
      responses:
        '202':
          description: >-
            The request was successfully received by the server and is awaiting
            MPA approval.
          headers:
            X-NetBackup-MPA-Ticket:
              description: >-
                The Ticket ID of newly-generated multi-person authorization
                ticket.
              schema:
                type: string
        '204':
          description: |
            Successfully deleted the configuration of the specified KMS.
        '401': *ref_2
        '404':
          description: The specified KMS does not exist.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_0
        '500': *ref_4
    patch:
      description: >
        Updates the KMS configuration of the specified KMS.


        Note: In case multi-person authorization is configured, KMS
        configuration is not updated immediately.

        However, a multi-person authorization ticket is initiated that needs
        approval. The ticket ID is

        returned in the response header.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|KMS|`\

        Requires Operation: `|OPERATIONS|UPDATE|`
      tags:
        - Key Management Services
      parameters:
        - *ref_47
        - *ref_48
      requestBody:
        description: Configuration details to be updated for the specified KMS.
        required: true
        content:
          application/vnd.netbackup+json;version=12.0:
            schema: &ref_157
              type: object
              properties:
                data:
                  description: >-
                    The request payload that contains the paramaters of key
                    management service.
                  type: object
                  properties:
                    type:
                      type: string
                      description: >-
                        The resource definition type returned for the key
                        management service API.
                      enum:
                        - keyManagementServiceConfigurationUpdateRequest
                    attributes:
                      type: object
                      properties:
                        description:
                          type: string
                          description: The user remarks for key management service.
                        enabledForBackup:
                          type: boolean
                          description: >-
                            Specifies whether keys from this KMS should be used
                            for backup or not.
                        priority:
                          type: integer
                          default: 0
                          description: >
                            Defines which KMS server is to be used when
                            NetBackup checks for keys during encryption or
                            decryption.

                            By default, the KMS server priority is set to 0. A
                            KMS server with the highest value gets the first

                            priority to be used during encryption or decryption.
                        kmipAttributes: *ref_45
                        nbkmsAttributes:
                          type: array
                          items: &ref_147
                            type: object
                            description: >-
                              The properties of NetBackup key management
                              service.
                            properties:
                              keyType:
                                type: string
                                description: >-
                                  Specifies the key type that can be Host Master
                                  Key (HMK) or Key Passphrase Key (KPK).
                                enum:
                                  - HMK
                                  - KPK
                              keyId:
                                type: string
                                description: Specifies the ID for HMK or KPK.
                              passphrase:
                                type: string
                                description: >-
                                  Specifies passphrase to protect key database
                                  or individual records in the key database.
                            required:
                              - keyType
                              - keyId
                  required:
                    - attributes
              required:
                - data
      responses:
        '202':
          description: >-
            The server has successfully received the request and the MPA
            approval is awaited.
          headers:
            X-NetBackup-MPA-Ticket:
              description: >-
                The Ticket ID of newly-generated multi-person authorization
                ticket.
              schema:
                type: string
        '204':
          description: Successfully updated the configuration of the specified KMS.
        '400': *ref_5
        '401': *ref_2
        '404':
          description: The specified KMS does not exist.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_0
        '500': *ref_4
  '/security/key-management-services/{kmsId}/keys':
    post:
      description: >
        Create a key in the specified KMS.


        Note: In case multi-person authorization is configured, key is not
        created immediately.

        However, a multi-person authorization ticket is initiated that needs
        approval. The

        ticket ID is returned in the response header.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|KMS|`\

        Requires Operation: `|OPERATIONS|SECURITY|KMS|SERVICES|CREATE|`
      tags:
        - Key Management Services
      parameters:
        - *ref_47
        - *ref_48
      requestBody:
        description: Key configuration details.
        required: true
        content:
          application/vnd.netbackup+json;version=12.0:
            schema: &ref_158
              type: object
              description: >-
                Creates an activated key in the specified key management
                service.
              properties:
                data:
                  type: object
                  properties:
                    type:
                      type: string
                      enum:
                        - keyCreateConfiguration
                    attributes: &ref_49
                      type: object
                      properties:
                        name:
                          type: string
                          description: Specifies the name of the key.
                        keyGroup:
                          type: string
                          description: >-
                            Specifies the name of the key group that is used to
                            retrieve or set keys.
                        algorithm:
                          type: string
                          default: AES256
                          description: Algorithm to be used to create keys.
                          enum:
                            - AES128
                            - AES192
                            - AES256
                        comment:
                          type: string
                          description: Specifies a comment about the key.
                        passphrase:
                          type: string
                          description: >
                            The passphrase to be used for creating keys in
                            NetBackup key management service. If not provided
                            NetBackup KMS will use random passphrase.

                            This is not required in case of external key
                            management service.  
                      required:
                        - name
                        - keyGroup
              required:
                - data
      responses:
        '201':
          description: Details of the newly created key.
          headers:
            Location:
              description: The link to the newly created key.
              schema:
                type: string
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: &ref_166
                type: object
                properties:
                  data:
                    type: object
                    properties:
                      links:
                        type: object
                        properties:
                          self: *ref_44
                      type:
                        type: string
                        description: >-
                          The resource definition type returned for key creation
                          API.
                        enum:
                          - keyCreateConfiguration
                      id:
                        type: string
                        description: Unique Id of the key.
                      attributes: *ref_49
                    required:
                      - links
                      - type
                      - id
                      - attributes
                required:
                  - data
        '202':
          description: >-
            The request was successfully received by the server and is awaiting
            MPA approval.
          headers:
            X-NetBackup-MPA-Ticket:
              description: >-
                The Ticket ID of newly-generated multi-person authorization
                ticket.
              schema:
                type: string
        '400': *ref_5
        '401': *ref_2
        '409':
          description: The key creation failed as it already exists.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_0
        '500': *ref_4
  '/security/key-management-services/nbkms/keygroups/{keyGroupName}/keys/{keyName}':
    patch:
      description: >
        Updates a key in a key group and it also moves a key from a key group to
        another key group in NBKMS.


        Note: In case multi-person authorization is configured, key is not
        updated immediately.

        However, a multi-person authorization ticket is initiated that needs
        approval. The

        ticket ID is returned in the response header.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|KMS|`\

        Requires Operation: `|OPERATIONS|SECURITY|KMS|SERVICES|UPDATE|`
      tags:
        - Key Management Services
      parameters:
        - &ref_50
          in: path
          description: Specifies a unique name of key group in NBKMS.
          name: keyGroupName
          required: true
          schema:
            type: string
        - &ref_51
          in: path
          description: Specifies a unique name of key in a key group in NBKMS.
          name: keyName
          required: true
          schema:
            type: string
        - *ref_48
      requestBody:
        description: Key configuration details to be updated.
        required: true
        content:
          application/vnd.netbackup+json;version=12.0:
            schema: &ref_159
              type: object
              description: Details of a key in a key group to be updated in NBKMS.
              properties:
                data:
                  type: object
                  properties:
                    id:
                      type: string
                      description: Name of the key.
                    type:
                      type: string
                      enum:
                        - keyUpdateRequest
                    attributes: &ref_167
                      type: object
                      description: >-
                        Attributes for updating a key in key group. One or more
                        optional attributes needs to be specified.
                      properties:
                        keyName:
                          type: string
                          description: Specifies the new name of the key.
                        keyGroup:
                          type: string
                          description: >-
                            Specifies the new name of the key group for the key
                            to be moved.
                        comment:
                          type: string
                          description: Specifies a comment about the key to be updated.
                        state:
                          type: string
                          description: Specifies state of the key to be updated.
                          enum:
                            - INVALID
                            - ACTIVE
                            - INACTIVE
                            - DEPRECATED
                            - PRELIVE
                            - TERMINATED
              required:
                - data
      responses:
        '202':
          description: >-
            The server has successfully received the request and the MPA
            approval is awaited.
          headers:
            X-NetBackup-MPA-Ticket:
              description: >-
                The Ticket ID of newly-generated multi-person authorization
                ticket.
              schema:
                type: string
        '204':
          description: Successfully updated the key in NBKMS.
        '400': *ref_5
        '401': *ref_2
        '404':
          description: The specified key or key group does not exist.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_0
        '409':
          description: The specified key in key group already exists.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_0
        '415': *ref_11
        '500': *ref_4
    delete:
      description: >
        Deletes a key from a key group in NBKMS.

        Keys with Prelive or Terminated state can be deleted.


        Note: In case multi-person authorization is configured, key is not
        deleted immediately.

        However, a multi-person authorization ticket is initiated that needs
        approval. The ticket ID is

        returned in the response header.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|KMS|`\

        Requires Operation: `|OPERATIONS|SECURITY|KMS|SERVICES|DELETE|`
      tags:
        - Key Management Services
      parameters:
        - *ref_50
        - *ref_51
        - *ref_48
      responses:
        '202':
          description: >-
            The server has successfully received the request and the MPA
            approval is awaited.
          headers:
            X-NetBackup-MPA-Ticket:
              description: >-
                The Ticket ID of newly-generated multi-person authorization
                ticket.
              schema:
                type: string
        '204':
          description: Successfully deleted the key from a key group in NBKMS.
        '400': *ref_5
        '401': *ref_2
        '404':
          description: The specified key or key group does not exist.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_0
        '415': *ref_11
        '500': *ref_4
  /security/key-management-services/nbkms/keygroups:
    post:
      description: >
        Creates a key group in NBKMS.


        Note: In case multi-person authorization is configured, key group is not
        created immediately.

        However, a multi-person authorization ticket is initiated that needs
        approval. The ticket ID is

        returned in the response header.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|KMS|`\

        Requires Operation: `|OPERATIONS|SECURITY|KMS|SERVICES|CREATE|`
      tags:
        - Key Management Services
      parameters:
        - *ref_48
      requestBody:
        description: Key group configuration details.
        required: true
        content:
          application/vnd.netbackup+json;version=12.0:
            schema: &ref_160
              type: object
              description: Details of a key in a key group to be created in NBKMS.
              properties:
                data:
                  type: object
                  properties:
                    type:
                      type: string
                      enum:
                        - keygroupCreateRequest
                    attributes: &ref_168
                      type: object
                      description: Attributes for creating key group in NBKMS.
                      properties:
                        keyGroup:
                          type: string
                          description: Specifies the name of the key group.
                        algorithm:
                          type: string
                          default: AES256
                          description: Algorithm to be used to create key.
                          enum:
                            - AES128
                            - AES192
                            - AES256
                        comment:
                          type: string
                          description: >-
                            Specifies a comment about the key group to be
                            created.
                      required:
                        - keyGroup
              required:
                - data
      responses:
        '201':
          description: Successfully created a key group in NBKMS.
          headers:
            Location:
              description: The link to the newly created key group.
              schema:
                type: string
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: &ref_52
                type: object
                properties:
                  data:
                    type: object
                    properties:
                      links:
                        type: object
                        properties:
                          self: *ref_44
                      type:
                        type: string
                        enum:
                          - getKeygroupResponse
                      id:
                        type: string
                        description: Key group name.
                      attributes: &ref_165
                        type: object
                        properties:
                          keyGroup:
                            type: string
                            description: Specifies the name of the key group.
                          algorithm:
                            type: string
                            default: AES256
                            description: Algorithm to be used to create key group.
                            enum:
                              - AES128
                              - AES192
                              - AES256
                          keyCount:
                            type: integer
                            description: Specifies the number of keys in key group.
                          hasActiveKey:
                            type: boolean
                            description: Specifies whether the key group has an active key.
                          comment:
                            type: string
                            description: Specifies the comment for the key group.
                          creationTime:
                            type: string
                            format: date-time
                            description: >-
                              The time when the key group was created, in ISO
                              8601 timestamp format.
                          modificationTime:
                            type: string
                            format: date-time
                            description: >-
                              The time when the key group was last updated, in
                              ISO 8601 timestamp format.
                        required:
                          - keyGroup
                          - algorithm
                          - keyCount
                          - comment
                          - hasActiveKey
                          - creationTime
                          - modificationTime
                    required:
                      - links
                      - type
                      - id
                      - attributes
                required:
                  - data
        '202':
          description: >-
            The server has successfully received the request and the MPA
            approval is awaited.
          headers:
            X-NetBackup-MPA-Ticket:
              description: >-
                The Ticket ID of newly-generated multi-person authorization
                ticket.
              schema:
                type: string
        '400': *ref_5
        '401': *ref_2
        '409':
          description: The key group creation failed as it already exists.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_0
        '500': *ref_4
  '/security/key-management-services/nbkms/keygroups/{keyGroupName}':
    get:
      description: >
        Fetches key group details from NBKMS.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|KMS|`\

        Requires Operation: `|OPERATIONS|SECURITY|KMS|SERVICES|VIEW|`
      tags:
        - Key Management Services
      parameters:
        - *ref_50
      responses:
        '200':
          description: Successfully fetched key group details from NBKMS.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_52
        '400': *ref_5
        '401': *ref_2
        '404':
          description: The specified key group does not exist.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_0
        '500': *ref_4
    patch:
      description: >
        Updates a key group in NBKMS.


        Note: In case multi-person authorization is configured, key group is not
        updated immediately.

        However, a multi-person authorization ticket is initiated that needs
        approval. The ticket ID is

        returned in the response header.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|KMS|`\

        Requires Operation: `|OPERATIONS|SECURITY|KMS|SERVICES|UPDATE|`
      tags:
        - Key Management Services
      parameters:
        - *ref_50
        - *ref_48
      requestBody:
        description: Key group configuration to be updated.
        required: true
        content:
          application/vnd.netbackup+json;version=12.0:
            schema: &ref_161
              type: object
              description: Details of a key group to be updated in NBKMS.
              properties:
                data:
                  type: object
                  properties:
                    id:
                      type: string
                      description: Key group name.
                    type:
                      type: string
                      enum:
                        - keygroupUpdateRequest
                    attributes: &ref_169
                      type: object
                      description: >-
                        Attributes for updating key group. One or more optional
                        attributes needs to be specified.
                      properties:
                        keyGroup:
                          type: string
                          description: Specifies the new name of the key group.
                        comment:
                          type: string
                          description: >-
                            Specifies a comment about the key group to be
                            updated.
              required:
                - data
      responses:
        '202':
          description: >-
            The server has successfully received the request and the MPA
            approval is awaited.
          headers:
            X-NetBackup-MPA-Ticket:
              description: >-
                The Ticket ID of newly-generated multi-person authorization
                ticket.
              schema:
                type: string
        '204':
          description: Successfully updated the key group configuration in NBKMS.
        '400': *ref_5
        '401': *ref_2
        '404':
          description: The specified key group does not exist.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_0
        '409':
          description: The specified key group already exists.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_0
        '415': *ref_11
        '500': *ref_4
    delete:
      description: >
        Deletes a key group in NBKMS.


        Note: In case multi-person authorization is configured, key group is not
        deleted immediately.

        However, a multi-person authorization ticket is initiated that needs
        approval. The ticket ID is

        returned in the response header.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|KMS|`\

        Requires Operation: `|OPERATIONS|SECURITY|KMS|SERVICES|DELETE|`
      tags:
        - Key Management Services
      parameters:
        - *ref_50
        - *ref_48
        - name: X-NetBackup-Force-Delete
          in: header
          required: false
          schema:
            type: boolean
            default: false
          description: >
            A key group contains keys. A key group cannot be deleted unless all
            keys are deleted within the key group.

            This option deletes the key group and the associated keys.
      responses:
        '202':
          description: >-
            The server has successfully received the request and the MPA
            approval is awaited.
          headers:
            X-NetBackup-MPA-Ticket:
              description: >-
                The Ticket ID of newly-generated multi-person authorization
                ticket.
              schema:
                type: string
        '204':
          description: Successfully deleted the key group in NBKMS.
        '400': *ref_5
        '401': *ref_2
        '404':
          description: The specified key group does not exist.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_0
        '415': *ref_11
        '500': *ref_4
  '/security/key-management-services/nbkms/keygroups/{keyGroupName}/recoverkey':
    post:
      description: >
        Recovers a NBKMS key in the specified key group.


        Note: In case multi-person authorization is configured, key is not
        recovered immediately.

        However, a multi-person authorization ticket is initiated that needs
        approval. The ticket ID is

        returned in the response header.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|KMS|`\

        Requires Operation: `|OPERATIONS|SECURITY|KMS|SERVICES|CREATE|`
      tags:
        - Key Management Services
      parameters:
        - *ref_50
        - *ref_48
      requestBody:
        description: Details of the key to recover from NBKMS.
        required: true
        content:
          application/vnd.netbackup+json;version=12.0:
            schema: &ref_164
              type: object
              description: Details of the key to recover from NBKMS.
              properties:
                data:
                  type: object
                  properties:
                    type:
                      type: string
                      enum:
                        - recoverKeyRequest
                    attributes: &ref_174
                      type: object
                      properties:
                        keyName:
                          type: string
                          description: Specifies the name of the key.
                        keyTag:
                          type: string
                          description: Specifies the tag of the key.
                        passphrase:
                          type: string
                          description: The passphrase used while generating the key.
                        salt:
                          type: string
                          description: >
                            The salt used while generating the key with
                            NetBackup version 7.7 or later versions.

                            Empty value would mean no salt provided.
                        comment:
                          type: string
                          description: Specifies a comment about the key to be updated.
                      required:
                        - keyName
                        - keyTag
                        - passphrase
                        - salt
              required:
                - data
      responses:
        '202':
          description: >-
            The server has successfully received the request and the MPA
            approval is awaited.
          headers:
            X-NetBackup-MPA-Ticket:
              description: >-
                The Ticket ID of newly-generated multi-person authorization
                ticket.
              schema:
                type: string
        '204':
          description: Successfully recovered the specified NBKMS key.
        '400': *ref_5
        '401': *ref_2
        '404':
          description: The specified key group does not exist.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_0
        '409':
          description: A key with specified key tag or name already exists.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_0
        '500': *ref_4
  '/security/key-management-services/{kmsId}/validate':
    post:
      description: |
        Validates the configuration of the specified KMS.

         **Access Control**\
         Enforcement Type: [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\
         Namespace: `|SECURITY|KMS|`\
         Requires Operation: `|OPERATIONS|SECURITY|KMS|VALIDATE|`
      tags:
        - Key Management Services
      parameters:
        - *ref_47
      responses:
        '200':
          description: Successfully validated the configuration of the specified KMS.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: &ref_56
                type: object
                properties:
                  data:
                    type: object
                    properties:
                      links:
                        type: object
                        properties:
                          href:
                            type: string
                      type:
                        type: string
                        enum:
                          - validationResponseKms
                      id:
                        type: string
                        description: >-
                          Specifies a unique display name for the KMS
                          configuration.
                      attributes:
                        type: object
                        properties:
                          kmsInfo: *ref_53
                          certificateHealthCheckStatus:
                            type: array
                            items: &ref_155
                              type: object
                              properties:
                                validationId:
                                  type: string
                                  description: specifies a unique tag for healthcheck test.
                                validationName:
                                  type: string
                                  description: specifies the healthcheck test name.
                                status:
                                  type: string
                                  description: specifies the healthcheck test status.
                                errorMessage:
                                  type: string
                                  description: >-
                                    specifies an error message if healthcheck
                                    test fails.
                              required:
                                - validationId
                                - validationName
                                - status
                          connectionStatus:
                            type: object
                            properties:
                              errNo:
                                type: integer
                              errMsg:
                                type: string
                          listKeyStatus:
                            type: object
                            properties:
                              errNo:
                                type: integer
                              errMsg:
                                type: string
                              noOfKeys:
                                type: integer
                          getKeyStatus:
                            type: object
                            properties:
                              errNo:
                                type: integer
                              errMsg:
                                type: string
                          getKeyAttributesStatus:
                            type: object
                            properties:
                              errNo:
                                type: integer
                              errMsg:
                                type: string
                          setKeyAttributeStatus:
                            type: object
                            properties:
                              errNo:
                                type: integer
                              errMsg:
                                type: string
                        required:
                          - kmsInfo
                          - certificateHealthCheckStatus
                          - connectionStatus
                          - listKeyStatus
                          - getKeyStatus
                          - getKeyAttributesStatus
                          - setKeyAttributeStatus
                    required:
                      - links
                      - type
                      - id
                      - attributes
                required:
                  - data
        '400': *ref_5
        '401': *ref_2
        '404': *ref_14
        '500': *ref_4
  '/security/key-management-services/{kmsId}/key-details':
    get:
      description: >
        Queries the KMS server to retrieve the key details of the specified KMS
        config ID. The output of the query does not contain the key value.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|KMS|`\

        Requires Operation: `|OPERATIONS|SECURITY|KMS|SERVICES|VIEW|`
      tags:
        - Key Management Services
      parameters:
        - name: filter
          description: >
            Filter criteria syntax is based on OData standards. Filtering is
            supported on the following attributes:

            |Name|Supported Operators|Description|Schema|

            |---|---|---|---|

            |keyGroupName|eq|The name of the group. This param is mutually
            exclusive of other query param|string|
          in: query
          required: false
          schema:
            type: string
        - name: 'page[limit]'
          description: The number of key-details records on one page after the offset.
          in: query
          required: false
          schema:
            type: integer
            default: 10
        - name: 'page[offset]'
          description: The key-details record offset.
          in: query
          required: false
          schema:
            type: integer
            default: 0
        - *ref_47
      responses:
        '200':
          description: Successfully retrieved the details of the keys.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: &ref_176
                type: object
                description: >-
                  Returns the details of the key. The output does not contain
                  the key value.
                required:
                  - data
                properties:
                  data:
                    type: array
                    items: &ref_178
                      type: object
                      required:
                        - type
                        - id
                        - attributes
                      properties:
                        type:
                          type: string
                          enum:
                            - keyAttributeDetailsResponse
                        id:
                          description: The response identifier.
                          type: string
                        attributes:
                          type: object
                          required:
                            - keyAttributes
                          properties:
                            keyAttributes: &ref_175
                              type: object
                              required:
                                - keyId
                              properties:
                                kmsServerName:
                                  type: string
                                  description: >-
                                    Specifies the network name for the KMS
                                    server.
                                configurationName:
                                  type: string
                                  description: The unique identifier for the KMS server.
                                kmsServerPort:
                                  type: string
                                  description: >-
                                    The port used to connect to the external KMS
                                    server.
                                kmsType:
                                  type: string
                                  description: Specifies the KMS type.
                                  enum:
                                    - NBKMS
                                    - KMIP
                                kpkType:
                                  type: string
                                  description: The type of the key protection key (KPK).
                                  enum:
                                    - KPK_LOCAL
                                    - INVALID
                                updateTime:
                                  type: string
                                  description: Last modification time of the key.
                                kpkTag:
                                  type: string
                                  description: >-
                                    The unique identifier of the key protection
                                    key (KPK).
                                rev:
                                  type: integer
                                  description: The version of the key.
                                description:
                                  type: string
                                  description: Description of the key.
                                keyId:
                                  type: string
                                  description: The unique identifier for the key.
                                creationTime:
                                  type: string
                                  description: Creation time of the key.
                                keyState:
                                  type: string
                                  description: Current state of the key.
                                  enum:
                                    - INVALID
                                    - PRELIVE
                                    - ACTIVE
                                    - INACTIVE
                                    - DEPRECATED
                                    - TERMINATED
                                    - COMPROMISED
                                    - DESTROYED
                                    - DESTROYED_COMPROMISED
                                fipsApprovedKey:
                                  type: boolean
                                  description: FIPS Approved Key.
                                salt:
                                  type: string
                                  description: Random data used to generate key.
                                keyNames:
                                  type: array
                                  items:
                                    type: string
                                    description: The name of the key.
                                  description: List of key names.
                                requiredKad:
                                  type: string
                                  description: Required key associated data.
                                activationDate:
                                  type: string
                                  description: Key activation date/time.
                                deactivationDate:
                                  type: string
                                  description: Key deactivation date/time.
                                compromiseOccurrenceDate:
                                  type: string
                                  description: >-
                                    The date/time of key compromise occurrence
                                    event.
                                compromiseDate:
                                  type: string
                                  description: >-
                                    date/time when key enters into compromised
                                    state while revoking the key by user.
                                groupInfoList:
                                  type: array
                                  items: &ref_179
                                    type: object
                                    required:
                                      - keyGroupName
                                    properties:
                                      keyGroupName:
                                        type: string
                                        description: >-
                                          The name of the group to which key
                                          belongs.
                                      keyGroupId:
                                        type: string
                                        description: The group id to which key belongs.
                                  description: List of key group information.
                  links: *ref_54
                  meta:
                    type: object
                    properties:
                      pagination: *ref_55
        '400': *ref_5
        '401': *ref_2
        '404':
          description: The key management service with the specified ID does not exist.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_0
        '500': *ref_4
  /security/key-management-services-precheck:
    post:
      description: >
        Validates if the given PKI parameters can work with specified KMS
        server.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|KMS|`\

        Requires Operation: `|OPERATIONS|SECURITY|KMS|VALIDATE|`
      tags:
        - Key Management Services
      requestBody:
        description: KMS configuration details.
        required: true
        content:
          application/vnd.netbackup+json;version=12.0:
            schema: &ref_148
              type: object
              properties:
                data:
                  type: object
                  properties:
                    type:
                      type: string
                      description: >-
                        The resource definition type returned for the key
                        management service API.
                      enum:
                        - keyManagementServiceConfigurationPrecheck
                    attributes:
                      type: object
                      properties:
                        kmsType:
                          type: string
                          description: Specifies the KMS type.
                          enum:
                            - NETBACKUP
                            - KMIP
                        kmsServerAttributes: &ref_149
                          type: object
                          description: The properties of external key management service.
                          properties:
                            port:
                              type: integer
                              description: >-
                                Specifies the port to be used to connect to
                                external KMS server.
                            kmsServerName:
                              type: string
                              description: Specifies the network name for the KMS server.
                          required:
                            - port
                            - kmsServerName
                        credId:
                          type: string
                          description: >-
                            Specifies the credential ID of the KMS
                            configuration.
                        pkiAttributes: &ref_150
                          type: object
                          description: Certificate details used to for authentication.
                          properties:
                            certificate:
                              type: string
                              description: >-
                                Specifies certificate to be used while
                                authenticating with external KMS.
                            privateKey:
                              type: string
                              description: Specifies the private key for the certificate.
                            caCertificate:
                              type: string
                              description: >-
                                Specifies trust certificate to be used while
                                verifying external KMS.
                            passphrase:
                              type: string
                              description: >-
                                Specifies the passphase of the private key, if
                                the private key is encrypted.
                            crlCheckLevel:
                              type: integer
                              description: >-
                                Specifies what level of certificate checks to be
                                performed
                          required:
                            - certificate
                            - cacertificate
                            - privatekey
                      required:
                        - kmsServerAttributes
                        - type
                  required:
                    - type
                    - attributes
              required:
                - data
      responses:
        '200':
          description: Successfully validated the configuration of the specified KMS.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_56
        '401': *ref_2
        '404': *ref_14
        '500': *ref_4
  '/security/key-management-services/{kmsId}/import':
    post:
      description: >
        Import KMS keys in the specified KMS.


        Note: In case multi-person authorization is configured, keys are not
        imported immediately.

        However, a multi-person authorization ticket is initiated that needs
        approval. The ticket ID is

        returned in the response header.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|KMS|`\

        Requires Operation: `|OPERATIONS|SECURITY|KMS|SERVICES|IMPORT|`
      tags:
        - Key Management Services
      parameters:
        - *ref_47
      requestBody:
        description: Encrypted KMS key file and their details to import in specified KMS.
        required: true
        content:
          multipart/vnd.netbackup+form-data;version=12.0:
            schema:
              type: object
              required:
                - kmsReqBody
                - importKeyFile
              properties:
                kmsReqBody: &ref_162
                  type: object
                  description: Details to import keys in specified KMS.
                  properties:
                    data:
                      type: object
                      properties:
                        type:
                          type: string
                          enum:
                            - keyImportConfiguration
                        attributes: &ref_170
                          type: object
                          properties:
                            passphrase:
                              type: string
                              description: >-
                                The passphrase to be used to decrypt keys which
                                need to import in specfied KMS.
                            preserveKgName:
                              type: boolean
                              description: >-
                                Specifies whether need to preserve the key group
                                name from imported keys, by default
                                preserveKgName will false.
                            comment:
                              type: string
                              description: Specifies a comment about importing the keys.
                          required:
                            - passphrase
                  required:
                    - data
                importKeyFile:
                  description: >
                    This file contain encrypted KMS keys(Max key file upload
                    limit is 20 MB).
                  type: string
                  format: binary
      responses:
        '200':
          description: Succesfully imported KMS keys in specified KMS.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: &ref_171
                type: object
                properties:
                  data:
                    type: object
                    properties:
                      type:
                        type: string
                        enum:
                          - importKeysResponse
                      id:
                        type: string
                        description: Specifies an import response.
                      attributes:
                        type: object
                        properties:
                          messages:
                            description: The list of status messages.
                            type: array
                            items:
                              type: string
                              description: The status message.
        '202':
          description: >-
            The request was successfully received by the server and is awaiting
            MPA approval.
          headers:
            X-NetBackup-MPA-Ticket:
              description: >-
                The Ticket ID of newly-generated multi-person authorization
                ticket.
              schema:
                type: string
        '400': *ref_5
        '401': *ref_2
        '409':
          description: Import KMS keys failed as it already exists.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_0
        '415': *ref_11
        '500': *ref_4
  '/security/key-management-services/{kmsId}/export':
    post:
      description: >
        Export KMS keys from the specified KMS.


        Note: If multi-person authorization is configured, the keys are not
        immediately exported.

        However, a multi-person authorization ticket is initiated that needs
        approval. The ticket ID is returned

        in the response header. After the ticket is approved and the operation
        is executed, you can see

        the exported data in the API response. You can copy the API response in
        a file and use the file

        to import the keystore.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|KMS|`\

        Requires Operation: `|OPERATIONS|SECURITY|KMS|SERVICES|EXPORT|`
      tags:
        - Key Management Services
      parameters:
        - *ref_47
      requestBody:
        description: Details of the key to export from the specified KMS.
        required: true
        content:
          application/vnd.netbackup+json;version=12.0:
            schema: &ref_163
              type: object
              description: Details of the keys to export from specified KMS.
              properties:
                data:
                  type: object
                  properties:
                    type:
                      type: string
                      enum:
                        - keyExportConfiguration
                    attributes: &ref_172
                      type: object
                      properties:
                        passphrase:
                          type: string
                          description: >-
                            The passphrase to be used to encrypt keys which need
                            to be exported from specified KMS.
                        keyGroups:
                          type: array
                          description: >-
                            Specifies the list of key groups and its respective
                            keys to export from specified KMS.
                          items: &ref_173
                            type: object
                            properties:
                              name:
                                type: string
                                description: >-
                                  The name of key group whose keys need to be
                                  exported from the specified KMS.
                              keys:
                                type: array
                                description: >-
                                  List of key names from the given Key group
                                  that need to be exported. If not specified,
                                  then all keys from the given Key group are
                                  exported.
                                items:
                                  type: string
                            required:
                              - name
                      required:
                        - passphrase
                        - keyGroups
              required:
                - data
      responses:
        '200':
          description: Successfully exported the specified KMS keys.
          content:
            application/vnd.netbackup+octet-stream;version=12.0:
              schema:
                type: string
                format: binary
        '202':
          description: >-
            The request was successfully received by the server and is awaiting
            MPA approval.
          headers:
            X-NetBackup-MPA-Ticket:
              description: >-
                The Ticket ID of newly-generated multi-person authorization
                ticket.
              schema:
                type: string
        '400': *ref_5
        '401': *ref_2
        '404':
          description: >-
            Export KMS keys failed as either the key name or key-group name is
            invalid.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_0
        '500': *ref_4
  /security/credentials:
    put:
      description: >
        Sets the security credentials.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|CREDENTIALS|`\

        Requires Operation: `|OPERATIONS|ADD|`
      tags:
        - Credentials
      requestBody:
        content:
          application/vnd.netbackup+json;version=12.0:
            schema: &ref_202
              type: object
              properties:
                credName:
                  type: string
                  description: The name of the security credential key.
                  enum:
                    - DR_PKG_KEY
                credValue:
                  type: string
                  description: >-
                    The value that is associated with the security credential
                    key.
              required:
                - credName
                - credValue
        description: The security credential that needs to be set.
        required: true
      responses:
        '200':
          description: The request was successful.
        '400': *ref_5
        '401': *ref_2
        '415': *ref_11
  '/security/credentials/{credname}/isset':
    get:
      description: >
        Verifies whether a certain security credential is set or not.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|CREDENTIALS|`\

        Requires Operation: `|OPERATIONS|VIEW|`
      tags:
        - Credentials
      parameters:
        - &ref_104
          in: path
          description: The name of the security credential key
          name: credname
          required: true
          schema:
            type: string
            enum:
              - DR_PKG_KEY
      responses:
        '200':
          description: The request was successful.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: &ref_203
                type: boolean
                description: >-
                  A flag that specifies whether the security credential is set
                  or not.
        '401': *ref_2
        '406': *ref_3
        '500':
          description: There was an error when attempting to query the security credential.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_0
  /security/securitytokens:
    post:
      description: >
        Creates an authorization token based on the properties that are sent
        with the request payload.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|CERTIFICATE-MANAGEMENT|TOKENS|`\

        Requires Operation: `|OPERATIONS|ADD|`
      tags:
        - Tokens
      requestBody:
        content:
          application/vnd.netbackup+json;version=12.0:
            schema: &ref_199
              type: object
              properties:
                tokenName:
                  type: string
                  description: The token name to be created.
                hostId: *ref_57
                reason:
                  type: string
                  description: The reason for creating the token.
                allowedCount:
                  type: integer
                  maximum: 99999
                  description: >-
                    The maximum usage count of the token. The default value is
                    1.
                validFor:
                  type: integer
                  maximum: 86313600
                  description: >-
                    The validity of the token in seconds. The default validity
                    is 1 day.
                type: &ref_58
                  type: integer
                  description: >
                    The type of the token to be created. Here are the defined
                    values for the token types:

                    0 - Standard Token.

                    1 - Reissue Token.
              required:
                - tokenName
                - allowedCount
                - validFor
        description: The properties of the token to be created.
        required: true
      responses:
        '201':
          description: 'On successful response, the token value is sent.'
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: &ref_200
                type: object
                properties:
                  tokenValue:
                    type: string
                    description: The token value. Use for certificate deployment.
                required:
                  - tokenValue
        '400': *ref_5
        '401': *ref_2
        '404':
          description: >-
            In case of reissue-token, the host ID that is specified does not
            exist.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_0
        '406': *ref_3
        '409':
          description: The token already exists.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_0
        '415': *ref_11
        '500':
          description: Failed to create the token.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_0
        '503': *ref_13
    get:
      description: >
        Returns the data for all tokens in the form of a list.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|CERTIFICATE-MANAGEMENT|TOKENS|`\

        Requires Operation: `|OPERATIONS|VIEW|`
      tags:
        - Tokens
      parameters:
        - name: filter
          description: >
            Filter criteria syntax is based on OData standards. Filtering is
            supported on the following attributes:

            |Name|Supported Operators|Description|Schema|

            |---|---|---|---|

            |tokenName|eq|The name of the token |string|

            |allowedCount|eq ne lt gt le ge|The maximum usage count of the
            token.|integer|

            |usedCount|eq ne lt gt le ge|The used count of the token.|integer|

            |tokenActivationTime|eq ne lt gt le ge|The activation timestamp of
            the token, formatted in number of milliseconds since the Epoch,
            1970-01-01 00:00:00 +0000.|integer|

            |tokenExpirationTime|eq ne lt gt le ge|The expiry timestamp of the
            token, formatted in number of milliseconds since the Epoch,
            1970-01-01 00:00:00 +0000.|integer|
          in: query
          required: false
          schema:
            type: string
        - name: 'page[limit]'
          description: The number of tokens on one page after the offset.
          in: query
          required: false
          schema:
            type: integer
            default: 100
        - name: 'page[offset]'
          description: The tokens record offset.
          in: query
          required: false
          schema:
            type: integer
            default: 0
      responses:
        '200':
          description: 'On successful response, a list of tokens is sent.'
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: &ref_59
                type: object
                properties:
                  data:
                    type: array
                    items: &ref_201
                      type: object
                      properties:
                        links:
                          type: object
                          properties:
                            self: *ref_44
                        type:
                          type: string
                          description: >-
                            The resource definition type returned for the token
                            service API.
                          enum:
                            - getTokenData
                        id:
                          type: string
                          description: Specifies a unique token name.
                        attributes: &ref_60
                          type: object
                          properties:
                            tokenKey:
                              type: integer
                              description: For internal use.
                            tokenName:
                              type: string
                              description: The token name.
                            tokenValue: &ref_132
                              type: string
                              description: >
                                The authorization token. It can be of type
                                standard token, reissue token. Depending on the
                                certificate deployment security setting,
                                NetBackup hosts may require an authorization
                                token to obtain a host ID-based certificate from
                                the certificate authority (master server). To
                                request a certificate reissue, the token is
                                mandatory and should be of type reissue.
                            allowedCount:
                              type: integer
                              description: The maximum usage count of the token.
                            usedCount:
                              type: integer
                              description: The used count of the token.
                            hostId: *ref_57
                            tokenActivationTime: *ref_8
                            tokenExpirationTime: *ref_8
                            tokenType: *ref_58
                            tokenState:
                              type: integer
                              description: >
                                The validity of the token. A token is invalid if
                                the usedCount has exceeded the allowedCount, the
                                token is

                                not active yet, or the token has expired. It is
                                valid otherwise. Here are the defined values for
                                token

                                states:

                                0 - Not Valid.

                                1 - Valid.
                          required:
                            - tokenKey
                            - tokenName
                            - tokenValue
                            - allowedCount
                            - usedCount
                            - hostId
                            - tokenActivationTime
                            - tokenExpirationTime
                            - tokenType
                            - tokenState
                      required:
                        - links
                        - type
                        - id
                        - attributes
                    description: List of tokens.
                  links: *ref_54
                  meta:
                    type: object
                    properties:
                      pagination: *ref_55
                required:
                  - data
        '401': *ref_2
        '406': *ref_3
  /security/securitytokens/state/valid:
    get:
      description: >
        Returns the data for all valid tokens.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|CERTIFICATE-MANAGEMENT|TOKENS|`\

        Requires Operation: `|OPERATIONS|VIEW|`
      tags:
        - Tokens
      parameters:
        - name: filter
          description: >
            Filter criteria syntax is based on OData standards. Filtering is
            supported on the following attributes:

            |Name|Supported Operators|Description|Schema|

            |---|---|---|---|

            |tokenName|eq|The name of the token |string|

            |allowedCount|eq ne lt gt le ge|The maximum usage count of the
            token.|integer|

            |usedCount|eq ne lt gt le ge|The used count of the token.|integer|

            |tokenActivationTime|eq ne lt gt le ge|The activation timestamp of
            the token, formatted in number of milliseconds since the Epoch,
            1970-01-01 00:00:00 +0000.|integer|

            |tokenExpirationTime|eq ne lt gt le ge|The expiry timestamp of the
            token, formatted in number of milliseconds since the Epoch,
            1970-01-01 00:00:00 +0000.|integer|
          in: query
          required: false
          schema:
            type: string
        - name: 'page[limit]'
          description: The number of tokens on one page after the offset.
          in: query
          required: false
          schema:
            type: integer
            default: 100
        - name: 'page[offset]'
          description: The tokens record offset.
          in: query
          required: false
          schema:
            type: integer
            default: 0
      responses:
        '200':
          description: 'On successful response, a list of valid tokens is sent.'
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_59
        '401': *ref_2
        '406': *ref_3
  '/security/securitytokens/{tokenName}':
    get:
      description: >
        Returns the token data for the specified token.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|CERTIFICATE-MANAGEMENT|TOKENS|`\

        Requires Operation: `|OPERATIONS|VIEW|`
      tags:
        - Tokens
      parameters:
        - name: tokenName
          in: path
          required: true
          description: The token name.
          schema:
            type: string
      responses:
        '200':
          description: 'On successful response, the token data is sent.'
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_60
        '401': *ref_2
        '404':
          description: The token does not exist.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_0
        '406': *ref_3
  '/security/securitytokens/{tokenName}/delete':
    post:
      description: >
        Deletes an authorization token based on the token name that is specified
        in the URI.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|CERTIFICATE-MANAGEMENT|TOKENS|`\

        Requires Operation: `|OPERATIONS|DELETE|`
      tags:
        - Tokens
      parameters:
        - name: tokenName
          in: path
          required: true
          description: The token name.
          schema:
            type: string
      requestBody:
        content:
          application/vnd.netbackup+json;version=12.0:
            schema: &ref_61
              type: object
              properties:
                reason:
                  type: string
                  description: The reason for deleting the token.
        description: Specify the reason for deleting the token.
      responses:
        '204':
          description: Request successful.
        '400': *ref_5
        '401': *ref_2
        '404':
          description: The token does not exist.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_0
        '406': *ref_3
  /security/securitytokens/delete/invalid:
    post:
      description: >
        Cleans all invalid authorization tokens.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|CERTIFICATE-MANAGEMENT|TOKENS|`\

        Requires Operation: `|OPERATIONS|DELETE|`
      tags:
        - Tokens
      requestBody:
        content:
          application/vnd.netbackup+json;version=12.0:
            schema: *ref_61
        description: Specify the reason for deleting the invalid tokens.
      responses:
        '204':
          description: Request successful.
        '400': *ref_5
        '401': *ref_2
  /security/ping:
    get:
      description: >
        Tests the connection for the security service from the client. It
        returns the master server time in milliseconds.


        **Access Control**\

        Enforcement Type: `None`
      tags:
        - Utilities
      security: []
      responses:
        '200':
          description: Ping successful - master server time in milliseconds
          content:
            text/vnd.netbackup+plain;version=12.0:
              schema: *ref_8
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_8
        '406': *ref_3
  /security/servertime:
    get:
      description: >
        Returns the master server time in milliseconds, name and ID of timezone
        for master server in the JSON format.


        **Access Control**\

        Enforcement Type: `None`
      tags:
        - Utilities
      security: []
      responses:
        '200':
          description: >-
            On successful response, the master server time in milliseconds, name
            and ID of timezone for master server are sent in the JSON format.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: &ref_204
                type: object
                properties:
                  serverTime: *ref_8
                  timeZoneName: &ref_137
                    type: string
                    description: Time zone name of machine.
                  timeZoneId: &ref_138
                    type: string
                    description: Time zone ID of machine.
                required:
                  - serverTime
                  - timeZoneName
                  - timeZoneId
        '406': *ref_3
  /security/serverinfo:
    get:
      description: |
        Returns NetBackup master server information.

        **Access Control**\
        Enforcement Type: `None`
      tags:
        - Utilities
      security: []
      responses:
        '200':
          description: >-
            On successful response, the NetBackup master server information is
            sent.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: &ref_205
                type: object
                properties:
                  serverName:
                    type: string
                    description: The name of the NetBackup master server.
                  nbuVersion:
                    type: string
                    description: The version of the NetBackup master server.
                  cacpivConnectorPort:
                    type: integer
                    description: >-
                      The port NetBackup WebUI uses to connect to NetBackup
                      appliance when login with smart card option is selected.
                  nbuKeySize:
                    type: integer
                    description: >-
                      Displays the key size for new certificate key pair that
                      NetBackup generates.
                  masterHostId: *ref_57
                  externalCaUsage: *ref_62
                  cacpivEnabled: *ref_19
                  ssoEnabled: *ref_63
                  domainType:
                    type: string
                    description: The domain type that is associated with the master server.
        '406': *ref_3
  /security/api-keys:
    post:
      description: >
        Creates an API key. API Key is a high-entropy, pre-authenticated token
        that you can use to make requests to the

        NetBackup RESTful APIs. You have to login using your credentials to
        obtain an API key. Once the API key is

        generated, it can be directly used in the request header to invoke the
        NetBackup RESTful APIs.


        Note: In case multi-person authorization is configured, API Key is not
        created immediately.

        However, a multi-person authorization ticket is initiated that needs
        approval. The ticket ID is

        returned in the response header. Contact the MPA approver to approve the
        ticket. After you receive

        the ticket approval notification, use the /security/mpa-tickets/execute
        API to perform the required operation.


        Note: If this operation is subjected to adaptive MFA, then the response
        shall return a 202 http status code. The invoker of this API must

        invoke the URI mentioned in **X-NetBackup-MFA-Request** HTTP response
        header of the request to prove authenticity of the requestor.

        Please refer to the adaptive MFA validation
        [API](/api-docs/?urls.primaryName=security#/MFA/post_security_adaptive_mfa__requestId__validate)

        documentation for more information.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|USERS|API-KEYS|`\

        Requires Operation: `|OPERATIONS|ADD|`


        You can create an API key for yourself irrespective of whether you have
        the Manage API Keys permission or not.

        If you have the Manage API Keys permission, you can create API keys for
        other users.
      tags:
        - API Keys
      requestBody:
        content:
          application/vnd.netbackup+json;version=12.0:
            schema: &ref_206
              description: The request data for the creation of an API key.
              type: object
              required:
                - data
              properties:
                data:
                  description: >
                    The request payload contains the validity, description, or
                    both for an API key. To generate API keys for other users,
                    the security administrator should provide userName,
                    userDomain, and userDomainType.
                  type: object
                  required:
                    - type
                    - attributes
                  properties:
                    type:
                      type: string
                      description: The type of the key creation request.
                      enum:
                        - apiKeyCreationRequest
                    attributes:
                      description: |
                        The attributes of the key creation request.
                      type: object
                      required:
                        - expireAfterDays
                      properties:
                        expireAfterDays:
                          type: string
                          pattern: '^P[1-9][0-9]*D$'
                          format: iso8601
                          description: >
                            The factor to calculate the expiry date of an API
                            key. The expireAfterDays value is defined in the
                            ISO-8601 duration format and represented as PnD,
                            where 'n' is the number of days since the current
                            date. 'n' should be greater than '0'. The expiry
                            date of an API key is calculated based on
                            expireAfterDays. For example: If expireAfterDays is
                            P5D and the current date is
                            '2018-12-31T23:59:59+00:00', the expiry date is:
                            '2019-01-05T23:59:59+00:00'. Ensure that the value
                            specified for 'n' constitutes the expiry date, which
                            complies the following limitation:  The expiry date
                            must not be later than '3000-12-31T23:59:59+00:00'
                          example: P5D
                        userName:
                          type: string
                          description: The owner of the API key.
                        userDomain:
                          type: string
                          description: >
                            The domain of the user. If the userDomainType is
                            'unixpwd', an empty string ('') should be specified
                            for the userDomain.
                        userDomainType:
                          type: string
                          description: The domain type of the user.
                        description:
                          type: string
                          description: The description for the API key.
        description: The data required to create an API key.
        required: true
      responses:
        '201':
          description: Sends the details of an API key.
          headers:
            Location:
              description: The link to the newly created API key.
              schema:
                type: string
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: &ref_65
                description: The response on a successful creation of an API key.
                type: object
                required:
                  - data
                properties:
                  data:
                    description: >-
                      The response payload on a successful creation of an API
                      key.
                    type: object
                    required:
                      - type
                      - id
                      - attributes
                    properties:
                      links:
                        type: object
                      type:
                        description: The type of the key creation response.
                        type: string
                        enum:
                          - apiKeyCreationResponse
                      id:
                        type: string
                        description: >-
                          The API key tag. This is a unique tag mapped per API
                          key.
                      attributes:
                        description: The attributes of the key creation response.
                        type: object
                        required:
                          - apiKey
                          - expiryDateTime
                        properties:
                          apiKey:
                            type: string
                            description: >
                              The API key. An API Key is a high-entropy,
                              pre-authenticated token that you can use to make
                              requests to the NetBackup RESTful APIs.
                          expiryDateTime:
                            type: string
                            format: date-time
                            description: The expiry of the key in ISO 8601 timestamp.
                          issuer:
                            type: object
                            description: The issuer details of API key.
                            properties:
                              principalName:
                                type: string
                                description: The issuer's principal name for an API key.
                              principalDomain:
                                type: string
                                description: The issuer's principal domain for an API key.
                              principalDomainType:
                                type: string
                                description: >-
                                  The issuer's principal domain type for an API
                                  key.
                          userName:
                            type: string
                            description: >-
                              The name of user for which API key is being
                              issued.
        '202':
          description: >-
            The request to create the API key has been received by the server
            but needs an approval from either the multi-person authorization or
            multifactor authentication process.
          headers:
            X-NetBackup-MPA-Ticket:
              description: >-
                The Ticket ID of newly-generated multi-person authorization
                ticket.
              schema:
                type: string
            X-Netbackup-Ticket-Flags:
              description: The flags indicating properties of the ticket.
              schema:
                type: integer
            X-NetBackup-MFA-Request:
              description: The URI for MFA authentication.
              schema:
                type: string
        '400': *ref_5
        '401': *ref_2
        '409':
          description: The API key is already issued.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_0
        '415': *ref_11
        '500': *ref_4
    get:
      description: >
        Returns the details of all the API keys that are present in the
        database, based on specified filters.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|USERS|API-KEYS|`\

        Requires Operation: `|OPERATIONS|VIEW|`


        You can view your API key irrespective of whether you have the View API
        Keys and/or Manage API Keys permissions

        or not. If you have the View API Keys or Manage API Keys permissions,
        you can view the API keys that are created

        for other users.
      tags:
        - API Keys
      parameters:
        - name: filter
          description: >
            Filter criteria syntax is based on OData standards. Filtering is
            supported on the following attributes:

            |Name|Supported Operators|Description|Schema|

            |---|---|---|---|

            |userName|eq|The owner of the API key.|string|

            |userDomainType|eq|The domain type of the user.|string|

            |userDomain|eq|The domain name of the user.|string|

            |apiKeyTag|eq|The API key tag is a unique tag mapped per
            key.|string|

            |issuer/principalDomainType|eq|The principal domain type of API
            key.|string|

            |issuer/principalName|eq|The principal username of API key.|string|

            |issuer/principalDomain|eq|The principal domain of API key.|string|

            |createdDateTime|ge le|The created date time of an API key. The
            value is in date-time in ISO 8601 format.|date-time|

            |lastModifiedDateTime|ge le|The last modified date time of an API
            key. The value is in date-time in ISO 8601 format.|date-time|

            |expiryDateTime|ge le|The validity of an API key. The value of
            expiry is in date-time in ISO 8601 format.|date-time|
          in: query
          required: false
          schema:
            type: string
        - name: 'page[limit]'
          description: The number of API key records that are displayed on one page.
          in: query
          required: false
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 10
        - name: 'page[offset]'
          description: The API key record number offset.
          in: query
          required: false
          schema:
            type: integer
            minimum: 0
            default: 0
        - name: sort
          description: >
            Sorts the records in an ascending order. Use '-' as a prefix to sort
            the records in an descending order.
          in: query
          required: false
          schema:
            type: string
      responses:
        '200':
          description: >-
            Sends the details of all the keys that are present, based on
            specified filters.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: &ref_211
                description: >-
                  The response on a successful listing of details for all the
                  API keys.
                type: object
                required:
                  - data
                  - meta
                  - links
                properties:
                  links:
                    type: object
                    properties:
                      self:
                        type: object
                        properties:
                          href:
                            type: string
                      next:
                        type: object
                        properties:
                          href:
                            type: string
                      prev:
                        type: object
                        properties:
                          href:
                            type: string
                      first:
                        type: object
                        properties:
                          href:
                            type: string
                      last:
                        type: object
                        properties:
                          href:
                            type: string
                  data:
                    type: array
                    items: &ref_64
                      type: object
                      properties:
                        links:
                          type: object
                          properties:
                            self:
                              type: object
                              properties:
                                href:
                                  type: string
                        type:
                          description: The type of the response payload.
                          type: string
                          enum:
                            - apiKeyDetails
                        id:
                          type: string
                          description: >-
                            The API key tag. This is a unique tag mapped per API
                            key.
                        attributes:
                          description: The attributes of the response payload.
                          type: object
                          required:
                            - userName
                            - userDomain
                            - userDomainType
                            - createdDateTime
                            - expiryDateTime
                            - lastModifiedDateTime
                            - samlSessionValidated
                          properties:
                            userName:
                              type: string
                              description: The owner of the API key.
                            userDomain:
                              type: string
                              description: The domain of the user.
                            userDomainType:
                              type: string
                              description: The domain type of the user.
                            createdDateTime:
                              type: string
                              format: date-time
                              description: >-
                                The creation time of the key in ISO 8601
                                timestamp.
                            expiryDateTime:
                              type: string
                              format: date-time
                              description: The expiry of the key in ISO 8601 timestamp.
                            lastModifiedDateTime:
                              type: string
                              format: date-time
                              description: >-
                                The last time the validity of the key was
                                modified.
                            description:
                              type: string
                              description: The description of an API key.
                            samlSessionValidated:
                              type: boolean
                              description: The session validation status of SAML user.
                            issuer:
                              type: object
                              description: The issuer details of API key.
                              properties:
                                principalName:
                                  type: string
                                  description: The issuer's principal name for an API key.
                                principalDomain:
                                  type: string
                                  description: >-
                                    The issuer's principal domain for an API
                                    key.
                                principalDomainType:
                                  type: string
                                  description: >-
                                    The issuer's principal domain type for an
                                    API key.
                  meta:
                    type: object
                    properties:
                      pagination:
                        type: object
                        properties:
                          count:
                            type: integer
                          first:
                            type: integer
                          last:
                            type: integer
                          next:
                            type: integer
                          prev:
                            type: integer
                          page:
                            type: integer
                          pages:
                            type: integer
                          offset:
                            type: integer
                          limit:
                            type: integer
        '400': *ref_5
        '404': *ref_14
        '500': *ref_4
  '/security/api-keys/{apiKeyTag}':
    get:
      description: >
        Returns the details of an API key that is present in the database with
        the specified API key tag.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|USERS|API-KEYS|`\

        Requires Operation: `|OPERATIONS|VIEW|`


        You can view your API key details using the specified API key tag
        irrespective of whether you have the View API

        Keys and/or Manage API Keys permissions or not. If you have the View API
        Keys and/or Manage API Keys

        permissions, you can view the API keys that are created for other users
        using the specified API key tags.
      tags:
        - API Keys
      parameters:
        - name: apiKeyTag
          description: The API key tag is a unique tag mapped per key.
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Sends the details of an API key.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: &ref_210
                description: The response on a successful listing of the API key details.
                type: object
                properties:
                  data: *ref_64
        '404':
          description: The API key tag does not exist.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_0
        '500': *ref_4
    patch:
      description: >
        Update request for the API key.


        Note: In case multi-person authorization is configured, API Key is not
        updated immediately.

        However, a multi-person authorization ticket is initiated that needs
        approval. The ticket ID is

        returned in the response header. The validity of an API key is extended
        from the ticket approval date.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|USERS|API-KEYS|`\

        Requires Operation: `|OPERATIONS|UPDATE|`


        You can update your API key irrespective of whether you have the Manage
        API Keys permission or not.

        If you have the Manage API Keys permission, you can update the API keys
        that are created for other users.
      tags:
        - API Keys
      parameters:
        - name: apiKeyTag
          description: The API key tag is a unique tag mapped per key.
          in: path
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/vnd.netbackup+json;version=12.0:
            schema: &ref_207
              description: >-
                The request data to update the validity, description, or both of
                an API key.
              type: object
              required:
                - data
              properties:
                data:
                  description: >-
                    The request payload that contains the validity, description,
                    or both of an API key.
                  type: object
                  required:
                    - type
                    - id
                    - attributes
                  properties:
                    type:
                      type: string
                      description: The type of the update request for an API key.
                      enum:
                        - apiKeyUpdateRequest
                    id:
                      type: string
                      description: >-
                        The API key tag. This is a unique tag mapped per API
                        key.
                    attributes:
                      description: The attributes of the update request for an API key.
                      type: object
                      properties:
                        expireAfterDays:
                          type: string
                          pattern: '^P[1-9][0-9]*D$'
                          format: iso8601
                          description: >
                            The factor to calculate the expiry date of an API
                            key. The expireAfterDays value is defined in the
                            ISO-8601 duration format and represented as PnD,
                            where 'n' is the number of days since the current
                            date. 'n' should be greater than '0'. The expiry
                            date of an API key is calculated based on
                            expireAfterDays. For example: If expireAfterDays is
                            P5D and the current date is
                            '2018-12-31T23:59:59+00:00', the expiry date is:
                            '2019-01-05T23:59:59+00:00'. Ensure that the value
                            specified for 'n' constitutes the expiry date, which
                            complies the following limitation: The expiry date
                            must not be later than '9999-12-31T23:59:59+00:00'
                          example: P5D
                        description:
                          type: string
                          description: The description for an API key.
        description: The validity of an API key.
        required: true
      responses:
        '202':
          description: >-
            The request was successfully received by the server and is awaiting
            MPA approval.
          headers:
            X-NetBackup-MPA-Ticket:
              description: >-
                The Ticket ID of newly-generated multi-person authorization
                ticket.
              schema:
                type: string
        '204':
          description: The request is successful.
        '400': *ref_5
        '404':
          description: The API key tag does not exist.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_0
        '409':
          description: The API key is already expired.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_0
        '415': *ref_11
        '500': *ref_4
    delete:
      description: >
        Deletes an API key record that is present in the database with the
        specified API key tag.


        Note: In case multi-person authorization is configured, API Key is not
        deleted immediately.

        However, a multi-person authorization ticket is initiated that needs
        approval. The ticket ID is

        returned in the response header.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|USERS|API-KEYS|`\

        Requires Operation: `|OPERATIONS|DELETE|`


        You can delete your API key irrespective of whether you have the Manage
        API Keys permission or not.

        If you have the Manage API Keys permission, you can delete the API keys
        that are created for other users.
      tags:
        - API Keys
      parameters:
        - name: apiKeyTag
          description: The API key tag is a unique tag mapped per key.
          in: path
          required: true
          schema:
            type: string
      responses:
        '202':
          description: >-
            The request was successfully received by the server and is awaiting
            MPA approval.
          headers:
            X-NetBackup-MPA-Ticket:
              description: >-
                The Ticket ID of newly-generated multi-person authorization
                ticket.
              schema:
                type: string
        '204':
          description: The request is successful.
        '403': &ref_97
          description: Forbidden. An attempt to alter system-defined data was denied.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_0
        '404':
          description: The API key tag does not exist.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_0
        '500': *ref_4
  '/security/api-keys/{apiKeyTag}/reissue':
    post:
      description: >
        Reissues the new API key for given principal and delete the old API key
        associated with this principal.


        Note: In case multi-person authorization is configured, API Key is not
        reissued immediately.

        However, a multi-person authorization ticket is initiated that needs
        approval. The ticket ID is

        returned in the response header. Contact the MPA approver to approve the
        ticket. After you receive

        the ticket approval notification, use the /security/mpa-tickets/execute
        API to perform the required operation.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|USERS|API-KEYS|`\

        Requires Operation: `|OPERATIONS|SECURITY|USERS|API-KEYS|REISSUE|`\

        Requires Operation: `|OPERATIONS|VIEW|`\

        Requires Operation: `|OPERATIONS|DELETE|`\

        Requires Operation: `|OPERATIONS|ADD|`


        You can reissue an API key for yourself irrespective of whether you have
        the Manage API Keys permission or not.

        If you have the Manage API Keys permission, you can reissue API keys for
        other users.
      tags:
        - API Keys
      parameters:
        - name: apiKeyTag
          description: The API key tag is a unique tag mapped per key.
          in: path
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/vnd.netbackup+json;version=12.0:
            schema: &ref_208
              description: The request data to reissue an API key.
              type: object
              required:
                - data
              properties:
                data:
                  description: >-
                    The request payload that contains the validity, description,
                    or both of an API key.
                  type: object
                  required:
                    - type
                    - id
                    - attributes
                  properties:
                    type:
                      type: string
                      description: The type of the reissue request for an API key.
                      enum:
                        - apiKeyReissueRequest
                    id:
                      type: string
                      description: >-
                        The API key tag. This is a unique tag mapped per API
                        key.
                    attributes:
                      description: The attributes of the revoke request for an API key.
                      type: object
                      required:
                        - expireAfterDays
                      properties:
                        expireAfterDays:
                          type: string
                          pattern: '^P[1-9][0-9]*D$'
                          format: iso8601
                          description: >
                            The factor to calculate the expiry date of an API
                            key. The expireAfterDays value is defined in the
                            ISO-8601 duration format and represented as PnD,
                            where 'n' is the number of days since the current
                            date. 'n' should be greater than '0'. The expiry
                            date of an API key is calculated based on
                            expireAfterDays. For example: If expireAfterDays is
                            P5D and the current date is
                            '2018-12-31T23:59:59+00:00', the expiry date is:
                            '2019-01-05T23:59:59+00:00'. Ensure that the value
                            specified for 'n' constitutes the expiry date, which
                            complies the following limitation: The expiry date
                            must not be later than '9999-12-31T23:59:59+00:00'
                          example: P5D
                        description:
                          type: string
                          description: The description for an API key.
        description: The data required to reissue an API key.
        required: true
      responses:
        '201':
          description: Sends the details of an API key.
          headers:
            Location:
              description: The link to the newly created API key.
              schema:
                type: string
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_65
        '202':
          description: >-
            The request was successfully received by the server and is awaiting
            MPA approval.
          headers:
            X-NetBackup-MPA-Ticket:
              description: >-
                The Ticket ID of newly-generated multi-person authorization
                ticket.
              schema:
                type: string
            X-Netbackup-Ticket-Flags:
              description: The flags indicating properties of the ticket.
              schema:
                type: integer
        '400': *ref_5
        '401': *ref_2
        '409':
          description: The API key is already issued.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_0
        '415': *ref_11
        '500': *ref_4
  '/security/api-keys/{apiKeyTag}/revoke':
    patch:
      description: >
        Revoke the API key. It will make the API key unusable for further API
        invocations.


        Note: In case multi-person authorization is configured, API Key is not
        revoked immediately.

        However, a multi-person authorization ticket is initiated that needs
        approval. The ticket

        ID is returned in the response header.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|USERS|API-KEYS|`\

        Requires Operation: `|OPERATIONS|SECURITY|USERS|API-KEYS|REVOKE|`\

        Requires Operation: `|OPERATIONS|VIEW|`


        You can revoke your API key irrespective of whether you have the Manage
        API Keys permission or not.

        If you have the Manage API Keys permission, you can revoke the API keys
        that are created for other users.
      tags:
        - API Keys
      parameters:
        - name: apiKeyTag
          description: The API key tag is a unique tag mapped per key.
          in: path
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/vnd.netbackup+json;version=12.0:
            schema: &ref_209
              description: The request data to revoke an API key.
              type: object
              required:
                - data
              properties:
                data:
                  description: >-
                    The request payload that contains the description of an API
                    key.
                  type: object
                  required:
                    - type
                    - id
                    - attributes
                  properties:
                    type:
                      type: string
                      description: The type of the update request for an API key.
                      enum:
                        - apiKeyRevokeRequest
                    id:
                      type: string
                      description: >-
                        The API key tag. This is a unique tag mapped per API
                        key.
                    attributes:
                      description: The attributes of the revoke request for an API key.
                      type: object
                      properties:
                        description:
                          type: string
                          description: The reason for a API key revocation.
        description: The reason for a API key revocation.
        required: true
      responses:
        '202':
          description: >-
            The request was successfully received by the server and is awaiting
            MPA approval.
          headers:
            X-NetBackup-MPA-Ticket:
              description: >-
                The Ticket ID of newly-generated multi-person authorization
                ticket.
              schema:
                type: string
        '204':
          description: The request is successful.
        '400': *ref_5
        '403':
          description: Forbidden. An attempt to revoke non nbsp domain api keys was denied.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_0
        '404':
          description: The API key tag does not exist.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_0
        '409':
          description: The API key is already revoked.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_0
        '415': *ref_11
        '500': *ref_4
  /security/external-cacerts:
    post:
      description: >
        Allows upload of multiple external CA certificates to the smart card
        authentication trust-store. The certificate

        must be in the PEM, DER, or PKCS7 format. Maximum file size: 1024
        kilobytes.


        The following file extensions are supported:

        |File Encoding|File Extensions|

        |---|---|

        |PEM|.pem, .cer, .crt|

        |DER|.cer, .der|

        |PKCS7|.p7b, p7c|


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|USERS|CERTIFICATE-MANAGEMENT|`\

        Requires Operation:  `|OPERATIONS|ADD|`
      tags:
        - Certificates
      requestBody:
        content:
          application/x-www-form-urlencoded:
            schema:
              type: object
              properties:
                file:
                  description: The Certificate Authority (CA) certificate files.
                  type: string
                  format: binary
              required:
                - file
      responses:
        '200':
          description: Successfully uploaded the external CA certificates.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: &ref_66
                type: object
                required:
                  - data
                properties:
                  data:
                    type: array
                    items: &ref_67
                      type: object
                      properties:
                        links:
                          type: object
                          properties:
                            self:
                              type: object
                              properties:
                                href:
                                  type: string
                        type:
                          type: string
                          description: Type of object.
                          enum:
                            - caCertData
                        id:
                          type: string
                          description: SHA256 fingerprint of the certificate.
                        attributes:
                          type: object
                          description: The attributes of response payload.
                          required:
                            - commonName
                            - issuerName
                            - expiry
                            - sha-1Fingerprint
                            - sha-256Fingerprint
                          properties:
                            commonName:
                              type: string
                              description: The common name of certificate.
                            issuerName:
                              type: string
                              description: The issuer name of certificate.
                            expiry:
                              type: string
                              format: date-time
                              description: The expiry date and time of certificate.
                            sha-1Fingerprint:
                              type: string
                              description: SHA1 fingerprint of the certificate.
                            sha-256Fingerprint:
                              type: string
                              description: SHA256 fingerprint of the certificate.
                description: >-
                  The response for successful listing of details for all the
                  external CA certificates.
        '400': *ref_5
        '401': *ref_2
        '422':
          description: External CA certificate is invalid and cannot be processed.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: &ref_213
                type: object
                properties:
                  errorCode:
                    type: integer
                    format: int64
                    description: The NetBackup error code.
                  errorMessage:
                    type: string
                    description: The NetBackup error code description.
                  details:
                    type: object
                    description: >
                      A mapping of error code to error description to provide
                      more information about the error that you have
                      encountered.
                  fileUploadErrors:
                    type: array
                    description: >
                      The list of certificate files that cannot be upload to the
                      trust store. The associated error message for each file
                      that gives details about the reason for file upload
                      failure.
                    items: &ref_214
                      type: object
                      properties:
                        fileName:
                          type: string
                          description: >-
                            The file name of the certificate that cannot be
                            uploaded to the trust store.
                        errorMessage:
                          type: string
                          description: >
                            Error message which provides information about the
                            certificate file that cannot be uploaded to the
                            trust store.
                      required:
                        - fileName
                        - errorMessage
                required:
                  - errorCode
                  - errorMessage
        '500': *ref_4
    get:
      description: >
        Returns details of all the external CA certificates that are present in
        the smart card authentication

        trust-store.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|USERS|CERTIFICATE-MANAGEMENT|`\

        Requires Operation:  `|OPERATIONS|VIEW|`
      tags:
        - Certificates
      responses:
        '200':
          description: 'On success, lists the details of the external CA certificates.'
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_66
        '401': *ref_2
        '500': *ref_4
  '/security/external-cacerts/{certificateId}':
    get:
      description: >
        Returns specific certificate using fingerprint as alias from

        external CA certificates that are present in the smart card
        authentication

        trust-store.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|USERS|CERTIFICATE-MANAGEMENT|`\

        Requires Operation:  `|OPERATIONS|VIEW|`
      tags:
        - Certificates
      parameters:
        - name: certificateId
          in: path
          required: true
          description: The SHA256 fingerprint of the certificate.
          schema:
            type: string
      responses:
        '200':
          description: 'On success, the details of particular external CA certificate.'
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: &ref_212
                type: object
                required:
                  - data
                properties:
                  data: *ref_67
                description: Details of particular external CA certificate.
        '401': *ref_2
        '404':
          description: The external CA certificate does not exist.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_0
        '500': *ref_4
    delete:
      description: >
        Delete a specific external CA certificate based on the certificate alias
        that is specified in the URI.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|USERS|CERTIFICATE-MANAGEMENT|`\

        Requires Operation:  `|OPERATIONS|DELETE|`
      tags:
        - Certificates
      parameters:
        - name: certificateId
          in: path
          required: true
          description: The SHA256 fingerprint of the certificate.
          schema:
            type: string
      responses:
        '204':
          description: Request successful.
        '401': *ref_2
        '404':
          description: The external CA certificate does not exist.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_0
        '500': *ref_4
  /security/saml-certificates:
    post:
      description: >
        Generates the SAML certificate and the key-pairs, and populates them in
        the keystore for secure communication with the IDP provider.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|IDP|`\

        Requires Operation:  `|OPERATIONS|ADD|`
      tags:
        - Certificates
      requestBody:
        content:
          application/vnd.netbackup+json;version=12.0:
            schema: &ref_249
              type: object
              required:
                - data
              properties:
                data:
                  type: object
                  required:
                    - type
                    - attributes
                  properties:
                    type:
                      type: string
                      description: Type of object.
                      enum:
                        - NBCAConfiguredSamlCertificate
                    attributes:
                      type: object
                      description: The attributes of request payload.
                      properties:
                        force:
                          type: boolean
                          default: false
                          description: >-
                            Overwrites the existing SAML certificates and
                            regenerates the keystore.
        description: >-
          Overwrites the existing SAML certificates and regenerates the
          keystore.
        required: false
      responses:
        '204':
          description: SAML certificates and keystore are successfully generated.
        '400': *ref_5
        '401': *ref_2
        '409':
          description: The SAML certificate already exists.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_0
        '500': *ref_4
    delete:
      description: >
        Removes the SAML certificate and keystore.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|IDP|`\

        Requires Operation: `|OPERATIONS|DELETE|`
      tags:
        - Certificates
      responses:
        '204':
          description: The SAML certificate and keystore are successfully removed.
        '401': *ref_2
        '404': *ref_14
        '500': *ref_4
  /security/saml-certificates/renew:
    post:
      description: >
        Renews the SAML certificate and key-pair, and updates the keystore with
        the renewed SAML certificate and key-pair.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|IDP|`\

        Requires Operation:  `|OPERATIONS|ADD|`
      tags:
        - Certificates
      responses:
        '204':
          description: SAML certificates are renewed and the keystore is updated.
        '401': *ref_2
        '500': *ref_4
  /security/saml-external-certificates:
    post:
      description: >
        Generates external SAML certificate keystore for secure communication
        with the IDP provider.

        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|IDP|`\

        Requires Operation:  `|OPERATIONS|ADD|`
      tags:
        - Certificates
      requestBody:
        content:
          application/vnd.netbackup+json;version=12.0:
            schema: &ref_250
              type: object
              oneOf:
                - &ref_251
                  description: >-
                    The request data to capture the force option provided by the
                    user when the ECA SAML keystore is generated from the ECA
                    certificate configuration in NetBackup.
                  type: object
                  required:
                    - data
                  properties:
                    data:
                      type: object
                      required:
                        - type
                        - attributes
                      properties:
                        type:
                          type: string
                          description: Type of object.
                          enum:
                            - ECAConfiguredSamlCertificate
                        attributes:
                          type: object
                          description: The attributes of request payload.
                          properties:
                            force:
                              type: boolean
                              default: false
                              description: >-
                                Replaces the existing ECA SAML keystore and
                                passkey files based on the user input provided.
                - &ref_252
                  description: >-
                    The request data to capture the force option, the
                    certificate chain, private key and passkey file paths
                    provided by the user.
                  type: object
                  required:
                    - data
                  properties:
                    data:
                      type: object
                      required:
                        - type
                        - attributes
                      properties:
                        type:
                          type: string
                          description: Type of object.
                          enum:
                            - externalSamlCertificate
                        attributes:
                          type: object
                          description: The attributes of request payload.
                          required:
                            - certChainFilePath
                            - privateKeyFilePath
                          properties:
                            force:
                              type: boolean
                              default: false
                              description: >-
                                Replaces the existing ECA SAML keystore and
                                passkey files based on the user input provided.
                            certChainFilePath:
                              type: string
                              description: >-
                                Specifies the ECA SAML certificate chain file
                                path provided by the user. The file must be in
                                PEM format.
                            privateKeyFilePath:
                              type: string
                              description: >-
                                Specifies the ECA SAML private key file path
                                provided by the user. The file must be in PEM
                                format.
                            keystorePasskeyPath:
                              type: string
                              description: >-
                                Specifies the ECA SAML keystore passkey file
                                path provided by the user.
        description: >
          Generates external SAML certificate keystore for secure communication
          with the IDP provider.

          If the user has provided the certificate chain and private key file
          paths, new ECA SAML keystore is generated using the input provided.
          Otherwise, the ECA SAML keystore is generated from the ECA certificate
          configuration in NetBackup.
        required: false
      responses:
        '204':
          description: The ECA SAML keystore is successfully generated.
        '400': *ref_5
        '401': *ref_2
        '409':
          description: >-
            The ECA SAML keystore already exists. Set the force option to true
            to overwrite the existing keystore.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_0
        '500': *ref_4
    delete:
      description: >
        Removes the external SAML certificate and keystore.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|IDP|`\

        Requires Operation: `|OPERATIONS|DELETE|`
      tags:
        - Certificates
      responses:
        '204':
          description: The external SAML certificate and keystore are successfully removed.
        '401': *ref_2
        '404': *ref_14
        '500': *ref_4
  /security/certificate-authorities:
    get:
      description: |
        This API lists all NetBackup certificate authorities.

        **Access Control**\
        Enforcement Type: `None`
      tags:
        - NetBackup Certificate Authority
      security: []
      parameters:
        - name: filter
          description: >
            Filter criteria syntax is based on OData standards. Filtering is
            supported on the following attributes:

            |Name|Supported Operators|Description|Schema|

            |---|---|---|---|

            |state|eq|State of NetBackupCA. Possible values: ACTIVE, ABANDONED,
            DECOMMISSIONED|string|
          in: query
          required: false
          schema:
            type: string
        - name: 'page[limit]'
          description: The number of CA records that are displayed on one page.
          in: query
          required: false
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 10
        - name: 'page[offset]'
          description: The CA record number offset.
          in: query
          required: false
          schema:
            type: integer
            minimum: 0
            default: 0
        - name: 'page[disable]'
          description: >-
            Specifies that pagination should be disabled entirely. All results
            will be returned together.
          in: query
          required: false
          schema:
            type: boolean
            default: false
        - name: sort
          description: >
            Sorts in ascending order on the specified property. Use '-' as a
            prefix on the property to sort in descending order.
          in: query
          required: false
          schema:
            type: string
      responses:
        '200':
          description: 'On successful response, list of NetBackup CAs will be returned.'
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: &ref_219
                description: The response of successful listing of all CAs.
                type: object
                required:
                  - data
                  - meta
                  - links
                properties:
                  data:
                    type: array
                    items: &ref_68
                      description: Details of NetBackup CA.
                      type: object
                      required:
                        - type
                        - attributes
                      properties:
                        links:
                          type: object
                          properties:
                            self:
                              type: object
                              properties:
                                href:
                                  type: string
                        type:
                          type: string
                          enum:
                            - netbackupCADetails
                        attributes:
                          type: object
                          properties:
                            nbcaCertDetails: &ref_70
                              type: object
                              properties:
                                subjectCN:
                                  type: string
                                  description: The subject common name (CN)
                                keySize:
                                  type: integer
                                  description: Key size of the CA.
                                serialNumber: *ref_7
                                notBefore:
                                  type: string
                                  format: date-time
                                  description: >-
                                    Gets the date and time on which a
                                    certificate becomes valid.
                                notAfter:
                                  type: string
                                  format: date-time
                                  description: >-
                                    Gets the date and time after which a
                                    certificate is no longer valid.
                                subjectOU:
                                  type: string
                                  description: The subject Organizational Unit (OU)
                                state:
                                  type: string
                                  enum:
                                    - ACTIVE
                                    - ABANDONED
                                    - DECOMMISSIONED
                                  description: >
                                    State of NetBackup CA ACTIVE : This CA is
                                    the active CA in the NetBackup domain. It
                                    can be the default CA created by netbackup
                                    or a new CA created by API
                                    /security/certificate-authorities/initiate-migration.
                                    ABANDONED : This CA was once an active CA
                                    but not anymore. The state of CA was changed
                                    from ACTIVE to ABANDONED when a new CA is
                                    created using API
                                    /security/certificate-authorities/initiate-migration
                                    or the older CA gets ABANDONED when we
                                    activate the new CA using
                                    /security/certificate-authorities/activate.
                                    DECOMMISSIONED : This CA is no more
                                    supported by NetBackup and should be removed
                                    from the trust stores of NetBackup hosts. A
                                    CA can be decommissioned only if it is in
                                    ABANDONED state using the API
                                    /security/certificate-authorities/decommission.

                                    NOTE: The CA certificate in state ACTIVE,
                                    returned by API GET /security/cacert, will
                                    have their caCertAction set to "ADD". The CA
                                    certificate in state DECOMMISSIONED,
                                    returned by API GET /security/cacert, will
                                    have their caCertAction set to "REMOVE". The
                                    CA certificate in state ABANDONED will not
                                    be returned by API GET /security/cacert, as
                                    no action needs to be performed for them.
                                subjectName:
                                  type: string
                                  description: Complete subject name.
                                fingerprint:
                                  type: string
                                  description: >
                                    A certificate's SHA-1 fingerprint is the
                                    unique identifier of the certificate. It is
                                    a digest (hash function) of a certificate in
                                    x509 binary format calculated using SHA1
                                    algorithm.
                                sha-256Fingerprint:
                                  type: string
                                  description: >
                                    A certificate's SHA-256 fingerprint is the
                                    unique identifier of the certificate. It is
                                    a digest (hash function) of a certificate in
                                    x509 binary format calculated using SHA1
                                    algorithm.
                  meta:
                    type: object
                    properties:
                      pagination:
                        type: object
                        properties:
                          count:
                            type: integer
                          first:
                            type: integer
                          last:
                            type: integer
                          next:
                            type: integer
                          prev:
                            type: integer
                          page:
                            type: integer
                          pages:
                            type: integer
                          offset:
                            type: integer
                          limit:
                            type: integer
                  links:
                    type: object
                    properties:
                      self:
                        type: object
                        properties:
                          href:
                            type: string
                      next:
                        type: object
                        properties:
                          href:
                            type: string
                      prev:
                        type: object
                        properties:
                          href:
                            type: string
                      first:
                        type: object
                        properties:
                          href:
                            type: string
                      last:
                        type: object
                        properties:
                          href:
                            type: string
        '400': *ref_5
        '500': *ref_4
  '/security/certificate-authorities/{fingerprint}':
    get:
      description: >
        This API returns the details of a CA certificate present in the database
        with the specified fingerprint.


        **Access Control**\

        Enforcement Type: `None`
      tags:
        - NetBackup Certificate Authority
      parameters:
        - name: fingerprint
          description: The fingerprint of a certificate.
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: >-
            On successful response, the CA details with the matching fingerprint
            will be returned.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: &ref_218
                description: The response of successful listing of CA.
                type: object
                required:
                  - data
                properties:
                  data: *ref_68
        '404':
          description: The certificate with the corresponding fingerprint does not exist.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_0
        '500': *ref_4
  /security/certificate-authorities/hosts-pending-trust-propagation:
    get:
      description: >
        This API gets the list of hosts which are pending for trust propagation
        with new trust version CA.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|CERTIFICATE-MANAGEMENT|CERTIFICATE-AUTHORITIES|`\

        Requires Operation:
        `|OPERATIONS|SECURITY|CERTIFICATE-MANAGEMENT|CERTIFICATE-AUTHORITIES|MIGRATE-CA|`
        OR

        Requires Operation:
        `|OPERATIONS|SECURITY|CERTIFICATE-MANAGEMENT|CERTIFICATE-AUTHORITIES|VIEW-HOSTS-MIGRATE-CA|`
      tags:
        - NetBackup Certificate Authority
      responses:
        '200':
          description: List of hosts returned which are pending for trust propagation.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: &ref_225
                description: >-
                  The response on a successful listing of all the hosts which
                  are pending for trust propagation.
                type: object
                required:
                  - data
                properties:
                  data:
                    type: array
                    items: &ref_226
                      type: object
                      properties:
                        links:
                          type: object
                          properties:
                            self:
                              type: object
                              properties:
                                href:
                                  type: string
                        type:
                          description: The type of the response payload.
                          type: string
                          enum:
                            - hostPendingTrustPropagation
                        id:
                          type: string
                          description: The host ID of the host.
                        attributes:
                          description: The attributes of the response payload.
                          type: object
                          required:
                            - hostName
                            - trustVersion
                            - nbuVersion
                          properties:
                            hostName:
                              type: string
                              description: The name of the host machine.
                            trustVersion:
                              type: string
                              description: Trust version of the CA associated with host.
                            nbuVersion:
                              type: string
                              description: NBU version installed on host.
        '401': *ref_2
        '500': *ref_4
  /security/trust-versions:
    get:
      description: >
        This API lists all NetBackup master server trust versions.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|TRUST-VERSIONS|`\

        Requires Operation: `|OPERATIONS|VIEW|`
      tags:
        - NetBackup Master Server Trust Versions
      parameters:
        - name: 'page[limit]'
          description: The number of trust version records that are displayed on one page.
          in: query
          required: false
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 10
        - name: 'page[offset]'
          description: The trust version record number offset.
          in: query
          required: false
          schema:
            type: integer
            minimum: 0
            default: 0
        - name: sort
          description: |
            Sorts in descending order on the specified property.
          in: query
          required: false
          schema:
            type: string
      responses:
        '200':
          description: >-
            On successful response, list of NetBackup master server trust
            versions will be returned.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: &ref_223
                description: >-
                  The response of successful listing of NetBackup master server
                  trust versions.
                type: object
                required:
                  - data
                  - meta
                  - links
                properties:
                  data:
                    type: array
                    items: &ref_224
                      description: Details of NetBackup master server trust store version.
                      type: object
                      required:
                        - type
                        - id
                        - attributes
                        - relationships
                      properties:
                        links:
                          type: object
                          properties:
                            self:
                              type: object
                              properties:
                                href:
                                  type: string
                        type:
                          type: string
                          enum:
                            - trustVersionDetails
                        id:
                          type: string
                          description: The response identifier.
                        attributes:
                          properties:
                            operation:
                              type: string
                              enum:
                                - BOOTSTRAP
                                - AUTO_INITIATE_MIGRATION
                                - MANUAL_INITIATE_MIGRATION
                                - ACTIVATE
                                - MIGRATION_COMPLETE
                                - DECOMMISSION
                                - SYNC
                                - UNRECOGNIZED_VALUE
                              description: >
                                Operation because of which trust version was
                                created. BOOTSTRAP: The first trust version that
                                will be created in case of fresh install or
                                upgrade. AUTO_INITIATE_MIGRATION: When migration
                                is initiated automatically while upgrade.
                                MANUAL_INITIATE_MIGRATION: When migration is
                                initiated by user. ACTIVATE: When we activate
                                the next CA. MIGRATION_COMPLETE: When migration
                                is completed. DECOMMISSION: When a CA is
                                decommissioned. SYNC: When the database and VxAT
                                are synced manually. UNRECOGNIZED_VALUE: Default
                                value.
                            createdDateTime:
                              type: string
                              format: date-time
                              description: >-
                                Gets the date and time on the trust version was
                                created.
                        relationships:
                          type: object
                          properties:
                            netbackupCADetails: &ref_69
                              type: object
                              description: The associated NetBackup CA details.
                              properties:
                                links:
                                  type: object
                                  properties:
                                    related:
                                      type: object
                                      properties:
                                        href:
                                          type: string
                                data:
                                  type: array
                                  items: &ref_222
                                    type: object
                                    required:
                                      - id
                                      - type
                                    properties:
                                      type:
                                        type: string
                                        enum:
                                          - netbackupCADetails
                                      id:
                                        type: string
                                        description: >
                                          A certificate's fingerprint is the
                                          unique identifier of the certificate. 
                                          It is a digest (hash function) of a
                                          certificate in x509 binary format
                                          calculated using SHA1 algorithm.
                                  description: >-
                                    The list of the NetBackup CA fingerprint
                                    identifier object.
                              required:
                                - links
                                - data
                  meta:
                    type: object
                    properties:
                      pagination:
                        type: object
                        properties:
                          count:
                            type: integer
                          first:
                            type: integer
                          last:
                            type: integer
                          next:
                            type: integer
                          prev:
                            type: integer
                          page:
                            type: integer
                          pages:
                            type: integer
                          offset:
                            type: integer
                          limit:
                            type: integer
                  links:
                    type: object
                    properties:
                      self:
                        type: object
                        properties:
                          href:
                            type: string
                      next:
                        type: object
                        properties:
                          href:
                            type: string
                      prev:
                        type: object
                        properties:
                          href:
                            type: string
                      first:
                        type: object
                        properties:
                          href:
                            type: string
                      last:
                        type: object
                        properties:
                          href:
                            type: string
        '400': *ref_5
        '401': *ref_2
        '500': *ref_4
  '/security/trust-versions/{trustVersion}':
    get:
      description: >
        This API gets the CAs that are assiciated with the mentioned trust
        version.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|TRUST-VERSIONS|`\

        Requires Operation: `|OPERATIONS|VIEW|`
      tags:
        - NetBackup Master Server Trust Versions
      parameters:
        - name: trustVersion
          in: path
          required: true
          description: >
            Trust version maintained by NetBackup master, which is updated with
            every new CA being added or existing CA being revoked.
          schema:
            type: string
        - name: include
          description: >
            Appends the included section in the response payload with details
            about the relationships that are specified in the include query.
          in: query
          required: false
          schema:
            type: string
            enum:
              - netbackupCADetails
      responses:
        '200':
          description: >-
            On successful response, CAs that must be trusted for given
            trustVersion is returned.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: &ref_220
                type: object
                properties:
                  data:
                    type: object
                    properties:
                      links:
                        type: object
                        properties:
                          self:
                            type: object
                            properties:
                              href:
                                type: string
                      type:
                        type: string
                        description: Type of the object.
                        enum:
                          - trustVersion
                      id:
                        type: string
                        description: >-
                          Trust version for which NetBackup CA details are being
                          fetched.
                      attributes:
                        properties:
                          operation:
                            type: string
                            enum:
                              - BOOTSTRAP
                              - AUTO_INITIATE_MIGRATION
                              - MANUAL_INITIATE_MIGRATION
                              - ACTIVATE
                              - MIGRATION_COMPLETE
                              - DECOMMISSION
                              - UNRECOGNIZED_VALUE
                            description: >
                              Operation because of which trust version was
                              created. BOOTSTRAP: The first trust version that
                              will be created in case of fresh install or
                              upgrade AUTO_INITIATE_MIGRATION: When migration is
                              initiated automatically while upgrade
                              MANUAL_INITIATE_MIGRATION: When migration is
                              initiated by user ACTIVATE: When we activate the
                              next CA  MIGRATION_COMPLETE: When migration is
                              completed DECOMMISSION: When a CA is
                              decommissioned UNRECOGNIZED_VALUE: Default value.
                          createdDateTime:
                            type: string
                            format: date-time
                            description: >-
                              Gets the date and time on the trust version was
                              created.
                      relationships:
                        type: object
                        properties:
                          netbackupCADetails: *ref_69
                    required:
                      - links
                      - type
                      - id
                      - attributes
                      - relationships
                required:
                  - data
        '401': *ref_2
        '404': *ref_14
        '500': *ref_4
  /security/certificate-authorities/initiate-migration:
    post:
      description: >
        This operation initiates the migration of NetBackup certificate
        authority (NBCA).

        This should be done in certain scenarios, for example: When NBCA needs
        to be modified

        if you want to change the key size, when an existing NBCA is
        compromised, or because

        of a company policy mandating a new CA.

        This operation does not change the root CA for NetBackup, however this
        newly

        setup CA runs in stand-by mode, awaiting to be promoted to root CA by
        the

        API call /security/certificate-authorities/activate

        The state of new CA as fetched from API GET
        /security/certificate-authorities

        will be "ACTIVE".


        **API Versioned:**\

        A breaking change has been made to this API starting with version 8.0. 
        Requests made using the previous format will fail.\

        See the [Getting Started
        Guide](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started)
        for full details on what has changed and general information about API
        versioning.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|CERTIFICATE-MANAGEMENT|CERTIFICATE-AUTHORITIES|`\

        Requires Operation:
        `|OPERATIONS|SECURITY|CERTIFICATE-MANAGEMENT|CERTIFICATE-AUTHORITIES|MIGRATE-CA|`
      tags:
        - NetBackup Certificate Authority
      parameters:
        - *ref_48
      requestBody:
        content:
          application/vnd.netbackup+json;version=12.0:
            schema: &ref_216
              type: object
              required:
                - data
              properties:
                data:
                  type: object
                  required:
                    - type
                    - attributes
                  properties:
                    type:
                      type: string
                      enum:
                        - initiateCAMigrationRequest
                    attributes:
                      type: object
                      required:
                        - keySize
                      properties:
                        keySize:
                          type: integer
                          description: >-
                            Bit size used for generation of key pair of new CA.
                            In non-FIPS mode, NetBackup supports 2048, 3072,
                            4096 and 8192 bits for key size. In FIPS mode,
                            NetBackup only supports 2048 and 3072 bits for key
                            size.
      responses:
        '201':
          description: |
            On successful response, new NetBackup CA is created.
          headers:
            Location:
              description: The link to the newly created CA.
              schema:
                type: string
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: &ref_217
                type: object
                required:
                  - data
                properties:
                  data:
                    type: object
                    required:
                      - type
                      - attributes
                    properties:
                      links:
                        type: object
                        properties:
                          self:
                            type: object
                            properties:
                              href:
                                type: string
                      type:
                        type: string
                        enum:
                          - initiateCAMigrationResponse
                      attributes:
                        type: object
                        properties:
                          nbcaCertDetails: *ref_70
        '400': *ref_5
        '401': *ref_2
        '406': *ref_3
        '500': *ref_4
  /security/certificate-authorities/activate:
    post:
      description: >
        Activating new CA enables the CA that is setup by the API

        /security/certificate-authorities/initiate-migration.

        The new CA is then promoted to root CA.


        NOTE: This API should be used judiciously. The pre-requisite of

        calling this API is that the new CA created by

        /security/certificate-authorities/initiate-migration,

        is successfully propagated to the trust stores of all hosts in

        the master server domain.


        WARNING: If the pre-requisite is not met, communication with the

        hosts that do not have the new CA in their trust store may fail.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|CERTIFICATE-MANAGEMENT|CERTIFICATE-AUTHORITIES|`\

        Requires Operation:
        `|OPERATIONS|SECURITY|CERTIFICATE-MANAGEMENT|CERTIFICATE-AUTHORITIES|MIGRATE-CA|`
      tags:
        - NetBackup Certificate Authority
      parameters:
        - *ref_48
      requestBody:
        content:
          application/vnd.netbackup+json;version=12.0:
            schema: &ref_243
              description: >-
                The request data to specify whether to forcefully activate the
                NetBackup CA migration or not.
              type: object
              required:
                - data
              properties:
                data:
                  description: >-
                    The request payload to specify whether to forcefully
                    activate the NetBackup CA migration or not.
                  type: object
                  required:
                    - type
                    - attributes
                  properties:
                    type:
                      type: string
                      description: The type of the certificate activation request.
                      enum:
                        - nbcaMigrationActivateRequest
                    attributes:
                      description: The attributes of the NetBackup CA activation request.
                      type: object
                      properties:
                        force:
                          type: boolean
                          description: >
                            Specifies whether to forcefully activate the
                            NetBackup CA migration or not.

                            True - The NetBackup CA migration is forcefully
                            activated even if some of the hosts do not have the
                            required CA certificates in their trust stores.

                            False - The NetBackup CA migration is not activated
                            if some of the hosts do not have the required CA
                            certificates in their trust stores.
        description: Option to forcefully activate NBCA.
        required: false
      responses:
        '204':
          description: |
            On successful response, new NetBackup CA will be the new Root CA.
        '400': *ref_5
        '401': *ref_2
        '406': *ref_3
        '500': *ref_4
  /security/certificate-authorities/migration-complete:
    post:
      description: >
        This API marks the end of migration.

        This will cleanup the migration status maintained by the NetBackup

        master server, which will be used to show the progress of migration.

        So after this API call, migration status will show that no migration

        is in progress.

        This API call does not change the state of NetBackup CA.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|CERTIFICATE-MANAGEMENT|CERTIFICATE-AUTHORITIES|`\

        Requires Operation:
        `|OPERATIONS|SECURITY|CERTIFICATE-MANAGEMENT|CERTIFICATE-AUTHORITIES|MIGRATE-CA|`
      tags:
        - NetBackup Certificate Authority
      parameters:
        - *ref_48
      requestBody:
        content:
          application/vnd.netbackup+json;version=12.0:
            schema: &ref_244
              description: >-
                The request data to specifiy whether to forcefully complete the
                NetBackup CA migration or not.
              type: object
              required:
                - data
              properties:
                data:
                  description: >-
                    The request payload to specifiy whether to forcefully
                    complete the NetBackup CA migration or not.
                  type: object
                  required:
                    - type
                    - attributes
                  properties:
                    type:
                      type: string
                      description: The type of the migration complete request.
                      enum:
                        - nbcaMigrationCompleteRequest
                    attributes:
                      description: >-
                        The attributes of the NetBackup CA migration complete
                        request.
                      type: object
                      properties:
                        force:
                          type: boolean
                          description: >
                            Specifies whether the completion of NetBackup CA
                            migration should be done forcefully or not.

                            True - The NetBackup CA migration is forcefully
                            completed even if certificates for some of the hosts
                            are not renewed by the new root CA.

                            False - The NetBackup CA migration is not completed
                            if certificates for some of the hosts are not
                            renewed by the new root CA.
        description: Option to forcefully complete NBCA migration.
        required: false
      responses:
        '204':
          description: |
            On successful response, the migration state is cleaned up on the
            master server.
        '400': *ref_5
        '401': *ref_2
        '406': *ref_3
        '500': *ref_4
  '/security/certificate-authorities/{fingerprint}/decommission':
    post:
      description: >
        This API can be used to decommission a CA that is in ABANDONED state.
        The abandoned CAs

        can be listed using API GET
        /security/certificate-authorities?filter=state in (ABANDONED)


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|CERTIFICATE-MANAGEMENT|CERTIFICATE-AUTHORITIES|`\

        Requires Operation:
        `|OPERATIONS|SECURITY|CERTIFICATE-MANAGEMENT|CERTIFICATE-AUTHORITIES|MIGRATE-CA|
      tags:
        - NetBackup Certificate Authority
      parameters:
        - name: fingerprint
          description: The fingerprint of a certificate.
          in: path
          required: true
          schema:
            type: string
        - *ref_48
      responses:
        '204':
          description: >
            On successful response, the CA will be revoked.

            NetBackup will now initiate removal of this CA from the trust stores
            of its hosts.
        '400': *ref_5
        '401': *ref_2
        '404':
          description: Fingerprint does not exist.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_0
        '406': *ref_3
        '500': *ref_4
  /security/certificate-authorities/migration-summary:
    get:
      description: |
        This API retrieves the summary of NetBackup CA migration.

        **Access Control**\
        Enforcement Type: `None`
      tags:
        - NetBackup Certificate Authority
      security: []
      responses:
        '200':
          description: 'On success, NetBackup CA migration summary is returned.'
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: &ref_221
                description: >-
                  The response of successful listing of NetBackup CA migration
                  summary.
                type: object
                required:
                  - data
                properties:
                  data:
                    description: >-
                      The response of successful listing of NetBackup CA
                      migration summary.
                    type: object
                    required:
                      - id
                      - type
                      - attributes
                    properties:
                      id:
                        description: Fingerprint of the active NetBackup CA certificate.
                        type: string
                      type:
                        description: The type of NetBackup CA migration summary response.
                        type: string
                        enum:
                          - nbcaMigrationSummary
                      attributes:
                        description: >-
                          The attributes of NetBackup CA migration summary
                          response.
                        type: object
                        required:
                          - caMigrationStatus
                          - activeCaCert
                        properties:
                          caMigrationStatus:
                            description: >
                              State of NetBackup CA migration NO_MIGRATION : The
                              CA migration is not in progress. It may mean that
                              the migration is not initiated or it is completed.
                              INITIATED : The migration of NetBackup CA is
                              initiated. The new CA is not activated yet.
                              ACTIVATED : The newly created NetBackup CA is
                              activated.
                            type: string
                            enum:
                              - NO_MIGRATION
                              - INITIATED
                              - ACTIVATED
                          activeCaCert:
                            description: >-
                              An x.509 certificate of a currently active
                              NetBackup CA in a PEM-formatted string.
                            type: string
        '500': *ref_4
  /security/certificate-authorities/sync-migration-db:
    post:
      description: >
        This API will sync the migration database and NetBackup Certificate
        Authority if there is

        an inconsistency between them. It will bump the trust version and change
        the database according

        to the status of NetBackup Certificate Authority.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|CERTIFICATE-MANAGEMENT|CERTIFICATE-AUTHORITIES|`\

        Requires Operation:
        `|OPERATIONS|SECURITY|CERTIFICATE-MANAGEMENT|CERTIFICATE-AUTHORITIES|MIGRATE-CA|`
      tags:
        - NetBackup Certificate Authority
      parameters:
        - *ref_48
      responses:
        '204':
          description: >
            The migration database has been successfully synced with NetBackup
            Certificate Authority.
        '400': *ref_5
        '401': *ref_2
        '406': *ref_3
        '500': *ref_4
  /security/identity-providers:
    post:
      description: |
        Configures an identity provider (IdP) in NetBackup.

         **Access Control**\
         Enforcement Type: [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\
         Namespace: `|SECURITY|IDP|`\
         Requires Operation: `|OPERATIONS|ADD|`
      tags:
        - Identity Provider Services
      parameters:
        - *ref_48
      requestBody:
        description: Configuration details for the identity provider.
        required: true
        content:
          application/vnd.netbackup+json;version=12.0:
            schema: &ref_227
              type: object
              properties:
                data:
                  type: object
                  properties:
                    type:
                      type: string
                      description: >-
                        The resource type for the identity provider
                        configuration.
                      enum:
                        - idpConfiguration
                    attributes:
                      type: object
                      properties:
                        name:
                          type: string
                          description: The unique name of the identity provider.
                        idpMetadata:
                          type: string
                          description: >-
                            Identity provider metadata XML file content, in
                            Base64URL-encoded format.
                        idpType:
                          type: string
                          default: SAML2
                          description: >-
                            Indicates the type of protocol that the identity
                            provider supports.
                          enum:
                            - SAML2
                        enable:
                          type: boolean
                          default: false
                          description: >-
                            Indicates whether the specified identity provider is
                            enabled or disabled.
                        idpUserField:
                          type: string
                          description: >-
                            User field name from response assertion sent by an
                            identity provider.
                        idpUserGroupsField:
                          type: string
                          description: >-
                            User groups field name from response assertion sent
                            by an identity provider.
                      required:
                        - name
                        - idpMetadata
                        - idpType
                  required:
                    - type
                    - attributes
              required:
                - data
      responses:
        '201':
          description: Successfully configured the identity provider.
          headers:
            Location:
              description: The link to the newly created identity provider configuration.
              schema:
                type: string
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: &ref_229
                type: object
                properties:
                  data: &ref_230
                    type: object
                    properties:
                      links:
                        type: object
                        properties:
                          self: *ref_44
                      type:
                        type: string
                        description: >-
                          The resource definition type returned for the identity
                          provider configuration.
                        enum:
                          - idpConfigurationResponse
                      id:
                        type: string
                        description: The unique name of the identity provider.
                    required:
                      - links
                      - type
                      - id
                required:
                  - data
        '400': *ref_5
        '401': *ref_2
        '409':
          description: The specified identity provider is already configured.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_0
        '500': *ref_4
    get:
      description: |
        Gets the details for all the configured identity providers in NetBackup.

         **Access Control**\
         Enforcement Type: [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\
         Namespace: `|SECURITY|IDP|`\
         Requires Operation: `|OPERATIONS|VIEW|`
      tags:
        - Identity Provider Services
      parameters:
        - name: 'page[limit]'
          description: The number of key-details records on one page after the offset.
          in: query
          required: false
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 10
        - name: 'page[offset]'
          description: The key-details record offset.
          in: query
          required: false
          schema:
            type: integer
            minimum: 0
            default: 0
        - name: sort
          description: >-
            Sort in ascending order on the specified property. Prefix with "-"
            for descending order.
          in: query
          required: false
          schema:
            type: string
            default: '-enable'
      responses:
        '200':
          description: >-
            Successfully returned all the configured identity providers in
            NetBackup.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: &ref_232
                type: object
                properties:
                  data:
                    type: array
                    items: &ref_71
                      type: object
                      properties:
                        links:
                          type: object
                          properties:
                            self: *ref_44
                        type:
                          type: string
                          description: >-
                            The resource type returned for the identity provider
                            configuration.
                          enum:
                            - idpConfiguration
                        id:
                          type: string
                          description: The unique name of identity provider.
                        attributes:
                          type: object
                          properties:
                            name:
                              type: string
                              description: The unique name of the identity provider.
                            idpMetadata:
                              type: string
                              description: >-
                                Identity provider metadata XML file content, in
                                Base64URL-encoded format.
                            enable:
                              type: boolean
                              description: >-
                                Indicates whether the identity provider is
                                enabled or disabled.
                            idpType:
                              type: string
                              description: >-
                                The type of protocol that the identity provider
                                supports.
                            idpUserField:
                              type: string
                              description: >-
                                User field name from response assertion sent by
                                an identity provider.
                            idpUserGroupsField:
                              type: string
                              description: >-
                                User groups field name from response assertion
                                sent by an identity provider.
                          required:
                            - name
                            - idpMetadata
                            - enable
                            - idpType
                            - idpUserField
                            - idpUserGroupsField
                      required:
                        - links
                        - type
                        - id
                        - attributes
                  links: *ref_54
                  meta:
                    type: object
                    properties:
                      pagination: *ref_55
                required:
                  - data
        '401': *ref_2
        '500': *ref_4
  '/security/identity-providers/{name}':
    delete:
      description: >
        Deletes the identity provider with the specified ID from NetBackup.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|IDP|`\

        Requires Operation: `|OPERATIONS|DELETE|`
      tags:
        - Identity Provider Services
      parameters:
        - name: name
          in: path
          required: true
          description: The unique name of the identity provider.
          schema:
            type: string
        - *ref_48
      responses:
        '204':
          description: Successfully deleted the identity provider with the specified name.
        '401': *ref_2
        '404':
          description: The identity provider with the specified name does not exist.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_0
        '500': *ref_4
    get:
      description: >
        Returns the details of the identity provider in NetBackup with the
        specified name.

         **Access Control**\
         Enforcement Type: [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\
         Namespace: `|SECURITY|IDP|`\
         Requires Operation: `|OPERATIONS|VIEW|`
      tags:
        - Identity Provider Services
      parameters:
        - name: name
          in: path
          required: true
          description: The unique name of the identity provider.
          schema:
            type: string
      responses:
        '200':
          description: >-
            Successfully returned the details of the identity provider with the
            specified name.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: &ref_233
                type: object
                properties:
                  data: *ref_71
                required:
                  - data
        '401': *ref_2
        '404':
          description: The identity provider with the specified name does not exist.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_0
        '500': *ref_4
    patch:
      description: |
        Updates the configuration for the identity provider.

         **Access Control**\
         Enforcement Type: [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\
         Namespace: `|SECURITY|IDP|`\
         Requires Operation: `|OPERATIONS|UPDATE|`
      tags:
        - Identity Provider Services
      parameters:
        - name: name
          in: path
          required: true
          description: The unique name of the identity provider.
          schema:
            type: string
        - *ref_48
      requestBody:
        description: The attributes to update for the identity provider.
        required: true
        content:
          application/vnd.netbackup+json;version=12.0:
            schema: &ref_231
              description: >-
                The request that contains the parameters to update for the
                identity provider.
              type: object
              properties:
                data:
                  type: object
                  properties:
                    type:
                      type: string
                      description: >-
                        The resource type for the identity provider
                        configuration.
                      enum:
                        - idpUpdateConfiguration
                    attributes:
                      type: object
                      properties:
                        enable:
                          type: boolean
                          default: true
                          description: >-
                            Indicates whether specified identity provider is
                            enabled or disabled.
                        idpMetadata:
                          type: string
                          description: >-
                            Identity provider metadata XML file content, in
                            Base64URL-encoded format.
                  required:
                    - type
                    - attributes
              required:
                - data
      responses:
        '204':
          description: Successfully updated the attributes for the identity provider.
        '400': *ref_5
        '401': *ref_2
        '404':
          description: The identity provider with the specified name does not exist.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_0
        '500': *ref_4
  '/security/passphrase-constraints/{workflowType}':
    patch:
      description: >
        This API is used to define the passphrase constraints for various
        NetBackup

        workflows, for example disaster recovery (DR) package passphrase.

        There is a set of default constraints added at the time of installation.


        NOTE: It is strongly recommended that you set the passphrase as per

        the passphrase constraints that you have defined for this workflow.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|PASSPHRASE-CONSTRAINTS|`\

        Requires Operation: `|OPERATIONS|UPDATE|`
      tags:
        - Passphrase Constraints
      parameters:
        - name: workflowType
          description: >-
            Specifies the workflow for which the passphrase constraints are
            defined.
          in: path
          required: true
          schema: &ref_72
            type: string
            description: |
              * 'DR_PKG' - Passphrase for disaster recovery package.
            enum:
              - DR_PKG
      requestBody:
        content:
          application/vnd.netbackup+json;version=12.0:
            schema: &ref_245
              description: The request data to change the passphrase constraints.
              type: object
              required:
                - data
              properties:
                data:
                  description: >
                    The request payload contains the constraints for the
                    passphrase.
                  type: object
                  required:
                    - type
                    - attributes
                  properties:
                    type:
                      type: string
                      description: >-
                        The type of request to change the passphrase
                        constraints.
                      enum:
                        - setPassphraseConstraintsRequest
                    attributes:
                      description: |
                        The attributes of set passphrase constraints request.
                      type: object
                      properties:
                        minPassphraseLength:
                          type: integer
                          minimum: 8
                          maximum: 1024
                          description: >
                            The minimum length that is allowed for the
                            passphrase. 
                        minUpperCaseRequired:
                          minimum: 0
                          maximum: 1024
                          type: integer
                          description: >
                            The minimum number of upper case characters to
                            mandate in passphrase.
                        minLowerCaseRequired:
                          minimum: 0
                          maximum: 1024
                          type: integer
                          description: >
                            The minimum number of lower case characters to
                            mandate in passphrase.
                        minDigitsRequired:
                          minimum: 0
                          maximum: 1024
                          type: integer
                          description: >
                            The minimum number of digits to mandate in
                            passphrase.
                        minSpecialCharactersRequired:
                          minimum: 0
                          maximum: 1024
                          type: integer
                          description: >
                            The minimum number of special characters to mandate
                            in passphrase.

                            The supported special characters are
                            '~!@#$%^&*()_+-=`{}[]|:;",./?<>'
        description: The data required to set the passphrase constraints.
        required: true
      responses:
        '204':
          description: |
            The passphrase constraints are successfully saved.
        '400': *ref_5
        '401': *ref_2
        '404':
          description: The workflow type with the specified name does not exist.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_0
        '500': *ref_4
    get:
      description: >
        This API is used to retrieve the passphrase constraints for a specific
        NetBackup workflow.


        **Access Control**\

        Enforcement Type: `None`
      tags:
        - Passphrase Constraints
      parameters:
        - name: workflowType
          description: >-
            Specifies the workflow for which the passphrase constraints are
            defined.
          in: path
          required: true
          schema: *ref_72
      responses:
        '200':
          description: |
            The passphrase constraints are successfully fetched.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: &ref_247
                description: >-
                  The response data for passphrase constraints of a single
                  workflow.
                type: object
                required:
                  - data
                properties:
                  data: &ref_73
                    description: Passphrase constraint object.
                    type: object
                    required:
                      - type
                      - attributes
                    properties:
                      links:
                        type: object
                        properties:
                          self:
                            type: object
                            properties:
                              href:
                                type: string
                      type:
                        type: string
                        enum:
                          - passphraseConstraints
                      id:
                        type: string
                        description: >-
                          Workflow type for which the constraints are
                          applicable.
                      attributes:
                        type: object
                        properties:
                          minPassphraseLength:
                            type: integer
                            description: >
                              The minimum length that is allowed for the
                              passphrase. 
                          minUpperCaseRequired:
                            type: integer
                            description: >
                              The minimum number of upper case characters
                              mandated in passphrase.
                          minLowerCaseRequired:
                            type: integer
                            description: >
                              The minimum number of lower case characters
                              mandated in passphrase.
                          minDigitsRequired:
                            type: integer
                            description: >
                              The minimum number of digits mandated in
                              passphrase.
                          minSpecialCharactersRequired:
                            type: integer
                            description: >
                              The minimum number of special characters mandated
                              in passphrase.
                          regex:
                            type: string
                            description: >
                              The regex string made from the constraints to
                              match the input

                              string on the client side.
                          createdDateTime:
                            type: string
                            format: date-time
                            description: The creation time of the passphrase constraints.
                          lastModifiedDateTime:
                            type: string
                            format: date-time
                            description: >-
                              The last time when passphrase constraints were
                              modified.
        '401': *ref_2
        '404':
          description: The workflow type with the specified name does not exist.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_0
        '500': *ref_4
  /security/passphrase-constraints:
    get:
      description: >
        This API is used to retrieve the passphrase constraints for all workflow
        types.


        **Access Control**\

        Enforcement Type: `None`
      tags:
        - Passphrase Constraints
      responses:
        '200':
          description: |
            The passphrase constraints are successfully fetched.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: &ref_246
                description: The response data for passphrase constraints of all workflows.
                type: object
                required:
                  - data
                properties:
                  data:
                    type: array
                    items: *ref_73
        '401': *ref_2
        '500': *ref_4
  '/security/passphrase-constraints/{workflowType}/validate':
    post:
      description: >
        This API is used to validate the passphrase with constraints for various
        NetBackup

        workflows, for example disaster recovery (DR) package passphrase.
      tags:
        - Passphrase Constraints
      parameters:
        - name: workflowType
          description: >-
            Specifies the workflow for which the passphrase needs to get
            validate.
          in: path
          required: true
          schema: *ref_72
      requestBody:
        content:
          application/vnd.netbackup+json;version=12.0:
            schema: &ref_248
              description: The request data to get validate from passphrase constraints.
              type: object
              required:
                - data
              properties:
                data:
                  description: >
                    The request payload contains the workflow type and
                    passphrase.
                  type: object
                  required:
                    - type
                    - attributes
                  properties:
                    type:
                      type: string
                      description: The type of request to validate passphrase
                      enum:
                        - validatePassphraseRequest
                    attributes:
                      description: |
                        The attributes to validate passphrase
                      type: object
                      properties:
                        passphrase:
                          type: string
                          description: |
                            The passphrase to get validate against constraints.
        description: The data required to get validate by passphrase constraints.
        required: true
      responses:
        '204':
          description: |
            Passphrase validated successfully with constraints.
        '400':
          description: >
            The request contains an invalid parameter, or passphrase validation
            failed against constraints.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_0
        '401': *ref_2
        '404':
          description: The workflow type with the specified name does not exist.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_0
        '500': *ref_4
  /security/anomaly-configurations:
    get:
      description: >
        Retrieves the anomaly detection configuration.

        **Access Control**\ Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\
        Namespace: `|MANAGE|ANOMALIES|`\ Requires Operation:
        `|OPERATIONS|VIEW|`     
      tags:
        - Anomaly
      responses:
        '200':
          description: Successfully retrieved anomaly detection configuration.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: &ref_75
                type: object
                properties:
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        type:
                          type: string
                          enum:
                            - anomalyConfig
                        id:
                          type: string
                        attributes: &ref_74
                          type: object
                          properties:
                            anomalyProxyServer:
                              type: string
                              description: >
                                The server where anomaly detection algorithm
                                runs.

                                Default value is the current Primary server
                                name.
                            sensitivity:
                              type: integer
                              default: 0
                              description: >
                                Provides the sensitivity of anomaly detection in
                                percentage.

                                A positive percentage reduces the number of
                                anomaly alerts (cluster size will increase)

                                A negative percentage increases the number of
                                anomaly alerts (cluster size will decrease) 
                            purgeDataIntervalInMonths:
                              type: integer
                              default: 12
                              maximum: 12
                              description: >
                                Cleans up the database after the specified
                                number of months.
                            liveDataGatherFrequencyInMins:
                              type: integer
                              default: 15
                              description: |
                                Specifies the frequency of data gathering.
                            anomalyBackendService:
                              type: integer
                              default: 1
                              description: >
                                Enables/Disables anomaly alert and detection
                                services.

                                Provide 1 to enable anomaly alert and detection
                                services for un-structured policies.

                                Provide 2 to enable anomaly alert and detection
                                services for all policies which are not part of
                                excludeClientPolicy.

                                Provide 3 to disable anomaly alert and detection
                                services for all policies.
                            excludeClients:
                              type: array
                              description: |
                                Disables anomaly detection for a given client 
                              items:
                                type: string
                            excludeClientPolicy:
                              type: array
                              description: >
                                Disables anomaly detection for a given policy
                                under a client
                              items:
                                type: object
                                properties:
                                  client:
                                    type: string
                                  policy:
                                    type: string
                            disableFeaturePerPolicyType:
                              type: array
                              description: >
                                Disables features for anomaly detection for a
                                given policy type.
                              items:
                                type: object
                                properties:
                                  policyType:
                                    type: string
                                    enum:
                                      - STANDARD
                                      - OBACKUP
                                      - BIGDATA
                                      - INFORMIX
                                      - SYBASE
                                      - SHAREPOINT
                                      - WINDOWS
                                      - LOTUS_NOTES
                                      - BACKTRACK
                                      - WINDOWS_NT
                                      - SQL_SERVER
                                      - EXCHANGE
                                      - SAP
                                      - DB2
                                      - NDMP
                                      - FLASHBACKUP
                                      - DATASTORE
                                      - FBU_WINDOWS
                                      - VAULT
                                      - NBU_CATALOG
                                      - PUREDISK_EXPORT
                                      - ENTERPRISE_VAULT
                                      - VMWARE
                                      - UNIVERSAL_SHARE
                                      - KUBERNETES
                                      - CLOUD
                                      - DEPLOYMENT
                                      - HYPERVISOR
                                      - NAS_DATA_PROTECTION
                                  featuresToExclude:
                                    type: array
                                    description: >-
                                      Anomaly supported features to be excluded
                                      for specified policy type.
                                    items:
                                      type: string
                                      enum:
                                        - IMAGE_SIZE
                                        - NUM_FILES
                                        - DEDUP_RATE
                                        - KB_TRANSFERRED
                                        - TOTAL_TIME
                            disablePolicyTypes:
                              type: array
                              description: >
                                Disables anomaly detection for given policy
                                types.
                              items:
                                type: string
                                enum:
                                  - STANDARD
                                  - OBACKUP
                                  - BIGDATA
                                  - INFORMIX
                                  - SYBASE
                                  - SHAREPOINT
                                  - WINDOWS
                                  - LOTUS_NOTES
                                  - BACKTRACK
                                  - WINDOWS_NT
                                  - SQL_SERVER
                                  - EXCHANGE
                                  - SAP
                                  - DB2
                                  - NDMP
                                  - FLASHBACKUP
                                  - DATASTORE
                                  - FBU_WINDOWS
                                  - VAULT
                                  - NBU_CATALOG
                                  - PUREDISK_EXPORT
                                  - ENTERPRISE_VAULT
                                  - VMWARE
                                  - UNIVERSAL_SHARE
                                  - KUBERNETES
                                  - CLOUD
                                  - DEPLOYMENT
                                  - HYPERVISOR
                                  - NAS_DATA_PROTECTION
                            isRansomwareExtDetectionEnable:
                              type: boolean
                              default: true
                              description: >
                                Enables/Disables ransomware extension detection.
                                Default is enabled.

                                Provide false to disable.

                                Provide true to enable.
                            ransomwareExtDetectionMinPercentage:
                              type: integer
                              default: 10
                              description: >
                                Minimum percentage of ransomware extensions for
                                files required to be detected to raise backup
                                anomaly. Valid range is 10 to 100 percentage.
                            lastupdatedTime:
                              type: string
                              format: date-time
                              description: >-
                                The time in the ISO 8601 format (UTC) when the
                                anomaly record was updated.
        '401': *ref_2
    post:
      description: >
        Creates the anomaly detection configuration.

        **Access Control**\ Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\
        Namespace: `|MANAGE|ANOMALIES|`\ Requires Operation:
        `|OPERATIONS|UPDATE|`   
      tags:
        - Anomaly
      requestBody:
        content:
          application/vnd.netbackup+json;version=12.0:
            schema: &ref_253
              type: object
              required:
                - data
              properties:
                data:
                  type: array
                  items:
                    type: object
                    required:
                      - type
                      - attributes
                    properties:
                      type:
                        type: string
                        enum:
                          - anomalyConfig
                      attributes:
                        required:
                          - sensitivity
                          - purgeDataIntervalInMonths
                          - liveDataGatherFrequencyInMins
                          - disableAnomalyDetection
                          - disableDetectionService
                          - disableAlertService
                          - excludeClients
                          - excludeClientPolicy
                          - disableFeaturePerPolicyType
                          - disablePolicyTypes
                        allOf:
                          - *ref_74
      responses:
        '201':
          description: Successfully created anomaly detection configuration.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_75
        '400': *ref_5
        '401': *ref_2
        '409':
          description: The configuration already exists.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_0
        '415': *ref_11
        '500': *ref_4
  '/security/anomaly-configurations/{configId}':
    patch:
      description: >
        Updates the anomaly detection configuration.

        **Access Control**\ Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\
        Namespace: `|MANAGE|ANOMALIES|`\ Requires Operation:
        `|OPERATIONS|UPDATE|`   
      tags:
        - Anomaly
      parameters:
        - name: configId
          in: path
          required: true
          description: The configuration ID
          schema:
            type: string
      requestBody:
        content:
          application/vnd.netbackup+json;version=12.0:
            schema: &ref_254
              type: object
              required:
                - data
              properties:
                data:
                  type: object
                  required:
                    - type
                    - attributes
                  properties:
                    type:
                      type: string
                      enum:
                        - anomalyPatchConfig
                    attributes: *ref_74
      responses:
        '200':
          description: Successfully updated anomaly detection configuration.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: &ref_255
                type: object
                required:
                  - data
                properties:
                  data:
                    type: object
                    properties:
                      type:
                        type: string
                        enum:
                          - anomalyPatchConfig
                      id:
                        type: string
                      attributes: *ref_74
        '400': *ref_5
        '401': *ref_2
        '404': *ref_14
        '415': *ref_11
        '500': *ref_4
  /security/service-principal-configs:
    post:
      description: >
        Configures service principal in NetBackup. As part of this request
        following resources will be created within a single transaction:


        1.Add service principal configuration in NetBackup database.

        2.Create custom role for this service principal.

        3.Add access definition (RBAC permissions) into newly created custom
        role.

        4.Create an API key for this service principal.

         **Access Control**\
         Enforcement Type: [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\
         Namespace: `|SECURITY|SERVICE-PRINCIPAL|`\
         Requires Operation: `|OPERATIONS|ADD|`
      tags:
        - Service Principal Management
      parameters:
        - *ref_48
      requestBody:
        description: The configuration details of the service principal.
        required: true
        content:
          application/vnd.netbackup+json;version=12.0:
            schema: &ref_228
              type: object
              properties:
                data:
                  type: object
                  properties:
                    type:
                      type: string
                      description: The resource type for the service principal.
                      enum:
                        - servicePrincipalConfiguration
                    attributes:
                      type: object
                      properties:
                        servicePrincipalId:
                          type: string
                          maxLength: 63
                          description: >-
                            The unique id of the service principal created in
                            the NetBackup database. The principal is used to
                            interact with the NetBackup APIs.
                        servicePrincipalType:
                          type: string
                          maxLength: 63
                          description: >-
                            The service principal types are determined based on
                            the service integration use cases.
                        servicePrincipalApiKeyExpireAfterDays:
                          type: string
                          pattern: '^P[1-9][0-9]*D$'
                          format: iso8601
                          description: >
                            A factor to calculate the expiry date of an API key.
                            The servicePrincipalApiKeyExpireAfterDays value is
                            defined in the ISO-8601 duration format. Represented
                            as PnD, where 'n' is the number of days from the
                            current date. The 'n' has to be greater than '0'.
                            The expiry date of an API key is calculated based on
                            servicePrincipalApiKeyExpireAfterDays. For example:
                            If servicePrincipalApiKeyExpireAfterDays is P5D and
                            the current date is '2018-12-31T23:59:59+00:00', 
                            the expiry date is: '2019-01-05T23:59:59+00:00'.
                            Ensure that the value specified for 'n' constitutes
                            the expiry date, which complies the following
                            limitation:  The expiry date must not be later than
                            '9999-12-31T23:59:59+00:00',  The expiry date of
                            child service principal will always be less than the
                            expiry date parent service principal.
                          example: P5D
                        accessDefinitions:
                          type: array
                          description: >-
                            The list of access definitions assigned to the
                            service principal.
                          items: &ref_240
                            type: object
                            description: >-
                              The access definition granted to register the
                              service principal.
                            properties:
                              operations:
                                description: >-
                                  The list of operations included in the access
                                  definition.
                                type: array
                                items:
                                  type: string
                                  description: The name of the operation.
                              namespace:
                                description: The namespace of the access control object.
                                type: string
                            required:
                              - operations
                              - namespace
                            example:
                              operations:
                                - '|OPERATIONS|ADD|'
                                - '|OPERATIONS|DELETE|'
                                - '|OPERATIONS|VIEW|'
                              namespace: '|SECURITY|SERVICE-PRINCIPAL|'
                        isSecurityAdmin:
                          type: boolean
                          description: >-
                            Indicates whether the specified user is Security
                            Admin or not.
                          default: false
                      required:
                        - servicePrincipalId
                        - servicePrincipalType
                        - servicePrincipalApiKeyExpireAfterDays
                        - accessDefinitions
                  required:
                    - type
                    - attributes
              required:
                - data
      responses:
        '201':
          description: Sends the details of service principal configuration.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: &ref_234
                type: object
                description: >-
                  The response on a successful creation of service principal
                  resource.
                properties:
                  data: &ref_235
                    type: object
                    properties:
                      links:
                        type: object
                        properties:
                          self: *ref_44
                      type:
                        type: string
                        description: The resource type for the service principal.
                        enum:
                          - servicePrincipalConfigurationResponse
                      id:
                        type: string
                        description: The unique id of service principal.
                      attributes:
                        type: object
                        description: The configuration details of the service principal.
                        properties: &ref_238
                          servicePrincipalId:
                            type: string
                            description: The unique id of service principal.
                          servicePrincipalType:
                            type: string
                            description: Indicates the type of service principal.
                          createdBy:
                            type: string
                            description: >-
                              The principal name which created the service
                              principal.
                          apiKey:
                            type: string
                            description: >
                              The API key. An API Key is a high-entropy,
                              pre-authenticated token that you can use to make
                              requests to the NetBackup RESTful APIs.
                          expiryDateTime:
                            type: string
                            format: date-time
                            description: The expiry of the key in ISO 8601 timestamp.
                          isSecurityAdmin:
                            type: boolean
                            description: >-
                              Indicates whether the specified user is Security
                              Admin or not.
                            default: false
                        required: &ref_239
                          - servicePrincipalId
                          - servicePrincipalType
                          - createdBy
                          - apiKey
                          - expiryDateTime
                      relationships: &ref_76
                        type: object
                        required:
                          - apiKeyDetails
                          - roleDetails
                        properties:
                          apiKeyDetails:
                            description: The API key details of the service principal.
                            type: object
                            properties:
                              data: &ref_241
                                type: object
                                description: >-
                                  A resource identifier object that represents
                                  an API key resource.
                                required:
                                  - id
                                  - type
                                properties:
                                  id:
                                    type: string
                                  type:
                                    type: string
                                    enum:
                                      - apiKeyCreationResponse
                                      - apiKeyDetails
                              links:
                                type: object
                                properties:
                                  related:
                                    type: object
                                    properties:
                                      href:
                                        type: string
                                        description: The link to the API key details.
                                    required:
                                      - href
                          roleDetails:
                            description: The role details of the service principal.
                            type: object
                            properties:
                              data: &ref_242
                                type: object
                                description: >-
                                  A resource identifier object that represents
                                  an individual role resource.
                                required:
                                  - id
                                  - type
                                properties:
                                  id:
                                    type: string
                                  type:
                                    type: string
                                    enum:
                                      - accessControlRole
                                      - accessControlRoleV8
                              links:
                                type: object
                                properties:
                                  related:
                                    type: object
                                    properties:
                                      href:
                                        type: string
                                        description: The link to the role details.
                                    required:
                                      - href
                    required:
                      - links
                      - type
                      - id
                      - attributes
                      - relationships
                required:
                  - data
        '400': *ref_5
        '401': *ref_2
        '409':
          description: The specified service principal already exists.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_0
        '500': *ref_4
    get:
      description: >
        Returns the following details of all the service principal
        configurations in NetBackup:


        1.Service principal configuration details.

        2.The role details of each service principal.

        3.API key details of each service principal.

         **Access Control**\
         Enforcement Type: [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\
         Namespace: `|SECURITY|SERVICE-PRINCIPAL|`\
         Requires Operation: `|OPERATIONS|VIEW|`
      tags:
        - Service Principal Management
      parameters:
        - &ref_79
          in: query
          name: 'page[offset]'
          description: The number of records to skip before starting the page.
          schema:
            type: integer
            default: 0
            minimum: 0
        - &ref_80
          in: query
          name: 'page[limit]'
          description: The number of records to include in the page.
          schema:
            type: integer
            default: 10
            minimum: 0
            maximum: 100
        - name: sort
          description: >-
            Sorts in an ascending order on the specified property. Prefix with
            "-" for the descending order.
          in: query
          required: false
          schema:
            type: string
      responses:
        '200':
          description: >-
            Successfully returned all the service principals configurations in
            NetBackup.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: &ref_236
                type: object
                properties:
                  data:
                    type: array
                    items: &ref_77
                      type: object
                      description: >-
                        Returns the service principal configuration, API key
                        details and Role details of the service principal.
                      properties:
                        links:
                          type: object
                          properties:
                            self: *ref_44
                        type:
                          type: string
                          description: The resource type for the service principal.
                          enum:
                            - servicePrincipalResponse
                        id:
                          type: string
                          description: The unique id of service principal.
                        attributes:
                          type: object
                          description: The configuration details of the service principal.
                          properties:
                            servicePrincipalId:
                              type: string
                              description: The unique id of service principal.
                            servicePrincipalType:
                              type: string
                              description: Indicates the type of service principal.
                            createdBy:
                              type: string
                              description: >-
                                The principal name which created the service
                                principal.
                          required:
                            - servicePrincipalId
                            - servicePrincipalType
                            - createdBy
                        relationships: *ref_76
                      required:
                        - links
                        - type
                        - id
                        - attributes
                  links: *ref_54
                  meta:
                    type: object
                    properties:
                      pagination: *ref_55
                required:
                  - data
        '401': *ref_2
        '500': *ref_4
  '/security/service-principal-configs/{id}':
    delete:
      description: >
        Deletes the service principal configuration with the specified ID from
        NetBackup, as part this transaction following configurations will be
        deleted:


        1.Deletes the service principal configuration of specified service
        principal id.

        2.Deletes the role associated with the specified service principal id.

        3.Deletes the API key associated with the specified service principal
        id.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|SERVICE-PRINCIPAL|`\

        Requires Operation: `|OPERATIONS|DELETE|`
      tags:
        - Service Principal Management
      parameters:
        - name: id
          in: path
          required: true
          description: The unique id of the service principal configuration.
          schema:
            type: string
        - *ref_48
      responses:
        '204':
          description: >-
            Successfully deleted the service principal configuration with the
            specified id.
        '401': *ref_2
        '404':
          description: >-
            The service principal configuration with the specified id does not
            exist.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_0
        '500': *ref_4
    get:
      description: >
        Returns the following details of the service principal configuration in
        NetBackup with the specified service principal id:


        1.Service principal configuration details.

        2.The role details of each service principal.

        3.API key details of each service principal.

         **Access Control**\
         Enforcement Type: [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\
         Namespace: `|SECURITY|SERVICE-PRINCIPAL|`\
         Requires Operation: `|OPERATIONS|VIEW|`
      tags:
        - Service Principal Management
      parameters:
        - name: id
          in: path
          required: true
          description: The unique id of the service principal.
          schema:
            type: string
      responses:
        '200':
          description: >-
            Successfully returned the details of the service principal
            configuration with the specified id.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: &ref_237
                type: object
                properties:
                  data: *ref_77
                required:
                  - data
        '401': *ref_2
        '404':
          description: The service principal with the specified id does not exist.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_0
        '500': *ref_4
  /security/anomalies:
    get:
      description: >
        Retrieves the list of anomalies detected based on the specified filters.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|MANAGE|ANOMALIES|`\

        Requires Operation: `|OPERATIONS|VIEW|`
      tags:
        - Anomaly
      parameters:
        - name: filter
          description: >
            Filter criteria syntax is based on OData standards. Filtering is
            supported on the following attributes:

            |Name|Supported Operators|Description|Schema|

            |---|---|---|---|

            |id|eq|The unique identifier for anomaly.|string|

            |jobid|eq ne lt gt le ge|The job identifier.|string|

            |createdDateTime|lt gt le ge|The date and time when anomaly is
            detected.|date-time|

            |backupTime|ge le|The backup time of backup images in ISO 8601
            format.|date-time|

            |backupId|eq|The backup ID associated with the image.|string|

            |clientName|eq contains startswith endswith|Name of the NetBackup
            client where the anomaly was detected.|string|

            |policyName|eq contains startswith endswith|Name of the policy for
            which the anomaly was detected.|string|

            |policyType|eq contains startswith endswith|Name of the policy type
            for which the anomaly was detected. Possible values: STANDARD,
            PROXY, NONSTANDARD, APOLLO_WBAK, OBACKUP, ANY, INFORMIX, SYBASE,
            SHAREPOINT, WINDOWS, NETWARE, BACKTRACK, AUSPEX_FASTBACK,
            WINDOWS_NT, OS2, SQL_SERVER, EXCHANGE, SAP, DB2, NDMP, FLASHBACKUP,
            SPLITMIRROR, AFS, DFS, DATASTORE, LOTUS_NOTES, NCR_TERADATA,
            VAX_VMS, HP3000_MPE, FBU_WINDOWS, VAULT, BE_SQL_SERVER, BE_EXCHANGE,
            MAC, DS, NBU_CATALOG, GENERIC, CMS_DB, PUREDISK_EXPORT,
            ENTERPRISE_VAULT, VMWARE, HYPERV, NBU_SEARCHSERVER, HYPERSCALE,
            BIGDATA, CLOUD, DEPLOYMENT, HYPERVISOR, UNIVERSAL_SHARE,
            NAS_DATA_PROTECTION, KUBERNETES|string|

            |scheduleName|eq contains startswith endswith|Name of the schedule
            for which the anomaly was detected|string|

            |scheduleType|eq contains startswith endswith|Name of the schedule
            type for which the anomaly was detected. Possible values:
            FULL_BACKUP, DIFFERENTIAL_INCREMENTAL_BACKUP, USER_BACKUP,
            USER_ARCHIVE, CUMULATIVE_INCREMENTAL_BACKUP, VAULT_CATALOG_BACKUP,
            AUTOMATIC_BACKUP, APPLICATION_BACKUP, AUTOMATIC_FULL_BACKUP,
            AUTOMATIC_INCREMENTAL_BACKUP,
            AUTOMATIC_DIFFERENTIAL_INCREMENTAL_BACKUP,
            AUTOMATIC_CUMULATIVE_INCREMENTAL_BACKUP, AUTOMATIC_VAULT,
            ARCHIVE_REDO_LOG_BACKUP, TRANSACTION_LOG_BACKUP, PRE_CHECK,
            STAGE_PACKAGE, INSTALL_PACKAGE, UNUSED, UNRECOGNIZED_VALUE|string|

            |destinationStorage|eq contains startswith endswith|The destination
            storage of an image on which anomaly got reported.|string|

            |anomalyStatus|eq contains startswith endswith|Status of anomaly.
            Possible values: ANOMALY, NOT_REVIEWED, REPORTED_FALSE_POSITIVE,
            IGNORED|string|

            |anomalyCount|eq ne lt gt le ge|Specifies the number of features
            (such as Image size, Number of files etc.) for which anomalies were
            detected |integer|

            |anomalyScore|eq ne lt gt le ge|Anomaly score.|string|

            |anomalySeverity|eq ne|Severity of anomaly based on anomaly score.
            Possible values: HIGH, MEDIUM, LOW.|string|
          in: query
          required: false
          schema:
            type: string
        - name: 'page[offset]'
          description: The record number offset.
          in: query
          required: false
          schema:
            type: integer
            default: 0
            minimum: 0
        - name: 'page[limit]'
          description: The number of records on one page after the offset.
          in: query
          required: false
          schema:
            type: integer
            default: 10
            minimum: 1
            maximum: 100
        - name: sort
          description: >
            Sorts in ascending order on the specified property. Prefix with '-'
            for descending order.

            Sorting is supported on the following attributes:

            |Name|

            |---|

            |jobid|

            |createdDateTime|

            |clientName|

            |policyType|

            |scheduleType|

            |anomalyStatus|

            |anomalyCount|

            |anomalyScore|

            |anomalySeverity|
          in: query
          required: false
          schema:
            type: string
      responses:
        '200':
          description: >-
            Successfully retrieved the list of anomalies based on the specified
            filters.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: &ref_256
                type: object
                required:
                  - links
                  - data
                  - meta
                properties:
                  links:
                    type: object
                    properties:
                      self:
                        type: object
                        properties:
                          href:
                            type: string
                      next:
                        type: object
                        properties:
                          href:
                            type: string
                      prev:
                        type: object
                        properties:
                          href:
                            type: string
                      first:
                        type: object
                        properties:
                          href:
                            type: string
                      last:
                        type: object
                        properties:
                          href:
                            type: string
                  data:
                    type: array
                    items: &ref_257
                      type: object
                      required:
                        - links
                        - type
                        - id
                      description: The data specific to an anomaly.
                      properties:
                        type:
                          type: string
                          enum:
                            - anomaly
                        id:
                          type: string
                        attributes: &ref_258
                          type: object
                          required:
                            - createdDateTime
                            - backupTime
                            - jobid
                            - backupId
                            - clientName
                            - policyName
                            - policyType
                            - scheduleName
                            - scheduleType
                            - destinationStorage
                            - anomalyStatus
                            - anomalyType
                            - anomalyCount
                            - anomalyScore
                            - anomalySeverity
                            - anomalySummary
                            - extendedAttributes
                          properties:
                            createdDateTime:
                              type: string
                              format: date-time
                              description: >-
                                The ISO 8601 formatted time. The timestamp of
                                the anomaly was created.
                            backupTime:
                              type: string
                              format: date-time
                              description: Specifies the backup time.
                            jobid:
                              type: string
                              description: The job identifier.
                            backupId:
                              type: string
                              description: The backup ID or image ID.
                            clientName:
                              type: string
                              description: The name of the client to protect.
                            policyName:
                              type: string
                              description: The name of the policy used by this job.
                            policyType:
                              type: string
                              description: The backup policy type.
                              enum:
                                - STANDARD
                                - PROXY
                                - NONSTANDARD
                                - APOLLO_WBAK
                                - OBACKUP
                                - ANY
                                - INFORMIX
                                - SYBASE
                                - SHAREPOINT
                                - WINDOWS
                                - NETWARE
                                - BACKTRACK
                                - AUSPEX_FASTBACK
                                - WINDOWS_NT
                                - OS2
                                - SQL_SERVER
                                - EXCHANGE
                                - SAP
                                - DB2
                                - NDMP
                                - FLASHBACKUP
                                - SPLITMIRROR
                                - AFS
                                - DFS
                                - DATASTORE
                                - LOTUS_NOTES
                                - NCR_TERADATA
                                - VAX_VMS
                                - HP3000_MPE
                                - FBU_WINDOWS
                                - VAULT
                                - BE_SQL_SERVER
                                - BE_EXCHANGE
                                - MAC
                                - DS
                                - NBU_CATALOG
                                - GENERIC
                                - CMS_DB
                                - PUREDISK_EXPORT
                                - ENTERPRISE_VAULT
                                - VMWARE
                                - HYPERV
                                - NBU_SEARCHSERVER
                                - HYPERSCALE
                                - BIGDATA
                                - CLOUD
                                - DEPLOYMENT
                                - HYPERVISOR
                                - UNIVERSAL_SHARE
                                - NAS_DATA_PROTECTION
                            scheduleName:
                              type: string
                              description: >-
                                The name of the backup schedule used by the
                                backup job.
                            scheduleType:
                              type: string
                              description: The type of schedule used by the backup job.
                              enum:
                                - FULL_BACKUP
                                - DIFFERENTIAL_INCREMENTAL_BACKUP
                                - USER_BACKUP
                                - USER_ARCHIVE
                                - CUMULATIVE_INCREMENTAL_BACKUP
                                - VAULT_CATALOG_BACKUP
                                - AUTOMATIC_BACKUP
                                - APPLICATION_BACKUP
                                - AUTOMATIC_FULL_BACKUP
                                - AUTOMATIC_INCREMENTAL_BACKUP
                                - AUTOMATIC_DIFFERENTIAL_INCREMENTAL_BACKUP
                                - AUTOMATIC_CUMULATIVE_INCREMENTAL_BACKUP
                                - AUTOMATIC_VAULT
                                - ARCHIVE_REDO_LOG_BACKUP
                                - TRANSACTION_LOG_BACKUP
                                - PRE_CHECK
                                - STAGE_PACKAGE
                                - INSTALL_PACKAGE
                                - UNUSED
                                - UNRECOGNIZED_VALUE
                            destinationStorage:
                              type: string
                              description: The destination storage unit.
                            anomalyStatus:
                              type: string
                              description: The status of the anomaly.
                              enum:
                                - ANOMALY
                                - NOT_REVIEWED
                                - REPORTED_FALSE_POSITIVE
                                - IGNORED
                            anomalyType:
                              type: string
                              description: The type of the anomaly.
                              enum:
                                - JOB_BASED
                                - FILE_BASED
                                - SUSPICIOUS_FILE_EXTENSION
                                - CLIENT_OFFLINE_BASED
                                - FILE_ENTROPY
                            anomalyCount:
                              type: integer
                              description: >-
                                Specifies the number of features (such as Image
                                size, Number of files etc.) for which anomalies
                                were detected.
                            anomalyScore:
                              type: string
                              description: The anomaly score.
                            anomalySeverity:
                              type: string
                              description: Specifies the severity of anomaly detected.
                              enum:
                                - HIGH
                                - MEDIUM
                                - LOW
                            anomalySummary:
                              type: string
                              description: Specifies summary of Anomaly.
                            extendedAttributes:
                              type: object
                              description: >-
                                The additional attributes for generated anomaly
                                per feature.
                            assetId:
                              type: string
                              description: >-
                                Specifies the identifier of an asset of a
                                particular workload.
                              maxLength: 64
                            providerGeneratedId:
                              type: string
                              description: >
                                The provider identifier, which is unique within
                                the workloadType context that is provided by the
                                workload.
                              maxLength: 1024
                  meta:
                    type: object
                    properties:
                      pagination:
                        type: object
                        properties:
                          prev:
                            type: integer
                          next:
                            type: integer
                          first:
                            type: integer
                          last:
                            type: integer
                          count:
                            type: integer
                          offset:
                            type: integer
                          limit:
                            type: integer
        '400': *ref_5
        '401': *ref_2
        '500': *ref_4
  '/security/anomalies/{anomalyId}':
    delete:
      description: >
        Deletes the anomaly record for a given anomaly ID.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|MANAGE|ANOMALIES|`\

        Requires Operation: `|OPERATIONS|DELETE|`   
      tags:
        - Anomaly
      parameters:
        - name: anomalyId
          in: path
          required: true
          description: Delete anomaly based.
          schema:
            type: string
      responses:
        '204':
          description: Successfully deleted anomaly record.
        '400': *ref_5
        '401': *ref_2
        '404': *ref_14
        '500': *ref_4
    patch:
      description: >
        Updates the anomaly status based on anomaly ID specified.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|MANAGE|ANOMALIES|`\

        Requires Operation: `|OPERATIONS|UPDATE|`   
      tags:
        - Anomaly
      parameters:
        - name: anomalyId
          in: path
          required: true
          description: Unique identifier for anomaly on which status will get updated.
          schema:
            type: string
      requestBody:
        content:
          application/vnd.netbackup+json;version=12.0:
            schema: &ref_259
              type: object
              required:
                - data
              properties:
                data:
                  type: object
                  required:
                    - type
                    - attributes
                  properties:
                    type:
                      type: string
                      enum:
                        - patchAnomaly
                    attributes: &ref_78
                      type: object
                      required:
                        - anomalyStatus
                      properties:
                        anomalyStatus:
                          type: string
                          description: The status of the anomaly.
                          enum:
                            - ANOMALY
                            - NOT_REVIEWED
                            - REPORTED_FALSE_POSITIVE
                            - IGNORED
      responses:
        '200':
          description: Successfully updated anomaly record.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: &ref_262
                type: object
                required:
                  - data
                properties:
                  data:
                    type: object
                    required:
                      - type
                      - attributes
                      - id
                    properties:
                      type:
                        type: string
                        enum:
                          - patchAnomaly
                      id:
                        type: string
                      attributes: *ref_78
        '400': *ref_5
        '401': *ref_2
        '404': *ref_14
        '406': *ref_3
        '415': *ref_11
        '500': *ref_4
  /security/anomalies-exports:
    get:
      description: >
        Downloads the report of anomalies based on the export report type and
        the filters provided.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|MANAGE|ANOMALIES|`\

        Requires Operation: `|OPERATIONS|VIEW|`     
      tags:
        - Anomaly
      parameters:
        - name: filter
          description: >
            Filter criteria syntax is based on OData standards. Filtering is
            supported on the following attributes:

            |Name|Supported Operators|Description|Schema|

            |---|---|---|---|

            |id|eq|The unique identifier for anomaly.|string|

            |jobid|eq ne lt gt le ge|The job identifier.|string|

            |createdDateTime|lt gt le ge|The date and time when anomaly is
            detected.|date-time|

            |backupTime|ge le|The backup time of backup images in ISO 8601
            format.|date-time|

            |backupId|eq|The backup ID associated with the image.|string|

            |clientName|eq contains startswith endswith|Name of the NetBackup
            client where the anomaly was detected.|string|

            |policyName|eq contains startswith endswith|Name of the policy for
            which the anomaly was detected.|string|

            |policyType|eq contains startswith endswith|Name of the policy type
            for which the anomaly was detected. Possible values: STANDARD,
            PROXY, NONSTANDARD, APOLLO_WBAK, OBACKUP, ANY, INFORMIX, SYBASE,
            SHAREPOINT, WINDOWS, NETWARE, BACKTRACK, AUSPEX_FASTBACK,
            WINDOWS_NT, OS2, SQL_SERVER, EXCHANGE, SAP, DB2, NDMP, FLASHBACKUP,
            SPLITMIRROR, AFS, DFS, DATASTORE, LOTUS_NOTES, NCR_TERADATA,
            VAX_VMS, HP3000_MPE, FBU_WINDOWS, VAULT, BE_SQL_SERVER, BE_EXCHANGE,
            MAC, DS, NBU_CATALOG, GENERIC, CMS_DB, PUREDISK_EXPORT,
            ENTERPRISE_VAULT, VMWARE, HYPERV, NBU_SEARCHSERVER, HYPERSCALE,
            BIGDATA, CLOUD, DEPLOYMENT, HYPERVISOR, UNIVERSAL_SHARE,
            NAS_DATA_PROTECTION, KUBERNETES|string|

            |scheduleName|eq contains startswith endswith|Name of the schedule
            for which the anomaly was detected|string|

            |scheduleType|eq contains startswith endswith|Name of the schedule
            type for which the anomaly was detected. Possible values:
            FULL_BACKUP, DIFFERENTIAL_INCREMENTAL_BACKUP, USER_BACKUP,
            USER_ARCHIVE, CUMULATIVE_INCREMENTAL_BACKUP, VAULT_CATALOG_BACKUP,
            AUTOMATIC_BACKUP, APPLICATION_BACKUP, AUTOMATIC_FULL_BACKUP,
            AUTOMATIC_INCREMENTAL_BACKUP,
            AUTOMATIC_DIFFERENTIAL_INCREMENTAL_BACKUP,
            AUTOMATIC_CUMULATIVE_INCREMENTAL_BACKUP, AUTOMATIC_VAULT,
            ARCHIVE_REDO_LOG_BACKUP, TRANSACTION_LOG_BACKUP, PRE_CHECK,
            STAGE_PACKAGE, INSTALL_PACKAGE, UNUSED, UNRECOGNIZED_VALUE|string|

            |destinationStorage|eq contains startswith endswith|The destination
            storage of an image on which anomaly got reported.|string|

            |anomalyStatus|eq contains startswith endswith|Status of anomaly.
            Possible values: ANOMALY, NOT_REVIEWED, REPORTED_FALSE_POSITIVE,
            IGNORED|string|

            |anomalyCount|eq ne lt gt le ge|Specifies the number of features
            (such as Image size, Number of files etc.) for which anomalies were
            detected|integer|

            |anomalyScore|eq ne lt gt le ge|anomaly score.|string|

            |anomalySeverity|eq ne|Severity of anomaly based on anomaly score.
            Possible values: HIGH, MEDIUM, LOW.|string|
          in: query
          required: false
          schema:
            type: string
      responses:
        '200':
          description: Successfully downloaded anomalies report.
          content:
            text/vnd.netbackup+csv;version=12.0:
              schema:
                type: string
                format: binary
        '400': *ref_5
        '401': *ref_2
        '404': *ref_14
        '406':
          description: >-
            Invalid `Accept` type. Make sure your Accept header matches what
            this API produces.
          content:
            text/vnd.netbackup+csv;version=12.0:
              schema:
                type: string
        '500': *ref_4
  /security/anomalies/feedback:
    patch:
      description: >
        Update the feedback parameters of the specified policy and client.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|MANAGE|ENTROPY|`\

        Requires Operation: `|OPERATIONS|MANAGE-ACCESS|`
      tags:
        - Anomaly
      requestBody:
        description: The JSON body that contains the information for the request.
        required: true
        content:
          application/vnd.netbackup+json;version=12.0:
            schema: &ref_266
              type: object
              required:
                - data
              properties:
                data:
                  type: object
                  required:
                    - type
                    - attributes
                  properties:
                    type:
                      description: The request type.
                      type: string
                      enum:
                        - anomalyFeedbackPatchRequest
                    attributes: &ref_267
                      type: object
                      required:
                        - clientName
                        - policyName
                      properties:
                        clientName:
                          description: The client name.
                          type: string
                        policyName:
                          description: The policy name.
                          type: string
                        flistHash:
                          description: Hash of the file list in the stream
                          type: string
                        feedbackFlag:
                          description: The flag for the feedback.
                          type: number
                        feedbackRate:
                          description: The rate for the feedback.
                          type: number
                        feedbackThreshold:
                          description: The threshold for the feedback.
                          type: number
      responses:
        '204':
          description: Successfully updated the feedback parameters.
        '400': *ref_5
        '401': *ref_2
        '404': *ref_14
        '500': *ref_4
        '503': *ref_13
  /security/anomaly-extension-details:
    get:
      description: >
        Retrieves the list of extensions based on the specified filters.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|MANAGE|ANOMALIES|`\

        Requires Operation: `|OPERATIONS|VIEW|`
      tags:
        - Anomaly Extension
      parameters:
        - name: filter
          description: >
            Filter criteria syntax is based on OData standards. Filtering is
            supported on the following attributes:

            |Name|Supported Operators|Description|Schema|

            |---|---|---|---|

            |id|eq|The unique identifier for extension.|string|

            |createdDateTime|lt gt le ge|The date and time when extension is
            created.|date-time|

            |displayName|eq ne contains startswith endswith|The name of the
            plugin|string|

            |executedOnPlatform|eq ne contains startswith endswith|The name of
            the platform on which plugin in executed|string|

            |lastUpdatedDateTime|lt gt le ge|The date and time when extension is
            last updated.|date-time|
          in: query
          required: false
          schema:
            type: string
        - *ref_79
        - *ref_80
        - name: sort
          description: >
            Sorts in ascending order on the specified property. Prefix with '-'
            for descending order.

            Sorting is supported on the following attributes:

            |Name|

            |---|

            |createdDateTime|

            |displayName|
          in: query
          required: false
          schema:
            type: string
      responses:
        '200':
          description: >-
            Successfully retrieved the list of extensions based on the specified
            filters.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: &ref_283
                type: object
                required:
                  - links
                  - data
                  - meta
                properties:
                  links: *ref_54
                  data:
                    type: array
                    items:
                      properties:
                        type:
                          type: string
                          description: The type of the anomaly extension details.
                          enum:
                            - anomalyExtensionDetailDto
                        id:
                          type: string
                        attributes:
                          allOf:
                            - &ref_81
                              type: object
                              required:
                                - binaryName
                                - displayName
                                - isEnabled
                                - isPrimaryOnly
                                - executedOnPlatform
                                - executedOnHostName
                              properties:
                                binaryName:
                                  type: string
                                  description: The binary name of the extension.
                                displayName:
                                  type: string
                                  description: >-
                                    The name of the extension which will be used
                                    by WebUI.
                                isEnabled:
                                  type: boolean
                                  description: >-
                                    The flag to identify whether user has
                                    enabled extension or not.
                                isPrimaryOnly:
                                  type: boolean
                                  description: >-
                                    The flag to identify whether extension is
                                    for primary server or not.
                                executedOnPlatform:
                                  type: string
                                  description: >-
                                    An enum to identify extension is running on
                                    which platform.
                                  enum:
                                    - PRIMARY_SERVER
                                    - MEDIA_SERVER
                                executedOnHostName:
                                  type: string
                                  description: >-
                                    The host name of the server where extension
                                    is running.
                                configurationTemplate:
                                  type: object
                                  description: >-
                                    The configuration template of the existing
                                    extension.
                                configuration:
                                  type: object
                                  description: The configuration of the existing extension.
                            - type: object
                  meta:
                    type: object
                    properties:
                      pagination: *ref_55
        '400': *ref_5
        '401': *ref_2
        '406': *ref_3
        '500': *ref_4
  '/security/anomaly-extension-details/{extensionId}':
    get:
      description: >
        Retrieves the extension based on the ID.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|MANAGE|ANOMALIES|`\

        Requires Operation: `|OPERATIONS|VIEW|`
      tags:
        - Anomaly Extension
      parameters:
        - name: extensionId
          in: path
          required: true
          description: Get extension based on ID.
          schema:
            type: string
      responses:
        '200':
          description: Successfully retrieved the extension based on ID.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: &ref_282
                type: object
                required:
                  - data
                properties:
                  data:
                    type: object
                    required:
                      - type
                      - attributes
                      - id
                    description: The data specific to an extension.
                    properties:
                      type:
                        type: string
                        enum:
                          - anomalyExtensionDetailDto
                      id:
                        type: string
                      attributes:
                        allOf:
                          - *ref_81
                          - type: object
        '400': *ref_5
        '401': *ref_2
        '404': *ref_14
        '406': *ref_3
        '500': *ref_4
    delete:
      description: >
        Deletes the anomaly extension details based on ID specified.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|MANAGE|ANOMALIES|`\

        Requires Operation: `|OPERATIONS|DELETE|`
      tags:
        - Anomaly Extension
      parameters:
        - name: extensionId
          in: path
          required: true
          description: Unique identifier of extension.
          schema:
            type: string
      responses:
        '204':
          description: Successfully deleted anomaly extension detail record.
        '400': *ref_5
        '401': *ref_2
        '404': *ref_14
        '500': *ref_4
  '/security/anomaly-extension-configuration-template/{extensionId}':
    get:
      description: >
        Retrieves the configuration template of extension based on the ID.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|MANAGE|ANOMALIES|`\

        Requires Operation: `|OPERATIONS|VIEW|`
      tags:
        - Anomaly Extension
      parameters:
        - name: extensionId
          in: path
          required: true
          description: Get the configuration template of extension based on ID.
          schema:
            type: string
      responses:
        '200':
          description: >-
            Successfully retrieved the configuration template of extension based
            on ID.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: &ref_284
                type: object
                properties:
                  data:
                    type: object
                    required:
                      - type
                      - attributes
                      - id
                    description: The data specific to an extension configuration template.
                    properties:
                      type:
                        type: string
                        enum:
                          - anomalyExtensionConfigurationTemplate
                      id:
                        type: string
                      attributes: &ref_261
                        type: object
                        required:
                          - configurationTemplate
                        properties:
                          configurationTemplate:
                            type: object
                            description: >-
                              The configuration template of the existing
                              extension.
        '400': *ref_5
        '401': *ref_2
        '404': *ref_14
        '500': *ref_4
  '/security/anomaly-extension-configuration/{extensionId}':
    get:
      description: >
        Retrieves the configuration of extension based on the ID.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|MANAGE|ANOMALIES|`\

        Requires Operation: `|OPERATIONS|VIEW|`
      tags:
        - Anomaly Extension
      parameters:
        - name: extensionId
          in: path
          required: true
          description: Get the configuration of extension based on ID.
          schema:
            type: string
      responses:
        '200':
          description: Successfully retrieved the configuration of extension based on ID.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: &ref_285
                type: object
                required:
                  - data
                properties:
                  data:
                    type: object
                    required:
                      - type
                      - attributes
                      - id
                    description: The data specific to an extension configuration.
                    properties:
                      type:
                        type: string
                        enum:
                          - anomalyExtensionConfiguration
                      id:
                        type: string
                      attributes:
                        allOf:
                          - &ref_260
                            type: object
                            required:
                              - configuration
                            properties:
                              configuration:
                                type: object
                                description: The configuration of the existing extension.
                          - type: object
        '400': *ref_5
        '401': *ref_2
        '404': *ref_14
        '500': *ref_4
  /security/anomaly-extension:
    get:
      description: >
        Retrieves the list of anomalies for extension detected based on the
        specified filters.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|MANAGE|ANOMALIES|`\

        Requires Operation: `|OPERATIONS|VIEW|`
      tags:
        - Anomaly Extension
      parameters:
        - name: filter
          description: >
            Filter criteria syntax is based on OData standards. Filtering is
            supported on the following attributes:

            |Name|Supported Operators|Description|Schema|

            |---|---|---|---|

            |id|eq|The unique identifier for anomaly.|string|

            |createdDateTime|lt gt le ge|The date and time when anomaly is
            detected.|date-time|

            |anomalyStatus|eq ne|Status of anomaly. Possible values: ANOMALY,
            NOT_REVIEWED, REPORTED_FALSE_POSITIVE, IGNORED|string|

            |anomalySeverity|eq ne|Severity of anomaly based on anomaly score.
            Possible values: HIGH, MEDIUM, LOW.|string|

            |description|eq ne|Details of anomaly file extension. |string|

            |anomalyType|eq ne|Type of anomaly based on anomaly type.|string|

            |anomalyTypeDisplayName|eq ne|Display name of anomaly based on
            anomaly type.|string|
          in: query
          required: false
          schema:
            type: string
        - name: 'page[offset]'
          description: The record number offset.
          in: query
          required: false
          schema:
            type: integer
            default: 0
            minimum: 0
        - name: 'page[limit]'
          description: The number of records on one page after the offset.
          in: query
          required: false
          schema:
            type: integer
            default: 10
            minimum: 1
            maximum: 100
        - name: 'page[disable]'
          description: >-
            Specifies that pagination should be disabled entirely. All results
            will be returned together.
          in: query
          required: false
          schema:
            type: boolean
            default: false
        - name: sort
          description: >
            Sorts in ascending order on the specified property. Prefix with '-'
            for descending order.

            Sorting is supported on the following attributes:

            |Name|

            |---|

            |createdDateTime|

            |anomalyStatus|

            |anomalySeverity|
          in: query
          required: false
          schema:
            type: string
      responses:
        '200':
          description: >-
            Successfully retrieved the list of anomalies for extension based on
            the specified filters.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: &ref_280
                type: object
                required:
                  - links
                  - data
                  - meta
                properties:
                  links:
                    type: object
                    properties:
                      self:
                        type: object
                        properties:
                          href:
                            type: string
                      next:
                        type: object
                        properties:
                          href:
                            type: string
                      prev:
                        type: object
                        properties:
                          href:
                            type: string
                      first:
                        type: object
                        properties:
                          href:
                            type: string
                      last:
                        type: object
                        properties:
                          href:
                            type: string
                  data:
                    type: array
                    items:
                      properties:
                        type:
                          type: string
                          description: The type of the anomaly extension details.
                        attributes:
                          allOf:
                            - &ref_82
                              type: object
                              required:
                                - createdDateTime
                                - anomalyStatus
                                - anomalyType
                                - anomalySeverity
                                - extendedAttributes
                              properties:
                                createdDateTime:
                                  type: string
                                  format: date-time
                                  description: >-
                                    The ISO 8601 formatted time. The timestamp
                                    of the anomaly was created.
                                anomalyStatus:
                                  type: string
                                  description: The status of the anomaly.
                                  enum:
                                    - ANOMALY
                                    - NOT_REVIEWED
                                    - REPORTED_FALSE_POSITIVE
                                    - IGNORED
                                anomalyType:
                                  type: string
                                  description: The type of the anomaly.
                                anomalySeverity:
                                  type: string
                                  description: Specifies the severity of anomaly detected.
                                  enum:
                                    - HIGH
                                    - MEDIUM
                                    - LOW
                                description:
                                  type: string
                                  description: Specifies description of anomaly.
                                extendedAttributes:
                                  type: object
                                  description: >-
                                    The additional attributes for generated
                                    anomaly. It is of type KEY-VALUE pair.
                            - type: object
                  meta:
                    type: object
                    properties:
                      pagination:
                        type: object
                        properties:
                          prev:
                            type: integer
                          next:
                            type: integer
                          first:
                            type: integer
                          last:
                            type: integer
                          count:
                            type: integer
                          offset:
                            type: integer
                          limit:
                            type: integer
            text/vnd.netbackup+csv;version=12.0:
              schema:
                type: string
                format: binary
        '400': *ref_5
        '401': *ref_2
        '500': *ref_4
  '/security/anomaly-extension/{anomalyId}':
    get:
      description: >
        Retrieves the anomaly for extension detected based on the ID.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|MANAGE|ANOMALIES|`\

        Requires Operation: `|OPERATIONS|VIEW|`
      tags:
        - Anomaly Extension
      parameters:
        - name: anomalyId
          in: path
          required: true
          description: Get anomaly based on ID.
          schema:
            type: string
      responses:
        '200':
          description: Successfully retrieved the anomaly for extension based on ID.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: &ref_277
                type: object
                required:
                  - data
                properties:
                  data:
                    type: object
                    required:
                      - type
                      - attributes
                      - id
                    description: The data specific to an anomaly.
                    properties:
                      type:
                        type: string
                        enum:
                          - anomalyExtension
                      id:
                        type: string
                      attributes:
                        allOf:
                          - *ref_82
                          - type: object
        '400': *ref_5
        '401': *ref_2
        '404': *ref_14
        '500': *ref_4
    delete:
      description: >
        Deletes the anomaly record of extension for a given anomaly ID.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|MANAGE|ANOMALIES|`\

        Requires Operation: `|OPERATIONS|DELETE|`
      tags:
        - Anomaly Extension
      parameters:
        - name: anomalyId
          in: path
          required: true
          description: Delete anomaly based on ID.
          schema:
            type: string
      responses:
        '204':
          description: Successfully deleted anomaly record.
        '400': *ref_5
        '401': *ref_2
        '404': *ref_14
        '500': *ref_4
    patch:
      description: >
        Updates the anomaly status based on anomaly ID specified.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|MANAGE|ANOMALIES|`\

        Requires Operation: `|OPERATIONS|UPDATE|`
      tags:
        - Anomaly Extension
      parameters:
        - name: anomalyId
          in: path
          required: true
          description: Unique identifier for anomaly on which status will get updated.
          schema:
            type: string
      requestBody:
        content:
          application/vnd.netbackup+json;version=12.0:
            schema: &ref_276
              type: object
              required:
                - data
              properties:
                data:
                  type: object
                  required:
                    - type
                    - attributes
                    - id
                  description: The data specific to an anomaly.
                  properties:
                    type:
                      type: string
                      enum:
                        - anomalyExtension
                    id:
                      type: string
                    attributes: *ref_82
      responses:
        '204':
          description: Successfully updated anomaly record.
        '400': *ref_5
        '401': *ref_2
        '404': *ref_14
        '406': *ref_3
        '415': *ref_11
        '500': *ref_4
  /security/siem-tools:
    get:
      description: >
        Gets details of all SIEM tools that are configured in your environment.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|AUDIT-LOGS|`\

        Requires Operation: `|OPERATIONS|VIEW|`
      tags:
        - SIEM Tool Configuration
      responses:
        '200':
          description: >-
            Successfully retrieved details of all SIEM tools that are configured
            in your environment.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: &ref_288
                type: object
                description: >-
                  Gives details of all SIEM tools that are configured in your
                  environment.
                properties:
                  data:
                    type: array
                    items: &ref_84
                      type: object
                      properties:
                        type:
                          description: The SIEM tool configuration type
                          type: string
                          enum:
                            - siemToolConfig
                        id: &ref_83
                          type: string
                          enum:
                            - AZURE
                            - AWS
                            - GOOGLE
                        attributes:
                          type: object
                          properties:
                            credentialName:
                              type: string
                              description: Credential name mapped to the SIEM tool.
                            isEnabled:
                              type: boolean
                              description: Gives status of SIEM tool.
                            extendedAttributes:
                              type: string
                              description: Specifies additional details for a SIEM tool.
                            createdDateTime:
                              type: string
                              description: >-
                                A UTC timestamp of when the SIEM tool was
                                configued.
                            lastUpdatedDateTime:
                              type: string
                              description: >-
                                A UTC timestamp of when the SIEM tool was
                                updated.
        '401': *ref_2
        '415': *ref_11
        '500': *ref_4
  '/security/siem-tools/{cloudProvider}':
    get:
      description: >
        Gets details of the specified SIEM tool.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|AUDIT-LOGS|`\

        Requires Operation: `|OPERATIONS|VIEW|`
      tags:
        - SIEM Tool Configuration
      parameters:
        - name: cloudProvider
          description: Name of the cloud provider.
          in: path
          required: true
          schema: *ref_83
      responses:
        '200':
          description: Successfully retrieved details of the specified SIEM tool.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: &ref_287
                type: object
                description: Gives details of the specified SIEM tool.
                properties:
                  data: *ref_84
        '400': *ref_5
        '401': *ref_2
        '415': *ref_11
        '500': *ref_4
    patch:
      description: >
        Successfully updated attributes of the specified SIEM tool.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|AUDIT-LOGS|`\

        Requires Operation: `|OPERATIONS|UPDATE|`
      tags:
        - SIEM Tool Configuration
      requestBody:
        content:
          application/vnd.netbackup+json;version=12.0:
            schema: &ref_286
              type: object
              description: Updates the status of the SIEM tool.
              required:
                - data
              properties:
                data:
                  type: object
                  required:
                    - type
                    - id
                    - attributes
                  properties:
                    type:
                      description: The SIEM tool configuration type
                      type: string
                      enum:
                        - siemToolConfig
                    id: *ref_83
                    attributes:
                      type: object
                      properties:
                        isEnabled:
                          type: boolean
                          description: Gives status of SIEM tool.
                        credentialName:
                          type: string
                          description: Credential name mapped to the SIEM tool.
                        extendedAttributes:
                          type: string
                          description: Specifies additional details for the SIEM tool.
      responses:
        '204':
          description: Successfully updated attributes of the specified SIEM tool.
        '400': *ref_5
        '401': *ref_2
        '406': *ref_3
        '415': *ref_11
        '500': *ref_4
  /security/siem-audit-categories:
    put:
      description: >
        Adds/removes selected audit categories for all SIEM tools.


        **Access Control**\

        Enforcement Type: [ API-Level
        ](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|AUDIT-LOGS|`\

        Requires Operation: `|OPERATIONS|UPDATE|`
      tags:
        - SIEM Tool Configuration
      requestBody:
        content:
          application/vnd.netbackup+json;version=12.0:
            schema: &ref_85
              type: object
              properties:
                data:
                  type: object
                  required:
                    - type
                    - id
                    - attributes
                  properties:
                    type:
                      type: string
                      description: The type of object.
                      enum:
                        - auditCategory
                    id:
                      type: string
                      description: The ID of the audit category.
                    attributes:
                      type: object
                      description: The value of the audit category.
                      properties:
                        value:
                          type: array
                          enum:
                            - ALERT
                            - ANOMALY
                            - ANOMALY_NEW
                            - ASSET
                            - AUDITCFG
                            - AUDITDB
                            - AUDITSVC
                            - AZFAILURE
                            - PAUSED_CLIENTS
                            - BMR
                            - BPCONF
                            - CATALOG
                            - CERT
                            - CONFIG
                            - CONNECTION
                            - CREDENTIALS
                            - CREDENTIAL_SCHEMA
                            - DATAACCESS
                            - DISCOVERY
                            - EVENT_LOG
                            - HOLD
                            - HOST
                            - ASSETGROUP
                            - JOB
                            - LICENSING
                            - LOGIN
                            - MALWARE_IMPACTED
                            - MALWARE_SCAN_STATUS
                            - MALWARE_SCAN_TRIGGER
                            - POLICY
                            - POOL
                            - PROTECTION_PLAN_SVC
                            - RETENTION_LEVEL
                            - SEC_CONFIG
                            - SLP
                            - STORAGESRV
                            - STU
                            - TOKEN
                            - USER
                            - MALWARE_SCAN_CANCELLATION_TRIGGER
                            - MALWARE_SCAN_RESUMED
                            - MALWARE_SCAN_RESULT_DELETED
                            - MALWARE_SCAN_HOST_STATE_MODIFIED
                            - MALWARE_SCAN_HOST_ADDED_TO_SH_POOL
                            - MALWARE_SCAN_HOST_REMOVED_FR_SH_POOL
                          description: These are accepted audit categories.
                          items:
                            type: string
        description: The audit categories to be configured for SIEM tools.
        required: true
      responses:
        '204':
          description: Successfully configured the audit categories for all SIEM tools.
        '400':
          description: Bad request.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_0
        '401': *ref_2
        '500': *ref_4
    get:
      description: >
        Get all audit categories for all SIEM tools.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|AUDIT-LOGS|`\

        Requires Operation: `|OPERATIONS|VIEW|`
      tags:
        - SIEM Tool Configuration
      responses:
        '200':
          description: >-
            Successfully returned the list of audit categories that are
            configured for SIEM tools.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_85
        '401': *ref_2
        '415': *ref_11
        '500': *ref_4
  /security/anomaly/rules:
    get:
      description: >
        Retrieves the list of anomaly rules based on the specified filters.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|MANAGE|ANOMALIES|`\

        Requires Operation: `|OPERATIONS|VIEW|`
      tags:
        - Anomaly Rules
      parameters:
        - name: filter
          description: >
            Filter criteria syntax is based on OData standards. Filtering is
            supported on the following attributes:

            |Name|Supported Operators|Description|Schema|

            |---|---|---|---|

            |id|eq|The unique identifier for anomaly rule.|string|

            |type|eq ne|Specifies the type of an anomaly rule detected.|string|

            |triggerMethod|eq ne|Specifies the method used to trigger an anomaly
            rule. Possible values: SCHEDULED, MANUAL.|string|

            |severity|eq ne|Specifies the severity of an anomaly rule. Possible
            values: HIGH, MEDIUM, LOW.|string|
          in: query
          required: false
          schema:
            type: string
        - *ref_79
        - *ref_80
        - name: sort
          description: >
            Sorts in ascending order on the specified property. Prefix with '-'
            for descending order.

            Sorting is supported on the following attributes:

            |Name|

            |---|

            |createdDateTime|
          in: query
          required: false
          schema:
            type: string
      responses:
        '200':
          description: >-
            Successfully retrieved the list of anomaly rules on the specified
            filters.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: &ref_270
                type: object
                required:
                  - links
                  - data
                  - meta
                properties:
                  links: *ref_54
                  data:
                    type: array
                    items: &ref_271
                      type: object
                      required:
                        - type
                        - id
                      description: The data specific to an anomaly rule.
                      properties:
                        type:
                          type: string
                          enum:
                            - anomalyRules
                        id:
                          type: string
                        attributes: &ref_86
                          type: object
                          required:
                            - version
                            - type
                            - triggerMethod
                            - severity
                            - createdDateTime
                            - lastUpdatedDateTime
                            - displayName
                            - description
                            - enabled
                            - properties
                          properties:
                            version:
                              type: integer
                              description: The version of the specified anomaly rule.
                            type:
                              type: string
                              description: The type of the anomaly rule.
                            triggerMethod:
                              type: string
                              description: The trigger method of the anomaly rule.
                              enum:
                                - SCHEDULED
                                - MANUAL
                            createdDateTime:
                              type: string
                              format: date-time
                              description: >-
                                The ISO 8601 formatted time. The timestamp of
                                the anomaly rule was created.
                            lastUpdatedDateTime:
                              type: string
                              format: date-time
                              description: >-
                                The ISO 8601 formatted time. The timestamp of
                                the anomaly rule was updated.
                            severity:
                              type: string
                              description: Specifies the severity of anomaly rule.
                              enum:
                                - HIGH
                                - MEDIUM
                                - LOW
                            displayName:
                              type: string
                              description: Specifies display name of anomaly rule.
                            description:
                              type: string
                              description: Specifies description of anomaly rule.
                            enabled:
                              type: boolean
                              description: >-
                                Specifies anomaly rule is enabled or is not
                                enabled.
                            properties:
                              type: object
                              description: >-
                                The additional attributes for generated anomaly
                                rule. It is of type KEY-VALUE pair.
                  meta:
                    type: object
                    properties:
                      pagination: *ref_55
        '400': *ref_5
        '401': *ref_2
        '406': *ref_3
        '500': *ref_4
    post:
      description: >
        Creates the anomaly rule.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|MANAGE|ANOMALIES|`\

        Requires Operation: `|OPERATIONS|ADD|`
      tags:
        - Anomaly Rules
      requestBody:
        content:
          multipart/vnd.netbackup+form-data;version=12.0:
            schema:
              type: object
              required:
                - anomalyRuleFile
              properties:
                anomalyRuleFile:
                  description: >
                    It accepts zip file which internally has multiple JSON
                    files.

                    Each JSON file contains input data of the anomaly rule and
                    other details.


                    Example:

                    ```

                    {
                        "id": "ac7222a2-f884-11ed-b67e-0242ac120002",
                        "version": 1,
                        "type": "NETBACKUP_AUDIT_DATA",
                        "triggerMethod": "SCHEDULED",
                        "createdDateTime": "2023-05-22T09:34:35.903Z",
                        "lastUpdatedDateTime": "2023-05-22T09:34:35.903Z",
                        "severity": "MEDIUM",
                        "displayName": "Test 5",
                        "description": "Test Description 5",
                        "enabled": false,
                        "properties": {
                            "query": {},
                            "executionFrequency": "1H",
                            "queryPeriod": "10W",
                            "operator": "LESS_THAN",
                            "threshold": 5,
                            "actions": [],
                            "tactics": [],
                            "techniques": [],
                            "extendedProperties": ""
                        }
                    }

                    ```
                  type: string
                  format: binary
        description: The anomaly rule to be created.
        required: true
      responses:
        '201':
          description: Succesfully created an anomaly rule.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: &ref_273
                type: object
                required:
                  - data
                properties:
                  data:
                    type: object
                    required:
                      - type
                      - attributes
                      - id
                    description: The data specific to an anomaly rule.
                    properties:
                      type:
                        type: string
                        enum:
                          - anomalyRules
                      id:
                        type: string
                      attributes:
                        allOf:
                          - *ref_86
                          - type: object
        '400': *ref_5
        '401': *ref_2
        '406': *ref_3
        '415': *ref_11
        '500': *ref_4
  '/security/anomaly/rules/{id}':
    patch:
      description: >
        Updates the anomaly rule based on anomaly rule id specified.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|MANAGE|ANOMALIES|`\

        Requires Operation: `|OPERATIONS|UPDATE|`
      tags:
        - Anomaly Rules
      parameters:
        - name: id
          in: path
          required: true
          description: >-
            Unique identifier for anomaly rule on which anomaly rule will get
            updated.
          schema:
            type: string
      requestBody:
        content:
          application/vnd.netbackup+json;version=12.0:
            schema: &ref_272
              type: object
              required:
                - data
              properties:
                data:
                  type: object
                  required:
                    - type
                    - attributes
                  properties:
                    type:
                      type: string
                      enum:
                        - patchAnomalyRules
                    attributes: &ref_269
                      type: object
                      required:
                        - enabled
                        - properties
                      properties:
                        enabled:
                          type: boolean
                          description: Specifies anomaly rule is enabled or is not enabled.
                        properties:
                          type: object
                          description: >-
                            The additional attributes for generated anomaly
                            rule. It is of type KEY-VALUE pair.
      responses:
        '202':
          description: >-
            The request was successfully received by the server and is awaiting
            MPA approval.
          headers:
            X-NetBackup-MPA-Ticket:
              description: The link to a newly-generated MPA ticket.
              schema:
                type: string
        '204':
          description: Successfully updated the anomaly rule.
        '400': *ref_5
        '401': *ref_2
        '404': *ref_14
        '406': *ref_3
        '415': *ref_11
        '500': *ref_4
    delete:
      description: >
        Delete the anomaly rule for a given id.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|MANAGE|ANOMALIES|`\

        Requires Operation: `|OPERATIONS|DELETE|`
      tags:
        - Anomaly Rules
      parameters:
        - name: id
          in: path
          required: true
          description: Delete anomaly rule based on id.
          schema:
            type: string
      responses:
        '202':
          description: >-
            The request was successfully received by the server and is awaiting
            MPA approval.
          headers:
            X-NetBackup-MPA-Ticket:
              description: The link to a newly-generated MPA ticket.
              schema:
                type: string
        '204':
          description: Successfully deleted anomaly rule.
        '400': *ref_5
        '401': *ref_2
        '404': *ref_14
        '406': *ref_3
        '500': *ref_4
  /security/mfa-status:
    get:
      description: >
        Returns the multifactor authentication (MFA) enablement status of the
        user and global MFA enforcement status.


        **Access Control**\

        Enforcement Type: `None`
      tags:
        - MFA
      security: []
      parameters:
        - name: X-NetBackup-MFA-State-Token
          in: header
          description: >
            The MFA state token that the user has provided. If MFA is enabled,
            the user can obtain this token using the /login API.
          required: false
          schema:
            type: string
      responses:
        '200':
          description: Successfully retrieved MFA status for the user.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: &ref_291
                type: object
                properties:
                  data:
                    type: array
                    items:
                      type: object
                      required:
                        - type
                        - id
                        - attributes
                      properties:
                        id:
                          type: string
                        type:
                          type: string
                          enum:
                            - mfaStatusResponse
                        attributes:
                          type: object
                          properties:
                            isMfaEnforced:
                              type: boolean
                              description: Returns MFA status from global configuration.
                            isMfaRegistered:
                              type: boolean
                              description: Returns MFA status from user configuration.
                            deploymentType:
                              type: string
                              description: >
                                This field specifies the NetBackup deployment
                                type.

                                Here are the defined values for the deployment
                                type:

                                * 'BYO' - Indicates NetBackup deployment type is
                                BYO

                                * 'NBA' - Indicates NetBackup deployment type is
                                NBA

                                * 'FLEX' - Indicates NetBackup deployment type
                                is FLEX

                                * 'NSO' - Indicates NetBackup deployment type is
                                NSO

                                * 'CLOUDSCALE' - Indicates NetBackup deployment
                                type is CLOUDSCALE
                              enum:
                                - BYO
                                - NBA
                                - FLEX
                                - NSO
                                - CLOUDSCALE
                            otpLength:
                              type: integer
                              description: Returns OTP length from global configuration.
                          required:
                            - isMfaEnforced
                            - isMfaRegistered
                            - deploymentType
                            - otpLength
                required:
                  - data
        '400':
          description: >
            Either MFA state token is invalid or expired. No user exists or is
            associated with the specified token.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_0
        '401': *ref_2
        '500': *ref_4
  /security/mfa/totp/configurations:
    get:
      description: >
        Returns the secret of the user and secret encoded URI for QR code
        generation. The URI has the following information.

        otpauth://TYPE/LABEL?PARAMETERS


        **Access Control**\

        Enforcement Type: `None`
      tags:
        - MFA
      security: []
      parameters:
        - name: X-NetBackup-MFA-State-Token
          in: header
          description: >
            The MFA state token that the user has provided. If MFA is enabled,
            the user can obtain this token using the /login API.
          required: false
          schema:
            type: string
      responses:
        '200':
          description: Successfully retrieved the user configuration.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: &ref_293
                type: object
                properties:
                  data:
                    type: array
                    items:
                      type: object
                      required:
                        - type
                        - id
                        - attributes
                      properties:
                        id:
                          type: string
                        type:
                          type: string
                          enum:
                            - mfaTOTPResponse
                        attributes:
                          type: object
                          properties:
                            secret:
                              type: string
                              format: byte
                              description: >-
                                The Base-32 encoded secret associated with the
                                user.
                              example: KBPWY3DEEHPK3PXP
                            user:
                              type: string
                              description: The user with whom the key is associated.
                              example: user@domain.com
                            issuer:
                              type: string
                              description: >
                                The issuer parameter indicates the provider or
                                the service with the associated user.
                              example: NetBackup
                            qrCodeURI:
                              type: string
                              format: uri
                              description: The secret encoded URI for QR code generation.
                              example: >-
                                otpauth://totp/NetBackup@server.com:domain\user?secret=K52RYFVM5P32WXRF67YP25P6UQ&issuer=NetBackup@server.com
                required:
                  - data
        '400':
          description: >
            Either MFA state token is invalid or expired. No user exists or is
            associated with the specified token.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_0
        '401': *ref_2
        '500': *ref_4
    post:
      description: |
        Enables the MFA for the user and associates the secret with the user.

        **Access Control**\
        Enforcement Type: `None`
      tags:
        - MFA
      security: []
      parameters:
        - name: X-NetBackup-MFA-State-Token
          in: header
          description: >
            The MFA state token that the user has provided. If MFA is enabled,
            the user can obtain this token using the /login API.
          required: false
          schema:
            type: string
      requestBody:
        content:
          application/vnd.netbackup+json;version=12.0:
            schema: &ref_292
              type: object
              properties:
                data:
                  type: object
                  required:
                    - type
                    - attributes
                  properties:
                    type:
                      type: string
                      enum:
                        - mfaTOTPRequest
                    attributes:
                      type: object
                      properties:
                        secret:
                          type: string
                          format: byte
                          description: The Base-32 encoded secret assigned to the user.
                        totpCode:
                          type: string
                          description: The one time password (OTP) displayed by the device.
                      required:
                        - secret
                        - otpCode
              required:
                - data
        required: true
      responses:
        '204':
          description: Successfully enabled MFA for the user.
        '400':
          description: >
            Either MFA state token is invalid or expired. No user exists or is
            associated with the specified token.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_0
        '401': *ref_2
        '500': *ref_4
    delete:
      description: >
        NetBackup users can disable the MFA configuration for themselves, if the
        NetBackup Administrator has not enforced MFA for them.

        The NetBackup Administrator or the Security Administrator can disable
        the MFA configuration for a particular user.


        **Access Control**\

        Enforcement Type: `None`
      tags:
        - MFA
      security: []
      requestBody:
        content:
          application/vnd.netbackup+json;version=12.0:
            schema: &ref_290
              type: object
              properties:
                data:
                  type: object
                  required:
                    - type
                    - attributes
                  properties:
                    type:
                      type: string
                      enum:
                        - mfaTOTPDeleteRequest
                    attributes:
                      type: object
                      properties:
                        userIdentifier:
                          type: string
                          description: >
                            Identifies a user. The user identifier must be in
                            the following format:
                            domainName:userName:domainType:userId
                        totpCode:
                          type: string
                          description: The OTP code generated for the user.
                      required:
                        - userName
              required:
                - data
        required: true
      responses:
        '204':
          description: Successfully disabled MFA for the user.
        '401': *ref_2
        '404':
          description: The specified user does not exist.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_0
        '500': *ref_4
  /security/mfa/users:
    get:
      description: |
        Returns a list of multifactor authentication (MFA) enrolled users.

        **Access Control**\
        Enforcement Type: [API-Level]\
        Namespace: `|SECURITY|MFA|`\
        Requires Operation: `|OPERATIONS|VIEW|`
      tags:
        - MFA
      parameters:
        - *ref_79
        - *ref_80
        - name: filter
          description: >
            Filter criteria syntax is based on OData standards. Filtering is
            supported on the following attributes:

            |Name|Supported Operators|Description|Schema|

            |---|---|---|---|

            |username|contains startswith eq |The user name to filter
            on.|string|
          in: query
          required: false
          schema:
            type: string
      security: []
      responses:
        '200':
          description: Successfully retrieved MFA enrolled users.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: &ref_295
                type: object
                properties:
                  data:
                    type: array
                    items:
                      type: object
                      required:
                        - type
                        - id
                        - attributes
                      properties:
                        id:
                          type: string
                        type:
                          type: string
                          enum:
                            - mfaUsersResponse
                        attributes:
                          type: object
                          properties:
                            userName:
                              type: string
                              description: Returns MFA user name.
                            domainName:
                              type: string
                              description: Returns MFA domain name.
                            domainType:
                              type: string
                              description: Returns MFA domain type.
                            userId:
                              type: string
                              description: Returns MFA user id.
                required:
                  - data
        '400': *ref_5
        '401': *ref_2
        '406': *ref_3
        '500': *ref_4
  '/security/adaptive-mfa/{requestId}/validate':
    post:
      description: >
        Validates the one-time password (OTP) for multifactor authentication.
        Upon successful validation of OTP, this API

        will invoke original API request. The original API request will be
        identified by an unique requestId that needs to be passed as a parameter
        requestId.

        Refer original API documentation to understand the response schema and
        reponse headers.


        **Access Control**\

        Enforcement Type: `None`
      tags:
        - MFA
      security:
        - jwtAuth: []
      parameters:
        - name: requestId
          in: path
          description: |
            The unique requestId of the reqest.
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/vnd.netbackup+json;version=12.0:
            schema: &ref_294
              type: object
              properties:
                data:
                  type: object
                  required:
                    - type
                    - attributes
                  properties:
                    type:
                      type: string
                      enum:
                        - mfaOTPValidateRequest
                    attributes:
                      type: object
                      properties:
                        otpCode:
                          type: string
              required:
                - data
        required: true
      responses:
        '400':
          description: >
            Either invalid request ID or the multifactor authentication isn't
            configured for the user.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_0
        '401': *ref_2
        '403':
          description: The user OTP validation failed.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_0
        '500': *ref_4
  /security/mpa-configurations:
    get:
      description: >
        Retrieves all multi-person authorization (MPA) configurations.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|MPA|CONFIG|`\

        Requires Operation: `|OPERATIONS|VIEW|`
      tags:
        - Multi-person authorization (MPA)
      responses:
        '200':
          description: Successfully retrieved all MPA configurations.
          headers:
            X-Cache-Validity:
              description: >-
                The API response is cached for this much time. The cache
                validity is defined in minutes.
              schema:
                type: integer
          content:
            application/vnd.netbackup+json;version=12.0:
              schema:
                description: >-
                  The response on a successful listing of all multi-person
                  authorization (MPA) configurations.
                type: object
                required:
                  - data
                properties:
                  data:
                    type: array
                    items:
                      type: object
                      required:
                        - type
                        - id
                        - attributes
                      properties:
                        type:
                          description: The type of the response payload.
                          type: string
                          enum:
                            - mpaConfiguration
                        id:
                          description: The ID of the response payload.
                          type: string
                        attributes:
                          description: The attributes of the response.
                          type: object
                          required:
                            - configuration
                            - operations
                            - exemptedUsers
                          properties:
                            configuration:
                              description: Global configuration of MPA.
                              type: object
                              required:
                                - expirationPeriodInHours
                                - purgePeriodInDays
                              properties:
                                expirationPeriodInHours:
                                  type: integer
                                  minimum: 24
                                  maximum: 168
                                  description: The expiration period for tickets in hours.
                                purgePeriodInDays:
                                  type: integer
                                  minimum: 3
                                  maximum: 30
                                  description: The purge period for tickets in days.
                            operations:
                              description: The MPA-supported operations.
                              type: array
                              items:
                                type: object
                                required:
                                  - operationId
                                  - state
                                properties:
                                  operationId:
                                    type: string
                                    description: The MPA operation ID.
                                    enum:
                                      - IMAGE_EXPIRE
                                      - POLICY_UPDATE
                                      - SECURITY_PROPERTIES
                                      - REMOVE_IMAGE_HOLD
                                      - WORM_RETENTION_LOCK_REMOVAL
                                      - WORM_CONFIGURATION_CHANGE
                                      - KEY_MANAGEMENT
                                      - API_KEYS
                                  state:
                                    type: string
                                    enum:
                                      - ENABLED
                                      - DISABLED
                                    description: The state of MPA operation.
                                  preApproval:
                                    type: boolean
                                    description: >-
                                      Whether this operation needs to be
                                      pre-approved.
                                  name:
                                    type: string
                                    description: The MPA operation name.
                                  category:
                                    type: string
                                    description: The MPA operation category.
                                  creationDateTime:
                                    type: string
                                    format: date-time
                                    description: >-
                                      The creation date-time of the
                                      configuration in ISO 8601 format (UTC).
                                  lastUpdatedDateTime:
                                    type: string
                                    format: date-time
                                    description: >-
                                      The last modified date-time of the
                                      configuration in ISO 8601 format (UTC).
                            exemptedUsers:
                              description: >-
                                The users that are exempted from the MPA
                                workflow.
                              type: array
                              items: &ref_87
                                type: object
                                required:
                                  - userName
                                  - userDomainName
                                  - userDomainType
                                properties:
                                  userName:
                                    type: string
                                    description: >-
                                      The name of the user who is exempted from
                                      the MPA workflow.
                                  userDomainName:
                                    type: string
                                    description: >-
                                      The domain name of the user who is
                                      exempted from the MPA workflow.
                                  userDomainType:
                                    type: string
                                    enum:
                                      - NT
                                      - VX
                                      - UNIXPWD
                                      - LDAP
                                      - NIS
                                      - NIS_PLUS
                                      - SAML
                                      - SMARTCARD
                                    description: >-
                                      The domain type of the user who is
                                      exempted from the MPA workflow.
        '401': *ref_2
        '500': *ref_4
  '/security/mpa-configurations/{id}':
    put:
      description: >
        Updates MPA configuration.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|MPA|CONFIG|`\

        Requires Operation: `|OPERATIONS|UPDATE|`


        Only state of the requested operations will be updated and remaining
        will be disabled.\

        All exempted users will be replaced with the requested exempted users.
      tags:
        - Multi-person authorization (MPA)
      parameters:
        - name: id
          description: The MPA configuration ID.
          in: path
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/vnd.netbackup+json;version=12.0:
            schema:
              description: The multi-person authorization (MPA) configuration request.
              type: object
              required:
                - data
              properties:
                data:
                  description: The request payload of MPA configuration.
                  type: object
                  required:
                    - type
                    - id
                    - attributes
                  properties:
                    type:
                      description: The type of the request payload.
                      type: string
                      enum:
                        - mpaConfigurationUpdateRequest
                    id:
                      description: The ID of the request payload.
                      type: string
                    attributes:
                      description: The attributes of the MPA configuration update request.
                      type: object
                      required:
                        - configuration
                        - operations
                        - exemptedUsers
                      properties:
                        configuration:
                          description: Global configuration of MPA.
                          type: object
                          required:
                            - expirationPeriodInHours
                            - purgePeriodInDays
                          properties:
                            expirationPeriodInHours:
                              type: integer
                              minimum: 24
                              maximum: 168
                              description: The expiration period for tickets in hours.
                            purgePeriodInDays:
                              type: integer
                              minimum: 3
                              maximum: 30
                              description: The purge period for tickets in days.
                        operations:
                          description: The MPA-supported operations.
                          type: array
                          items:
                            type: object
                            required:
                              - operationId
                              - state
                            properties:
                              operationId:
                                type: string
                                description: The MPA operation ID.
                                enum:
                                  - IMAGE_EXPIRE
                                  - POLICY_UPDATE
                                  - SECURITY_PROPERTIES
                                  - REMOVE_IMAGE_HOLD
                                  - WORM_RETENTION_LOCK_REMOVAL
                                  - WORM_CONFIGURATION_CHANGE
                                  - KEY_MANAGEMENT
                                  - API_KEYS
                              state:
                                type: string
                                enum:
                                  - ENABLED
                                  - DISABLED
                                description: The state of MPA operation.
                        exemptedUsers:
                          description: The users that are exempted from the MPA workflow.
                          type: array
                          items: *ref_87
        required: true
        description: The MPA configuration.
      responses:
        '202':
          description: >-
            The MPA configuration request was successfully received by the
            server and is awaiting MPA approval.
          headers:
            X-NetBackup-MPA-Ticket:
              description: The link to a newly-generated MPA ticket.
              schema:
                type: string
        '204':
          description: Successfully updated the MPA configuration.
        '400': *ref_5
        '401': *ref_2
        '404': *ref_14
        '415': *ref_11
        '500': *ref_4
  /security/mpa-tickets:
    get:
      description: >
        Retrieves the available MPA tickets as per the filters.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|MPA|TICKETS|`\

        Requires Operation: `|OPERATIONS|VIEW|`


        Requester can view only MPA tickets of those operations that are
        associated with them.\

        Approvers can view all the MPA ticket.
      tags:
        - Multi-person authorization (MPA)
      parameters:
        - name: include
          description: Optional relationships to include.
          in: query
          required: false
          schema:
            type: string
            enum:
              - ticketHistory
        - name: filter
          description: >
            Filter criteria syntax is based on OData standards. Filtering is
            supported on the following attributes:

            |Name|Supported Operators|Description|Schema|

            |---|---|---|---|

            |requesterName|eq|The user name of the requestor who invoked the MPA
            enabled API.|string|

            |requesterDomainName|eq|The domain name of the requestor who invoked
            the MPA enabled API.|string|

            |requesterDomainType|eq|The domain type of the requestor who invoked
            the MPA enabled API. Possible values: NT, VX, UNIXPWD, LDAP, NIS,
            NIS_PLUS, SAML, SMARTCARD|string|

            |currentState|eq|The current state of ticket. Possible values:
            PENDING, PARTIALLY_APPROVED, APPROVED, REJECTED, EXPIRED, CANCELED,
            SCHEDULED, DONE|string|

            |operationId|eq|The MPA operationId.|string|

            |expirationDateTime|ge le|The expiry date-time of the MPA ticket, in
            ISO 8601 format (UTC).|date-time|

            |creationDateTime|ge le|The creation date-time of the MPA ticket, in
            ISO 8601 format (UTC).|date-time|
          in: query
          required: false
          schema:
            type: string
        - name: 'page[limit]'
          description: The number of MPA ticket records that are displayed on one page.
          in: query
          required: false
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 10
        - name: 'page[offset]'
          description: The MPA ticket record number offset.
          in: query
          required: false
          schema:
            type: integer
            minimum: 0
            default: 0
        - name: sort
          description: >
            Sorts the records in an ascending order. Use '-' as a prefix to sort
            the records in an descending order.
          in: query
          required: false
          schema:
            type: string
      responses:
        '200':
          description: Retrieves the available MPA tickets as per the filters.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema:
                description: >-
                  The response on a successful listing of details for all the
                  MPA tickets.
                type: object
                required:
                  - data
                  - meta
                  - links
                properties:
                  links:
                    type: object
                    properties:
                      self:
                        type: object
                        properties:
                          href:
                            type: string
                      next:
                        type: object
                        properties:
                          href:
                            type: string
                      prev:
                        type: object
                        properties:
                          href:
                            type: string
                      first:
                        type: object
                        properties:
                          href:
                            type: string
                      last:
                        type: object
                        properties:
                          href:
                            type: string
                  data:
                    type: array
                    items: &ref_88
                      type: object
                      properties:
                        links:
                          type: object
                          properties:
                            self:
                              type: object
                              properties:
                                href:
                                  type: string
                        type:
                          description: The type of the response payload.
                          type: string
                          enum:
                            - mpaTicketDetails
                        id:
                          type: string
                          description: The MPA ticket ID.
                        attributes:
                          description: The attributes of the response payload.
                          type: object
                          required:
                            - operationId
                            - operationName
                            - requestMetaData
                            - requesterName
                            - requesterDomainName
                            - requesterDomainType
                            - isMyTicket
                            - responseStatusCode
                            - currentState
                            - expirationDateTime
                            - conflictedBy
                            - createdDateTime
                            - lastUpdatedDateTime
                          properties:
                            operationId:
                              type: string
                              description: >-
                                The MPA-enabled operation for which a ticket
                                needs to be created.
                              enum:
                                - MPA_CONFIGURATION
                                - POLICY_UPDATE
                                - IMAGE_EXPIRE
                                - SECURITY_PROPERTIES
                                - REMOVE_IMAGE_HOLD
                                - WORM_RETENTION_LOCK_REMOVAL
                                - WORM_CONFIGURATION_CHANGE
                                - RISK_ENGINE_CONFIGURATION
                                - KEY_MANAGEMENT
                                - API_KEYS
                            operationName:
                              type: string
                              description: The MPA operation name.
                            requestMetaData:
                              type: string
                              description: >-
                                The meta-data information of the MPA-enabled API
                                request.
                            liveDiff:
                              type: string
                              description: >-
                                The json difference between state of object when
                                MPA ticket was created and current state of the
                                object.
                            requesterName:
                              type: string
                              description: >-
                                The user name of the requestor who invoked the
                                MPA-enabled API.
                            requesterDomainName:
                              type: string
                              description: >-
                                The domain name of the requestor who invoked the
                                MPA-enabled API.
                            requesterDomainType:
                              type: string
                              enum:
                                - NT
                                - VX
                                - UNIXPWD
                                - LDAP
                                - NIS
                                - NIS_PLUS
                                - SAML
                                - SMARTCARD
                              description: >-
                                The domain type of the requestor who invoked the
                                MPA-enabled API.
                            response:
                              type: string
                              description: >-
                                The response of the invoked API in a JSON
                                format.
                            responseStatusCode:
                              type: integer
                              description: The status code of the invoked API.
                            currentState:
                              type: string
                              description: The current state of ticket.
                              enum:
                                - PENDING
                                - APPROVED
                                - REJECTED
                                - EXPIRED
                                - CANCELED
                                - SCHEDULED
                                - DONE
                            apiDocLink:
                              type: string
                              description: The link to API documentation for the operation.
                            conflictedBy:
                              type: integer
                              format: int64
                              description: >-
                                The Ticket ID of the ticket that has modified
                                the same object.
                            riskAnalysis:
                              type: string
                              description: >-
                                Analysis by the risk engine if ticket is
                                generated by risk engine.
                            isMyTicket:
                              type: boolean
                              description: |
                                Determines if it is my ticket.
                                True - If ticket belongs to me.
                                False - If ticket does not belong to me.
                            cautionMessage:
                              type: string
                              description: >-
                                The message that helps the approvers to take a
                                well-informed action on the pending multi-person
                                authorization ticket. This is an optional
                                attribute that is shown when the approver asks
                                for it for a specific multi-person authorization
                                ticket ID. If the approver and the requester are
                                the same, this attribute is not shown.
                            autoApprovalDateTime:
                              type: string
                              format: date-time
                              description: >-
                                The date and time in ISO 8601 format (UTC), when
                                the MPA ticket is automatically approved.
                            expirationDateTime:
                              type: string
                              format: date-time
                              description: >-
                                The expiry date and time of the MPA ticket, in
                                ISO 8601 format (UTC).
                            createdDateTime:
                              type: string
                              format: date-time
                              description: >-
                                The creation date-time of the MPA ticket, in ISO
                                8601 format (UTC).
                            lastUpdatedDateTime:
                              type: string
                              format: date-time
                              description: >-
                                The last modified date-time of the MPA ticket,
                                in ISO 8601 format (UTC).
                        relationships:
                          type: object
                          properties:
                            mpaTicketHistory:
                              type: object
                              properties:
                                links:
                                  type: object
                                  properties:
                                    related:
                                      type: object
                                      properties:
                                        href:
                                          type: string
                                      required:
                                        - href
                                  required:
                                    - related
                                data:
                                  type: array
                                  properties:
                                    type:
                                      type: string
                                    id:
                                      type: string
                                  required:
                                    - type
                                    - id
                              required:
                                - data
                  meta:
                    type: object
                    properties:
                      pagination:
                        type: object
                        properties:
                          count:
                            type: integer
                          first:
                            type: integer
                          last:
                            type: integer
                          next:
                            type: integer
                          prev:
                            type: integer
                          page:
                            type: integer
                          pages:
                            type: integer
                          offset:
                            type: integer
                          limit:
                            type: integer
        '400': *ref_5
        '401': *ref_2
        '500': *ref_4
  '/security/mpa-tickets/{ticketId}':
    get:
      description: >
        Retrieves MPA ticket details for the specified ticket ID.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|MPA|TICKETS|`\

        Requires Operation: `|OPERATIONS|VIEW|`


        Requester can view the MPA tickets of those operations that are
        associated with them.\

        Approvers can view other's MPA ticket as well.
      tags:
        - Multi-person authorization (MPA)
      parameters:
        - name: ticketId
          description: The ID of the MPA ticket.
          in: path
          required: true
          schema:
            type: integer
            format: int64
        - name: include
          description: Optional relationships to include.
          in: query
          required: false
          schema:
            type: string
            enum:
              - ticketHistory
      responses:
        '200':
          description: Successfully retrieved the details of the specified MPA ticket ID.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema:
                description: >-
                  The response on a successful listing of details of a specific
                  MPA ticket.
                type: object
                properties:
                  data: *ref_88
        '400': *ref_5
        '401': *ref_2
        '404':
          description: >-
            The ticket does not exist or is not generated for the given user
            operation.
          content: *ref_89
        '500': *ref_4
    patch:
      description: >
        Updates the ticket for changing state and updating comment for the
        specified ticket ID.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|MPA|TICKETS|`\

        Requires Operation: `|OPERATIONS|UPDATE|`


        Following are the actions and authorized users who can perform those
        action.\

        Comment - Both requester and approvers can post comment in the MPA
        ticket.\

        Approve - Only approvers can approve the MPA ticket. The requester
        cannot approve own ticket.\

        Reject  - Only approvers can reject the MPA ticket. The requester cannot
        reject own ticket.\

        Cancel  - Only requester can cancel own ticket.\

        Done    - Only requester can done own ticket.\

        Renew   - Only requester can renew own expired ticket.\

        Response - Only requester can post response in the MPA ticket.
      tags:
        - Multi-person authorization (MPA)
      requestBody:
        content:
          application/vnd.netbackup+json;version=12.0:
            schema:
              description: The request data to update the MPA ticket.
              type: object
              required:
                - data
              properties:
                data:
                  description: The request payload for updating the ticket.
                  type: object
                  required:
                    - id
                    - type
                    - attributes
                  properties:
                    id:
                      type: integer
                      format: int64
                      description: The MPA ticket record ID.
                    type:
                      type: string
                      description: The type of the MPA ticket update request.
                      enum:
                        - mpaTicketUpdateRequest
                    attributes:
                      type: object
                      allOf:
                        - type: object
                          anyOf:
                            - type: object
                              required:
                                - ticketComment
                              properties:
                                ticketComment:
                                  type: string
                                  description: >-
                                    The additional information or comments about
                                    the MPA ticket
                            - type: object
                              required:
                                - state
                              properties:
                                state:
                                  type: string
                                  description: >
                                    The state of the ticket to be changed. \

                                    Following ticket state transition can only
                                    be done:\

                                    - PENDING -> APPROVED (ticket approval)\

                                    - PENDING -> REJECTED (ticket rejection)\

                                    - PENDING / APPROVED -> CANCELED (ticket
                                    cancellation only by requester)\

                                    - APPROVED -> DONE (ticket done)\

                                    - EXPIRED -> PENDING (ticket renewal)
                                  enum:
                                    - APPROVED
                                    - REJECTED
                                    - CANCELED
                                    - PENDING
                                    - DONE
                            - type: object
                              required:
                                - responseContents
                                - responseCode
                              properties:
                                responseContents:
                                  type: string
                                  description: Response contents.
                                responseCode:
                                  type: integer
                                  description: Http status code.
        description: The data required to update the MPA ticket.
        required: true
      parameters:
        - name: ticketId
          description: The ID of the MPA ticket.
          in: path
          required: true
          schema:
            type: integer
            format: int64
      responses:
        '200':
          description: Succesfully updated the ID of the MPA ticket.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema:
                description: The response on a successful update of the MPA ticket.
                type: object
                properties:
                  data: *ref_88
        '400': *ref_5
        '401': *ref_2
        '404':
          description: >-
            The ticket does not exist or is not generated for the given user
            operation.
          content: *ref_89
        '415': *ref_11
        '500': *ref_4
  /security/mpa-tickets/execute:
    post:
      description: >
        Executes the APIs corresponding to MPA tickets.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|MPA|TICKETS|`\

        Requires Operation: `|OPERATIONS|UPDATE|`
      tags:
        - Multi-person authorization (MPA)
      requestBody:
        description: The MPA ticket IDs.
        required: true
        content:
          application/vnd.netbackup+json;version=12.0:
            schema: &ref_312
              type: object
              required:
                - data
              properties:
                data:
                  type: object
                  required:
                    - type
                    - attributes
                  properties:
                    type:
                      type: string
                      enum:
                        - executeTicketsRequest
                    attributes:
                      type: object
                      properties:
                        ticketIds:
                          type: array
                          description: >-
                            The list of IDs of the MPA tickets to be executed.
                            You can execute only those tickets that you have
                            generated.
                          items:
                            type: integer
      responses:
        '201':
          description: Successfully invoked the APIs corresponding to MPA tickets.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: &ref_313
                type: object
                properties:
                  data:
                    type: object
                    properties:
                      id:
                        type: string
                      type:
                        type: string
                        enum:
                          - executeTicketsResponse
                      attributes:
                        type: object
                        properties:
                          responses:
                            type: array
                            items:
                              type: object
                              properties:
                                ticketId:
                                  type: integer
                                  description: The MPA ticket ID.
                                response:
                                  type: string
                                  description: >-
                                    The response of the invoked API in a JSON
                                    format.
                                responseHeaders:
                                  type: string
                                  description: >-
                                    The response headers of the invoked APIs in
                                    a JSON format.
        '400': *ref_5
        '401': *ref_2
        '500': *ref_4
  /security/anomaly-extension-types:
    get:
      description: >
        Retrieves the list of types for anomalies.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|MANAGE|ANOMALIES|`\

        Requires Operation: `|OPERATIONS|VIEW|`
      tags:
        - Anomaly Extension
      responses:
        '200':
          description: Successfully retrieved the list of types for anomalies.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: &ref_296
                type: object
                properties:
                  data:
                    type: object
                    required:
                      - type
                      - attributes
                      - id
                    description: The data specific to an anomaly.
                    properties:
                      type:
                        type: string
                        enum:
                          - anomalyExtensionType
                      id:
                        type: string
                      attributes:
                        type: object
                        properties:
                          extensionType:
                            type: array
                            items:
                              type: string
        '401': *ref_2
        '500': *ref_4
  /security/status:
    get:
      description: >
        Retrieves the overall security configuration risk score along with the
        base and current security configurations.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|SETTINGS|`\

        Requires Operation: `|OPERATIONS|VIEW|`
      tags:
        - Dashboard
      responses:
        '200':
          description: >-
            Successfully retrieved the security risk score and security
            configurations.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema:
                description: >-
                  The response containing the platform risk score and security
                  configurations.
                type: object
                required:
                  - data
                properties:
                  data:
                    description: >-
                      The response containing the platform risk score and
                      security configurations.
                    type: object
                    required:
                      - id
                      - type
                      - attributes
                    properties:
                      id:
                        type: string
                        description: The ID of the response
                        enum:
                          - statusResponse
                      type:
                        type: string
                        description: The type of the response
                        enum:
                          - statusResponse
                      attributes:
                        description: >
                          The attributes of the response containing the platform
                          risk score and security configurations.
                        type: object
                        properties:
                          templateVersion:
                            type: integer
                            format: int64
                            description: >-
                              The template version to identify the format of the
                              response.
                          platformRiskScore:
                            type: number
                            description: >-
                              The platform risk score based on the current
                              security configurations.
                            minimum: 0
                            maximum: 100
                          securitySettingsDetail:
                            type: object
                            description: >-
                              Details of security configurations used to
                              calculate the overall risk score.
                            properties:
                              ssoEnabled:
                                type: object
                                properties:
                                  currentConfigState: *ref_63
                                  baseConfigState: *ref_63
                                  configWeightage: &ref_90
                                    type: integer
                                    format: int64
                                    description: >-
                                      Weightage of security configuration in the
                                      calculation of overall security score.
                                    minimum: 0
                                    maximum: 100
                                  currentConfigRiskScore: &ref_91
                                    type: number
                                    description: >-
                                      Security risk score based on the current
                                      security configurations.
                                    minimum: 0
                                    maximum: 100
                                  baseConfigRiskScore: &ref_92
                                    type: number
                                    description: >-
                                      Security risk score based on the baseline
                                      security configurations.
                                    minimum: 0
                                    maximum: 100
                              allowInsecureBackLevelHost:
                                type: object
                                properties:
                                  currentConfigState: *ref_16
                                  baseConfigState: *ref_16
                                  configWeightage: *ref_90
                                  currentConfigRiskScore: *ref_91
                                  baseConfigRiskScore: *ref_92
                              certificateAutoDeployLevel:
                                type: object
                                properties:
                                  currentConfigState: *ref_18
                                  baseConfigState: *ref_18
                                  configWeightage: *ref_90
                                  currentConfigRiskScore: *ref_91
                                  baseConfigRiskScore: *ref_92
                              mfaEnforced:
                                type: object
                                properties:
                                  currentConfigState: *ref_41
                                  baseConfigState: *ref_41
                                  configWeightage: *ref_90
                                  currentConfigRiskScore: *ref_91
                                  baseConfigRiskScore: *ref_92
                              dteGlobalMode:
                                type: object
                                properties:
                                  currentConfigState: *ref_28
                                  baseConfigState: *ref_28
                                  configWeightage: *ref_90
                                  currentConfigRiskScore: *ref_91
                                  baseConfigRiskScore: *ref_92
                              hostPercentageWithDteEnabled:
                                type: object
                                properties:
                                  currentConfigState:
                                    type: number
                                    description: >-
                                      Percentage of hosts configured with dte
                                      enabled.
                                    minimum: 0
                                    maximum: 100
                                  baseConfigState:
                                    type: number
                                    description: >-
                                      Percentage of hosts configured with dte
                                      enabled.
                                    minimum: 0
                                    maximum: 100
                                  configWeightage: *ref_90
                                  currentConfigRiskScore: *ref_91
                                  baseConfigRiskScore: *ref_92
                                  totalHosts:
                                    type: number
                                    description: Total number of hosts.
                              backupAnomalyDetection:
                                type: object
                                properties:
                                  currentConfigState:
                                    type: integer
                                    description: >-
                                      The current state of backup anomaly
                                      detection.
                                  baseConfigState:
                                    type: integer
                                    description: >-
                                      The baseline state of backup anomaly
                                      detection.
                                  configWeightage: *ref_90
                                  currentConfigRiskScore: *ref_91
                                  baseConfigRiskScore: *ref_92
                              aliasAutoAdd:
                                type: object
                                properties:
                                  currentConfigState: *ref_17
                                  baseConfigState: *ref_17
                                  configWeightage: *ref_90
                                  currentConfigRiskScore: *ref_91
                                  baseConfigRiskScore: *ref_92
                              mpa: &ref_93
                                type: object
                                properties:
                                  currentConfigState:
                                    type: string
                                    description: >-
                                      Current state of the security
                                      configuration.
                                  baseConfigState:
                                    type: string
                                    description: >-
                                      Baseline state of the security
                                      configuration that the user has set.
                                  configWeightage: *ref_90
                                  currentConfigRiskScore: *ref_91
                                  baseConfigRiskScore: *ref_92
                              hostPercentageWithServiceUser:
                                type: object
                                properties:
                                  currentConfigState:
                                    type: number
                                    description: >-
                                      Percentage of hosts configured with
                                      service user.
                                    minimum: 0
                                    maximum: 100
                                  baseConfigState:
                                    type: number
                                    description: >-
                                      Percentage of hosts configured with
                                      service user.
                                    minimum: 0
                                    maximum: 100
                                  configWeightage: *ref_90
                                  currentConfigRiskScore: *ref_91
                                  baseConfigRiskScore: *ref_92
                                  totalServiceUserSupportedHosts:
                                    type: number
                                    description: >-
                                      Total number of hosts, that support
                                      service user account.
                              malwareDetection: *ref_93
        '401': *ref_2
        '500': *ref_4
  /security/configuration-baseline:
    post:
      description: >
        This endpoint allows setting new security baseline configuration
        values. 

        A baseline value represents the minimum acceptable configuration
        required for security measures.


        Note: In case multi-person authorization is configured, modification of
        security baseline configurations

        are not reflected immediately. However, a multi-person authorization
        ticket is initiated that needs approval.

        The ticket id is returned in the response header.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|SETTINGS|`\

        Requires Operation: `|OPERATIONS|UPDATE|`
      tags:
        - Dashboard
      requestBody:
        content:
          application/vnd.netbackup+json;version=12.0:
            schema:
              type: object
              required:
                - data
              properties:
                data:
                  type: object
                  required:
                    - type
                    - attributes
                  properties:
                    type:
                      type: string
                      enum:
                        - securityTemplateRequest
                    attributes:
                      type: object
                      required:
                        - securitySettingsTemplate
                      properties:
                        securitySettingsTemplate:
                          type: object
                          properties:
                            ssoEnabled: *ref_63
                            allowInsecureBackLevelHost: *ref_16
                            certificateAutoDeployLevel: *ref_18
                            mfaEnforced: *ref_41
                            dteGlobalMode: *ref_28
                            hostPercentageWithDteEnabled:
                              type: number
                              default: 0
                              description: Percentage of hosts configured with dte enabled.
                            backupAnomalyDetection:
                              type: integer
                              description: >-
                                The configuration state of backup anomaly
                                detection.
                            aliasAutoAdd: *ref_17
                            mpa:
                              type: string
                              description: The state of mpa configuration.
                              enum:
                                - ENABLED
                                - DISABLED
                            malwareDetection:
                              type: string
                              description: The state of the security configuration.
                              enum:
                                - CONFIGURED
                                - NOT_CONFIGURED
                            hostPercentageWithServiceUser:
                              type: number
                              default: 0
                              description: >-
                                Percentage of hosts configured with service
                                user.
        description: The data of the security configurations.
        required: true
      responses:
        '201':
          description: Configuration baseline is created.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema:
                description: The response containing the fileId and versionId created.
                type: object
                required:
                  - data
                properties:
                  data:
                    description: The response containing the fileId and versionId created.
                    type: object
                    required:
                      - id
                      - type
                      - attributes
                    properties:
                      id:
                        type: string
                        description: The ID of the response
                        enum:
                          - securityTemplateResponse
                      type:
                        type: string
                        description: The type of the response
                        enum:
                          - securityTemplateResponse
                      attributes:
                        description: >
                          The attributes of the response containing the fileId
                          and versionId.
                        type: object
                        properties:
                          fileId:
                            type: string
                            description: The file id of the configuration baseline.
                          versionId:
                            type: integer
                            description: >-
                              The version id created of the configuration
                              baseline.
        '202':
          description: >-
            The request to update the security properties is sent to the server
            and it needs an approval from either the multi-person authorization
            or multifactor authentication process.
          headers:
            X-NetBackup-MPA-Ticket:
              description: >-
                The Ticket ID of newly-generated multi-person authorization
                ticket.
              schema:
                type: string
        '204':
          description: Configuration baseline is already up-to-date.
        '400': *ref_5
        '401': *ref_2
        '415': *ref_11
        '500': *ref_4
  /security/ratelimit-configurations:
    post:
      description: >
        Create a rate-limit configuration to control the incoming HTTP requests
        rate on a specific URL. 

        This API is restricted to the '/netbackup/login' URL. This configuration
        restricts user authentication attempts 

        based on the configured requestLimit and the time-period duration
        (interval) for all login attempts coming from the same remote IP
        address.


        **Access Control:**\

        Enforcement Type: [ API-Level
        ](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|RATELIMIT|`\

        Requires Operation: `|OPERATIONS|ADD|`
      tags:
        - Rate limiter
      security: []
      requestBody:
        description: The rate limit resource to create.
        content:
          application/vnd.netbackup+json;version=12.0:
            schema: &ref_96
              type: object
              required:
                - data
              properties:
                data: &ref_94
                  type: object
                  required:
                    - type
                    - attributes
                  properties:
                    type:
                      type: string
                      enum:
                        - rateLimitConfig
                    id:
                      type: string
                    attributes:
                      type: object
                      properties:
                        rateLimitType:
                          type: string
                          enum:
                            - IP_BASED
                          default: IP_BASED
                        interval:
                          type: string
                          description: >
                            The ISO 8601 duration that represents the time
                            interval for the rate-limit configuration. 

                            Duration must be greater than 0 seconds and less
                            than 1 hour. Specify the duration in the format
                            PT[n]M[n]S. 

                            For example, 1 second=PT1S and 5 minutes=PT5M.
                        requestLimit:
                          type: integer
                          description: >-
                            The maximum number of requests allowed within the
                            interval. A value less than or equal to 0 disables
                            the configuration.
                          minimum: 1
                          maximum: 9999
                        url:
                          type: string
                          description: >
                            The relative NetBackup URL associated with the
                            configuration. The interval and limit are applied to
                            the 

                            incoming HTTP requests for this URL. The only URL
                            that is supported for rate-limiting configuration is
                            '/netbackup/login'.
                        httpMethod:
                          type: string
                          enum:
                            - POST
                            - PUT
                            - GET
                            - PATCH
                            - DELETE
                          description: >
                            Rate-limit configuration can optionally include the
                            HTTP method along with the URL to limit

                            specific actions on a resource collection. If not
                            specified, the interval and limit are applied to
                            all 

                            HTTP methods applicable for the URL.
              example:
                data:
                  type: rateLimitConfig
                  attributes:
                    interval: PT30S
                    requestLimit: 100
                    rateLimitType: IP_BASED
                    url: /netbackup/login
                    httpMethod: POST
        required: true
      responses:
        '201':
          description: Successfully created the rate-limit configuration resource.
          headers:
            Location:
              description: A link to the newly created rate limit resource.
              schema:
                type: string
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: &ref_95
                type: object
                properties:
                  data: *ref_94
        '400': *ref_5
        '401': *ref_2
        '409':
          description: The rate limit resource already exists for this configuration.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_0
        '500': *ref_4
    get:
      description: >
        Get all the rate-limit configurations.


        **Access Control:**\

        Enforcement Type: [ API-Level
        ](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|RATELIMIT|`\

        Requires Operation: `|OPERATIONS|VIEW|`
      tags:
        - Rate limiter
      security: []
      responses:
        '200':
          description: Returns all rate limit configuration resources.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: &ref_289
                type: object
                required:
                  - data
                properties:
                  data:
                    type: array
                    items: *ref_94
        '401': *ref_2
        '406': *ref_3
        '500': *ref_4
  '/security/ratelimit-configurations/{id}':
    parameters:
      - name: id
        in: path
        description: The ID of the rate-limit configuration resource to retrieve.
        required: true
        schema:
          type: integer
    get:
      description: >
        Returns a single rate-limit resource by its ID.


        **Access Control:**\

        Enforcement Type: [ API-Level
        ](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|RATELIMIT|`\

        Requires Operation: `|OPERATIONS|VIEW|`
      tags:
        - Rate limiter
      responses:
        '200':
          description: >-
            Successfully retrieved the rate-limit configuration resource for the
            provided ID.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_95
        '401': *ref_2
        '404': *ref_14
        '406': *ref_3
        '500': *ref_4
    put:
      description: >
        Updates the rate-limit configuration resource with the specified ID.
        This API is restricted to the '/netbackup/login' URL.


        **Access Control:**\

        Enforcement Type: [ API-Level
        ](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|RATELIMIT|`\

        Requires Operation: `|OPERATIONS|UPDATE|`
      tags:
        - Rate limiter
      security: []
      requestBody:
        description: The rate limit configuration resource values to be updated.
        content:
          application/vnd.netbackup+json;version=12.0:
            schema: *ref_96
        required: true
      responses:
        '204':
          description: Successfully updated the rate-limit configuration resource.
        '400': *ref_5
        '401': *ref_2
        '403': *ref_97
        '404': *ref_14
        '406': *ref_3
        '500': *ref_4
    delete:
      description: >
        Deletes the existing rate-limit configuration resource with the
        specified ID.


        **Access Control:**\

        Enforcement Type: [ API-Level
        ](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|SECURITY|RATELIMIT|`\

        Requires Operation: `|OPERATIONS|DELETE|`
      tags:
        - Rate limiter
      responses:
        '204':
          description: Deleted the rate-limit configuration resource for the provided ID.
        '401': *ref_2
        '404': *ref_14
        '500': *ref_4
  /security/bulk-anomaly-requests:
    patch:
      description: >
        Performs the request to bulk update of the anomaly status for the
        specified anomaly IDs.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|MANAGE|ANOMALIES|`\

        Requires Operation: `|OPERATIONS|UPDATE|`
      tags:
        - Anomaly
      requestBody:
        content:
          application/vnd.netbackup+json;version=12.0:
            schema: &ref_297
              type: object
              required:
                - data
              properties:
                data:
                  type: array
                  description: The details of backup anomalies.
                  items: &ref_299
                    type: object
                    required:
                      - id
                      - type
                      - attributes
                    properties:
                      id:
                        type: string
                      type:
                        type: string
                        enum:
                          - patchAnomaly
                      attributes: *ref_78
        description: The list of anomalies that need to be updated.
        required: true
      responses:
        '202':
          description: The request to update the anomaly record is initiated.
          headers:
            Location:
              description: A link to the update request.
              schema:
                type: string
                format: url
            Retry-After:
              description: >-
                The time in ISO-8601 format when the results may be checked
                next.
              schema:
                type: string
                format: date-time
        '400': *ref_5
        '401': *ref_2
        '406': *ref_3
        '413':
          description: >-
            The request consists of a large number of anomaly records to be
            updated. Send requests in batches with maximum of 1000 records in
            each request.
        '415': *ref_11
        '429':
          description: >-
            The request consists of a large number of anomaly records to be
            updated. Send requests in batches with maximum of 32 records in each
            request.
          headers: &ref_98
            Retry-After:
              description: >-
                The time in ISO-8601 format when the results may be checked
                next.
              schema:
                type: string
                format: date-time
        '500': *ref_4
  /security/bulk-anomaly-extension-requests:
    patch:
      description: >
        Performs the request to bulk update of the anomaly status for the
        specified anomaly extension IDs.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|MANAGE|ANOMALIES|`\

        Requires Operation: `|OPERATIONS|UPDATE|`
      tags:
        - Anomaly Extension
      requestBody:
        content:
          application/vnd.netbackup+json;version=12.0:
            schema: &ref_298
              type: object
              required:
                - data
              properties:
                data:
                  type: array
                  description: The details of system anomalies.
                  items: &ref_300
                    type: object
                    required:
                      - type
                      - attributes
                      - id
                    description: The details of a specific anomaly.
                    properties:
                      type:
                        type: string
                        enum:
                          - anomalyExtension
                      id:
                        type: string
                      attributes: &ref_301
                        type: object
                        required:
                          - anomalyStatus
                        properties:
                          anomalyStatus:
                            type: string
                            description: The status of the anomaly.
                            enum:
                              - ANOMALY
                              - NOT_REVIEWED
                              - REPORTED_FALSE_POSITIVE
                              - IGNORED
      responses:
        '202':
          description: The request to update the anomaly extension record is initiated.
          headers:
            Location:
              description: A link to the update request.
              schema:
                type: string
                format: url
            Retry-After:
              description: >-
                The time in ISO-8601 format when the results may be checked
                next.
              schema:
                type: string
                format: date-time
        '400': *ref_5
        '401': *ref_2
        '406': *ref_3
        '413':
          description: >-
            The request consists of a large number of anomaly extension records
            to be updated. Send requests in batches with maximum of 1000 records
            in each request.
        '415': *ref_11
        '429':
          description: >-
            The request consists of a large number of anomaly records to be
            updated. Send requests in batches with maximum of 32 records in each
            request.
          headers: *ref_98
        '500': *ref_4
  '/security/bulk-anomaly-requests/{requestId}':
    get:
      description: >
        Retrieves the status of the request to bulk update the anomaly record.

        After the bulk update is complete, the output is deleted.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|MANAGE|ANOMALIES|`\

        Requires Operation: `|OPERATIONS|VIEW|`
      tags:
        - Anomaly
      parameters:
        - name: requestId
          in: path
          required: true
          description: The ID of the request to bulk update the anomalies.
          schema:
            type: string
      responses:
        '200':
          description: The specified anomalies are updated successfully.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: &ref_100
                type: object
                properties:
                  meta:
                    type: object
                    properties:
                      bulkResourceStatus:
                        type: array
                        items:
                          type: object
                          properties:
                            httpStatus:
                              type: number
                              description: >
                                HTTP response status code applicable to the
                                individual resource in the array as if this were
                                a 

                                single-resource request.
                            id:
                              type: string
                              description: >
                                The unique resource identifier.  For some use
                                cases such as failed create requests, 

                                the id may not be known
                            type:
                              type: string
                              description: >-
                                The resource type which defines the resource
                                collection for this bulk request
                            links:
                              type: object
                          required:
                            - httpStatus
                            - type
                    required:
                      - bulkResourceStatus
                required:
                  - meta
        '202':
          description: The bulk update of anomalies is in progress.
          headers:
            Retry-After:
              description: >-
                The time in ISO-8601 format when the results may be checked
                next.
              schema:
                type: string
                format: date-time
        '207':
          description: |
            The bulk update is complete with one or more failures.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: &ref_99
                type: object
                properties:
                  meta:
                    type: object
                    properties:
                      bulkResourceStatus:
                        type: array
                        items:
                          type: object
                          properties:
                            httpStatus:
                              type: number
                              description: >
                                HTTP response status code applicable to the
                                individual resource in the array as if this were
                                a 

                                single-resource request.
                            id:
                              type: string
                              description: >
                                The unique resource identifier.  For some use
                                cases such as failed create requests, 

                                the id may not be known
                            errors: *ref_0
                            type:
                              type: string
                              description: >-
                                The resource type which defines the resource
                                collection for this bulk request
                            links:
                              type: object
                          required:
                            - httpStatus
                            - type
                    required:
                      - bulkResourceStatus
                required:
                  - meta
        '401': *ref_2
        '404': *ref_14
        '406': *ref_3
        '429':
          description: >-
            The request comes before the header value of `After-Retry`. Send
            request after the header value.
          headers: *ref_98
        '500': *ref_4
    delete:
      description: >
        You can stop updating the anomaly. Note that the request will not be
        available through the GET API.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|MANAGE|ANOMALIES|`\

        Requires Operation: `|OPERATIONS|DELETE|`
      tags:
        - Anomaly
      parameters:
        - name: requestId
          in: path
          required: true
          description: The ID of the request to bulk update the anomalies.
          schema:
            type: string
      responses:
        '207':
          description: >
            The request to bulk update the anomalies is canceled. However, the
            operation may already be complete.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_99
        '404':
          description: >
            The specified request to bulk update the anomalies cannot be found.
            Reasons:

            The request ID is not valid.

            The request is complete but the results are already retrieved.

            The request is canceled.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_0
        '406': *ref_3
        '500': *ref_4
  '/security/bulk-anomaly-extension-requests/{requestId}':
    get:
      description: >
        Retrieves the status of the request to bulk update the anomaly extension
        record.

        After the bulk update is complete, the output is deleted.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|MANAGE|ANOMALIES|`\

        Requires Operation: `|OPERATIONS|VIEW|`
      tags:
        - Anomaly Extension
      parameters:
        - name: requestId
          in: path
          required: true
          description: The ID of the bulk anomaly extension update request.
          schema:
            type: string
      responses:
        '200':
          description: The specified anomaly extension records are updated successfully.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_100
        '202':
          description: The bulk update of anomalies is in progress.
          headers:
            Retry-After:
              description: >-
                The time in ISO-8601 format when the results may be checked
                next.
              schema:
                type: string
                format: date-time
        '207':
          description: |
            The bulk update is complete with one or more failures.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_99
        '401': *ref_2
        '404': *ref_14
        '406': *ref_3
        '429':
          description: >-
            The request comes before the header value of `After-Retry`. Send
            request after the header value.
          headers: *ref_98
        '500': *ref_4
    delete:
      description: >
        You can stop updating the anomaly extension records. Note that the
        request will not be available through the GET API.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|MANAGE|ANOMALIES|`\

        Requires Operation: `|OPERATIONS|DELETE|`
      tags:
        - Anomaly Extension
      parameters:
        - name: requestId
          in: path
          required: true
          description: The ID of the bulk anomaly extension update request.
          schema:
            type: string
      responses:
        '207':
          description: >
            The request to bulk update the anomaly extension records is
            canceled. However, the operation may already be complete.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_99
        '404':
          description: >
            Bulk update anomaly extension record request not found. This can be
            due to the following circumstances:

            The request id is invalid.

            The request was completed but the results were already retrieved.

            The request was cancelled.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_0
        '406': *ref_3
        '500': *ref_4
  /security/aggregate-anomalies:
    get:
      description: >
        Retrieves the list of all aggregate job anomalies under a single view.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|MANAGE|ANOMALIES|`\

        Requires Operation: `|OPERATIONS|VIEW|`
      tags:
        - Aggregate Anomaly
      parameters:
        - name: filter
          description: >
            Filter criteria syntax is based on OData standards. Filtering is
            supported on the following attributes:

            |Name|Supported Operators|Description|Schema|

            |---|---|---|---|

            |id|eq contains startswith endswith|The unique identifier for
            aggregate anomaly.|string|

            |createdDateTime|lt gt le ge|The date and time when aggregate
            anomaly is detected.|date-time|

            |lastUpdatedDateTime|lt gt le ge|The date and time when aggregate
            anomaly is updated.|date-time|

            |assetName|eq contains startswith endswith|Asset id of an aggregate
            anomaly.|string|

            |clientName|eq contains startswith endswith|Client name for which
            aggregate anomaly is raised.|string|

            |anomalySeverity|eq ne|Severity of aggregate anomaly based on
            anomaly score. Possible values: HIGH, MEDIUM, LOW.|string|

            |policyName|eq contains startswith endswith|Policy name for which
            aggregate anomaly is raised.|string|

            |policyType|eq contains startswith endswith|Policy type for which
            aggregate anomaly is raised.|string|

            |scheduleName|eq contains startswith endswith|Schedule name for
            which aggregate anomaly is raised.|string|

            |scheduleType|eq contains startswith endswith|Schedule type for
            which aggregate anomaly is raised.|string|

            |jobId|eq contains startswith endswith|Job Id for which aggregate
            anomaly is raised.|string|

            |impactedStreams|lt gt le ge|Specifies the number of streams
            impacted.|integer|

            |totalStreams|lt gt le ge|Specifies the number of total
            streams.|integer|
          in: query
          required: false
          schema:
            type: string
        - *ref_79
        - *ref_80
        - name: sort
          description: >
            Sorts in ascending order on the specified property. Prefix with '-'
            for descending order.

            Sorting is supported on the following attributes:

            |Name|

            |---|

            |createdDateTime|
          in: query
          required: false
          schema:
            type: string
      responses:
        '200':
          description: >-
            Successfully retrieves the list of all aggregate job anomalies under
            a single view.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: &ref_302
                type: object
                required:
                  - links
                  - data
                  - meta
                properties:
                  links: *ref_54
                  data:
                    type: array
                    items:
                      properties:
                        type:
                          type: string
                          enum:
                            - anomalyAggregate
                          description: The type of the anomaly aggregate data.
                        id:
                          type: string
                        attributes:
                          allOf:
                            - &ref_101
                              type: object
                              required:
                                - jobId
                                - inference
                                - clientName
                                - anomalySeverity
                                - policyName
                                - policyType
                                - scheduleName
                                - scheduleType
                                - impactedStreams
                                - totalStreams
                                - anomalyIds
                              properties:
                                assetName:
                                  type: string
                                  description: Specifies the asset id.
                                inference:
                                  type: string
                                  description: Specifies the details of inference signals.
                                clientName:
                                  type: string
                                  description: Specifies the client name.
                                anomalySeverity:
                                  type: string
                                  description: Specifies the severity of anomaly detected.
                                  enum:
                                    - HIGH
                                    - MEDIUM
                                    - LOW
                                policyName:
                                  type: string
                                  description: Specifies the policy name.
                                policyType:
                                  type: string
                                  description: The backup policy type.
                                  enum:
                                    - STANDARD
                                    - PROXY
                                    - NONSTANDARD
                                    - APOLLO_WBAK
                                    - OBACKUP
                                    - ANY
                                    - INFORMIX
                                    - SYBASE
                                    - SHAREPOINT
                                    - WINDOWS
                                    - NETWARE
                                    - BACKTRACK
                                    - AUSPEX_FASTBACK
                                    - WINDOWS_NT
                                    - OS2
                                    - SQL_SERVER
                                    - EXCHANGE
                                    - SAP
                                    - DB2
                                    - NDMP
                                    - FLASHBACKUP
                                    - SPLITMIRROR
                                    - AFS
                                    - DFS
                                    - DATASTORE
                                    - LOTUS_NOTES
                                    - NCR_TERADATA
                                    - VAX_VMS
                                    - HP3000_MPE
                                    - FBU_WINDOWS
                                    - VAULT
                                    - BE_SQL_SERVER
                                    - BE_EXCHANGE
                                    - MAC
                                    - DS
                                    - NBU_CATALOG
                                    - GENERIC
                                    - CMS_DB
                                    - PUREDISK_EXPORT
                                    - ENTERPRISE_VAULT
                                    - VMWARE
                                    - HYPERV
                                    - NBU_SEARCHSERVER
                                    - HYPERSCALE
                                    - BIGDATA
                                    - CLOUD
                                    - DEPLOYMENT
                                    - HYPERVISOR
                                    - UNIVERSAL_SHARE
                                    - NAS_DATA_PROTECTION
                                scheduleName:
                                  type: string
                                  description: Specifies the schedule name.
                                scheduleType:
                                  type: string
                                  description: The type of schedule used by the backup job.
                                  enum:
                                    - FULL_BACKUP
                                    - DIFFERENTIAL_INCREMENTAL_BACKUP
                                    - USER_BACKUP
                                    - USER_ARCHIVE
                                    - CUMULATIVE_INCREMENTAL_BACKUP
                                    - VAULT_CATALOG_BACKUP
                                    - AUTOMATIC_BACKUP
                                    - APPLICATION_BACKUP
                                    - AUTOMATIC_FULL_BACKUP
                                    - AUTOMATIC_INCREMENTAL_BACKUP
                                    - AUTOMATIC_DIFFERENTIAL_INCREMENTAL_BACKUP
                                    - AUTOMATIC_CUMULATIVE_INCREMENTAL_BACKUP
                                    - AUTOMATIC_VAULT
                                    - ARCHIVE_REDO_LOG_BACKUP
                                    - TRANSACTION_LOG_BACKUP
                                    - PRE_CHECK
                                    - STAGE_PACKAGE
                                    - INSTALL_PACKAGE
                                    - UNUSED
                                    - UNRECOGNIZED_VALUE
                                impactedStreams:
                                  type: integer
                                  description: Specifies the number of streams impacted.
                                totalStreams:
                                  type: integer
                                  description: Specifies the number of total streams.
                                jobId:
                                  type: string
                                  description: Specifies the job Id.
                                createdDateTime:
                                  type: string
                                  format: date-time
                                  description: >-
                                    The ISO 8601 formatted time. The timestamp
                                    of the aggregate anomaly was created.
                                lastUpdatedDateTime:
                                  type: string
                                  format: date-time
                                  description: >-
                                    The ISO 8601 formatted time. The timestamp
                                    of the aggregate anomaly was updated.
                                anomalyIds:
                                  type: array
                                  items:
                                    type: string
                                  description: The list of anomaly Ids.
                                extendedAttributes:
                                  type: object
                                  description: >-
                                    The additional attributes for generated
                                    aggregate anomaly. It is of type KEY-VALUE
                                    pair.
                            - type: object
                  meta:
                    type: object
                    properties:
                      pagination: *ref_55
        '400': *ref_5
        '401': *ref_2
        '406': *ref_3
        '500': *ref_4
    patch:
      description: >
        Performs the request to bulk update of the anomaly status for the
        specified anomaly IDs in aggregate anomaly list.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|MANAGE|ANOMALIES|`\

        Requires Operation: `|OPERATIONS|UPDATE|`
      tags:
        - Aggregate Anomaly
      requestBody:
        content:
          application/vnd.netbackup+json;version=12.0:
            schema: &ref_303
              type: object
              required:
                - data
              properties:
                data:
                  type: array
                  description: The details of aggregate anomalies.
                  items: &ref_304
                    type: object
                    required:
                      - id
                      - type
                      - attributes
                    properties:
                      id:
                        type: string
                      type:
                        type: string
                        enum:
                          - anomalyAggregatePatch
                      attributes: &ref_305
                        type: object
                        required:
                          - anomalyIds
                          - anomalyStatus
                        properties:
                          anomalyIds:
                            type: array
                            items:
                              type: string
                            description: The list of anomaly Ids.
                          anomalyStatus:
                            type: string
                            description: The status of the anomaly.
                            enum:
                              - ANOMALY
                              - NOT_REVIEWED
                              - REPORTED_FALSE_POSITIVE
                              - IGNORED
        description: The list of aggregate anomalies that need to be updated.
        required: true
      responses:
        '202':
          description: The request to update the aggregate anomaly record is initiated.
          headers:
            Location:
              description: A link to the update request.
              schema:
                type: string
                format: url
            Retry-After:
              description: >-
                The time in ISO-8601 format when the results may be checked
                next.
              schema:
                type: string
                format: date-time
        '400': *ref_5
        '401': *ref_2
        '406': *ref_3
        '413':
          description: >-
            The request consists of a large number of anomaly aggregate records
            to be updated. Send requests in batches with maximum of 1000 records
            in each request.
        '415': *ref_11
        '429':
          description: >-
            The request consists of a large number of anomaly aggregate records
            to be updated. Send requests in batches with maximum of 32 records
            in each request.
          headers: *ref_98
        '500': *ref_4
  '/security/aggregate-anomalies/{id}':
    get:
      description: >
        Retrieves the aggregate anomaly detected based on the ID.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|MANAGE|ANOMALIES|`\

        Requires Operation: `|OPERATIONS|VIEW|`
      tags:
        - Aggregate Anomaly
      parameters:
        - name: id
          in: path
          required: true
          description: Get aggregate anomaly based on ID.
          schema:
            type: string
      responses:
        '200':
          description: Successfully retrieved the aggregate anomaly based on ID.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: &ref_308
                type: object
                required:
                  - data
                properties:
                  data:
                    type: object
                    required:
                      - type
                      - attributes
                      - id
                    description: The data specific to an aggregate anomaly.
                    properties:
                      type:
                        type: string
                        enum:
                          - anomalyAggregate
                      id:
                        type: string
                      attributes: *ref_101
        '400': *ref_5
        '401': *ref_2
        '404': *ref_14
        '406': *ref_3
        '500': *ref_4
    delete:
      description: >
        Deletes the aggregate anomaly record for a given ID.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|MANAGE|ANOMALIES|`\

        Requires Operation: `|OPERATIONS|DELETE|`
      tags:
        - Aggregate Anomaly
      parameters:
        - name: id
          in: path
          required: true
          description: Delete aggregate anomaly based on ID.
          schema:
            type: string
      responses:
        '204':
          description: Successfully deleted aggregate anomaly record.
        '401': *ref_2
        '404': *ref_14
        '500': *ref_4
    patch:
      description: >
        Updates the single aggregate anomaly based on id specified.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|MANAGE|ANOMALIES|`\

        Requires Operation: `|OPERATIONS|UPDATE|`
      tags:
        - Aggregate Anomaly
      parameters:
        - name: id
          in: path
          required: true
          description: >-
            Unique identifier for aggregate anomaly on which anomaly information
            will get updated.
          schema:
            type: string
      requestBody:
        content:
          application/vnd.netbackup+json;version=12.0:
            schema: &ref_306
              type: object
              required:
                - data
              properties:
                data:
                  type: object
                  required:
                    - type
                    - attributes
                    - id
                  properties:
                    type:
                      type: string
                      enum:
                        - anomalyAggregatePatch
                    id:
                      type: string
                    attributes: &ref_307
                      type: object
                      required:
                        - anomalyIds
                        - inference
                        - anomalySeverity
                        - impactedStreams
                        - totalStreams
                      properties:
                        anomalyIds:
                          type: array
                          items:
                            type: string
                          description: The list of anomaly Ids.
                        inference:
                          type: string
                          description: Specifies the details of inference signals.
                        anomalySeverity:
                          type: string
                          description: Specifies the severity of anomaly detected.
                          enum:
                            - HIGH
                            - MEDIUM
                            - LOW
                        impactedStreams:
                          type: integer
                          description: Specifies the number of streams impacted.
                        totalStreams:
                          type: integer
                          description: Specifies the number of total streams.
      responses:
        '204':
          description: Successfully updated the aggregate anomaly.
        '400': *ref_5
        '401': *ref_2
        '404': *ref_14
        '406': *ref_3
        '415': *ref_11
        '500': *ref_4
  /security/anomaly/user-defined-file-extension-checklist:
    get:
      description: >
        Retrieves the ransomware file extensions provided by the user.Anomaly
        detection service will look for system as well as  user defined
        extensions (if user defined is present) to raise an anomaly. 

        **Access Control**\ Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\
        Namespace: `|MANAGE|ANOMALIES|`\ Requires Operation: `|OPERATIONS|VIEW|`
      tags:
        - Anomaly File Extensions
      responses:
        '200':
          description: Successfully retrieved ransomware file extensions provided by user.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: &ref_103
                type: object
                required:
                  - data
                properties:
                  data:
                    type: object
                    required:
                      - type
                      - id
                      - attributes
                    properties:
                      type:
                        type: string
                        enum:
                          - userDefinedExtensionChecklistResponse
                      id:
                        type: string
                      attributes: &ref_102
                        type: object
                        properties:
                          includeExtension:
                            type: array
                            description: >-
                              It is list of ransomware extension names which
                              will be included while raising an anomaly.
                            example:
                              - wannacry
                              - lockbit
                          excludeExtension:
                            type: array
                            description: >-
                              It is list of ransomware extension names which
                              will be excluded while raising an anomaly.
                            example:
                              - mp3
                              - pdf
        '401': *ref_2
    post:
      description: >
        Creates ransomware extensions. Through this API, one can configure
        additional ransomware file extensions which are not part of system
        defined list.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|MANAGE|ANOMALIES|`\

        Requires Operation: `|OPERATIONS|ADD|`
      tags:
        - Anomaly File Extensions
      requestBody:
        content:
          application/vnd.netbackup+json;version=12.0:
            schema: &ref_309
              type: object
              required:
                - data
              properties:
                data:
                  type: object
                  required:
                    - type
                    - attributes
                  properties:
                    type:
                      type: string
                      enum:
                        - userDefinedExtensionChecklistRequest
                    attributes: *ref_102
        description: Creates ransomware file extensions provided by user.
        required: true
      responses:
        '204':
          description: Creates ransomware file extensions provided by user.
        '400': *ref_5
        '401': *ref_2
        '415': *ref_11
        '500': *ref_4
  '/security/anomaly/user-defined-file-extension-checklist/{checklistKey}':
    patch:
      description: >
        Updates the ransomware file extensions provided by user.

        **Access Control**\ Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\
        Namespace: `|MANAGE|ANOMALIES|`\ Requires Operation:
        `|OPERATIONS|UPDATE|`
      tags:
        - Anomaly File Extensions
      parameters:
        - name: checklistKey
          in: path
          required: true
          description: The checklist key to be modified.
          schema:
            type: string
            enum:
              - include
              - exclude
      requestBody:
        content:
          application/vnd.netbackup+json;version=12.0:
            schema: &ref_311
              type: object
              required:
                - data
              properties:
                data:
                  type: object
                  required:
                    - type
                    - attributes
                  properties:
                    type:
                      type: string
                      enum:
                        - userDefinedExtensionChecklistPatchRequest
                    attributes:
                      type: object
                      properties:
                        extensions:
                          type: array
                          description: >-
                            It is a user defined list of ransomware extension
                            names.
                          example:
                            - lockbit
      responses:
        '200':
          description: Successfully updated ransomware file extensions for provided key.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: *ref_103
        '400': *ref_5
        '401': *ref_2
        '404': *ref_14
        '415': *ref_11
        '500': *ref_4
  /security/anomaly/sytem-defined-file-extension-checklist:
    get:
      description: >
        Retrieves the system defined ransomware file extension list. Anomaly
        detection service will look for system as well as  user defined
        extensions (if user defined is present) to raise an anomaly.

        **Access Control**\ Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\
        Namespace: `|MANAGE|ANOMALIES|`\ Requires Operation: `|OPERATIONS|VIEW|`
      tags:
        - Anomaly File Extensions
      responses:
        '200':
          description: Successfully retrieved system defined ransomware file extensions.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: &ref_310
                type: object
                required:
                  - data
                properties:
                  data:
                    type: object
                    required:
                      - type
                      - id
                      - attributes
                    properties:
                      type:
                        type: string
                        enum:
                          - systemDefinedExtensionChecklistResponse
                      id:
                        type: integer
                      attributes:
                        type: object
                        properties:
                          systemDefinedExtensions:
                            type: array
                            description: >-
                              It is a system defined list of ransomware
                              extension names.
                            example:
                              - lockbit
        '401': *ref_2
  /security/anomaly/file-extension-checklist:
    get:
      description: >
        Retrieves the system defined and user defined ransomware file extension
        list. Anomaly detection service will look for system as well as  user
        defined extensions (if user defined is present) to raise an anomaly.

        **Access Control**\ Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/10.5/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\
        Namespace: `|MANAGE|ANOMALIES|`\ Requires Operation: `|OPERATIONS|VIEW|`
      tags:
        - Anomaly File Extensions
      responses:
        '200':
          description: >-
            Successfully retrieved system defined and user defined ransomware
            file extensions.
          content:
            application/vnd.netbackup+json;version=12.0:
              schema: &ref_314
                type: object
                required:
                  - data
                properties:
                  data:
                    type: object
                    required:
                      - type
                      - id
                      - attributes
                    properties:
                      type:
                        type: string
                        enum:
                          - extensionChecklistResponse
                      id:
                        type: integer
                      attributes:
                        type: object
                        properties:
                          includedExtensions:
                            type: array
                            description: >-
                              It is a system defined and user defined list of
                              ransomware extension names.
                            example:
                              - lockbit
        '401': *ref_2
components:
  securitySchemes:
    apiKeyAuth:
      type: apiKey
      in: header
      name: Authorization
    cookieAuth:
      type: apiKey
      in: cookie
      name: Authorization
    jwtAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
  parameters:
    clientName:
      in: path
      description: The client name.
      name: clientName
      required: true
      schema:
        type: string
    policyName:
      in: path
      description: The policy name.
      name: policyName
      required: true
      schema:
        type: string
    flistHash:
      in: path
      description: Hash of the file list in the stream
      name: flistHash
      required: true
      schema:
        type: string
    credname: *ref_104
    kmsId: *ref_47
    keyGroupName: *ref_50
    keyName: *ref_51
  requestBodies:
    postRevokeCertificateRequest: *ref_105
  schemas:
    getOcsfFormattedRecordResponse: *ref_106
    getOcsfFormattedRecordResponseData: *ref_107
    ocsfFormattedauditRecordDetails: *ref_108
    ocsfEnrichmentsInfoDetails: *ref_109
    getAuditRecordResponse: *ref_110
    auditRecordResponse: *ref_111
    getLoginDetailsResponseData: *ref_112
    loginDetailsResponseData: *ref_113
    getAuditRecordResponseData: *ref_1
    auditRecordDetails: *ref_114
    auditRecordKey: *ref_115
    auditRecordAttribute: *ref_116
    auditUserInfoDetails: *ref_117
    getCACertificateResponse: *ref_118
    webRootCertificateDetails: *ref_119
    caCertificateDetails: *ref_120
    extractedCertDetails: *ref_6
    nbcaCertDetails: *ref_70
    certificate: &ref_133
      type: string
      description: The X.509 certificate as a PEM-formatted string.
    certificateEnrollmentRequest:
      description: >-
        Obtains enrollment details for a host certificate that was issued by an
        external CA.
      type: object
      required:
        - data
      properties:
        data:
          description: >-
            The payload for the enrollment details for the external CA
            certificate.
          type: object
          required:
            - type
            - id
            - attributes
          properties:
            type:
              description: The type of the certificate enrollment request.
              type: string
              enum:
                - certificateEnrollmentRequest
            id:
              type: string
              description: The request identifier.
            attributes:
              description: Contains the payload attributes.
              type: object
              required:
                - hostName
              properties:
                hostName: *ref_121
                domainContext:
                  type: integer
                  description: For internal use only.
                preCheck:
                  type: boolean
                  description: >
                    Determines whether the external certificate can be
                    successfully enrolled or not.

                    True - The preCheck operation is performed.

                    False - The preCheck operation is skipped and the
                    certificate enrollment is carried out.
      example:
        data:
          type: certificateEnrollmentRequest
          id: 123
          attributes:
            hostName: xyz.com
            domainContext: 1
    certificateEnrollmentResponse:
      description: >-
        The response after the enrollment of the certificate that is issued by
        an external CA.
      type: object
      required:
        - data
      properties:
        data:
          description: >-
            The response payload after the certificate issued by an external CA
            is enrolled with NetBackup.
          type: object
          required:
            - type
            - id
            - attributes
          properties:
            type:
              description: The type of the certificate enrollment response.
              type: string
              enum:
                - certificateEnrollmentResponse
            id:
              type: string
              description: The response identifier.
            attributes:
              description: The attributes of the certificate enrollment response.
              type: object
              required:
                - hostId
                - securityLevel
                - masterHostId
                - externalCaUsage
              properties:
                hostId:
                  type: string
                  description: The unique ID assigned to the NetBackup host.
                securityLevel:
                  type: integer
                  default: 1
                  minimum: 0
                  maximum: 2
                  description: >
                    The certificate deployment level of the master server of the
                    host that initiated the certificate enrollment.
                masterHostId:
                  type: string
                  description: The host ID of the NetBackup master server.
                externalCaUsage:
                  type: integer
                  default: 0
                  minimum: 0
                  maximum: 2
                  description: >
                    Here,

                    ECA = External certificate authority.

                    NBCA = NetBackup certificate authority.

                    In the response payload, externalCaUsage is a security
                    setting that specifies if the TCPA should be

                    enforced or not. Possible values can be:
                      Disabled (0) - Only NBCA is used for NetBackup communication
                      Enabled  (1) - NetBackup allows communication with either NetBackup CA or external CA
                                     certificates. If one of the communicating hosts is only configured to use a
                                     NetBackup CA certificate, NetBackup certificates are used. If both hosts have an
                                     external CA certificate enrolled, external certificates are used.
                      Enforced (2) - NetBackup only allows communication with external CA certificates.
                                     Communication with NetBackup CA certificates is not allowed.
                tlsSessionResumption: *ref_122
      example:
        data:
          links:
            self:
              href: /security/external-certificate/enroll
          type: certificateEnrollmentResponse
          id: 123
          attributes:
            hostId: fc3ef0c4-3539-43bf-8e02-18e4bewqsd6r
            securityLevel: 1
            masterHostId: fc3egt3y-3539-43bf-8e02-18e4beas123g
            externalCaUsage: 1
    externalCertificateEntryRequest: *ref_123
    externalCertificateEntryResponse: *ref_124
    externalCertificateValidateRequest: *ref_125
    externalCertificateValidateResponse: *ref_126
    hostEnrollmentData:
      type: object
      properties:
        hostName: *ref_121
      required:
        - hostName
    hostInformation:
      type: object
      properties:
        csr: &ref_131
          type: string
          description: >
            A CSR is a PKCS10 formatted message that is sent from a Secure
            Sockets Layer (SSL) digital certificate applicant to a certificate
            authority (CA). The CSR validates the information the NetBackup CA
            requires to issue a certificate.
        hostName: *ref_121
        hostAlias:
          type: array
          items: *ref_121
          description: >
            A list of host aliases of the specified host. The specified hostName
            property must be present in this hostAlias array.
      required:
        - csr
        - hostName
        - hostAlias
    listDomainsResponse: *ref_127
    domainResource: *ref_12
    ldapDomainProperties: *ref_128
    testDomainConnectivityResource: *ref_129
    testDomainConnectivityResponse: *ref_130
    csr: *ref_131
    hostName: *ref_121
    hostID: *ref_57
    token: *ref_132
    postCertificateResponse:
      type: object
      properties:
        certificate: *ref_133
        hostId: *ref_57
        crl:
          type: string
          format: byte
          description: The certificate revocation list.
        securityLevel:
          type: integer
          description: >-
            The level of host checking for certificate enrollment and the
            frequency of updates for CRLs.
        masterHostId: *ref_57
        tlsSessionResumption: *ref_122
      required:
        - certificate
        - hostId
        - crl
        - securityLevel
        - masterHostId
    externalCertificateResponse:
      type: object
      properties:
        data: &ref_134
          description: >-
            The response containing the external certificate details that is
            enrolled with NetBackup.
          type: object
          properties:
            links:
              type: object
              properties:
                self:
                  type: object
                  properties:
                    href:
                      type: string
            type:
              type: string
              description: The type of the response.
              enum:
                - externalCertificateDetails
            id:
              type: string
              description: The subject of the certificate.
            attributes:
              type: object
              description: The attributes of the certificate.
              properties:
                subjectName:
                  type: string
                  description: The subject of the certificate.
                issuerName:
                  type: string
                  description: The issuer of the certificate.
                serialNumber: *ref_7
                fingerPrint:
                  type: string
                  description: Identifier of the certificate.
                notBefore:
                  type: string
                  format: date-time
                  description: >-
                    The ISO 8601 formatted time. The certificate is not valid
                    until this time.
                notAfter:
                  type: string
                  format: date-time
                  description: >-
                    The ISO 8601 formatted time. The certificate is not valid
                    after this time.
                createdOn:
                  type: string
                  format: date-time
                  description: >-
                    The ISO 8601 formatted time. The certificate is not valid
                    until this time.
                updatedOn:
                  type: string
                  format: date-time
                  description: >-
                    The ISO 8601 formatted time when this record was last
                    updated.
    externalCertificateDetails: *ref_134
    externalCertificateRequest: *ref_135
    getCertificateListResponse: *ref_136
    getCertificateResponse: *ref_10
    time: *ref_8
    timeZoneName: *ref_137
    timeZoneId: *ref_138
    certificateTokenType: *ref_139
    certificateState: *ref_140
    caCertificateAction: *ref_141
    hostType: *ref_142
    revocationReason: *ref_9
    serialNo: *ref_7
    postRevokeCertificateRequest: *ref_143
    postSecPropertyRequest: *ref_144
    createKmsDatabaseRequest: *ref_145
    nbkmsAttributes: *ref_146
    nbkmsPassphraseAttributes: *ref_147
    kmipAttributes: *ref_45
    precheckKmsRequest: *ref_148
    kmsServerAttributes: *ref_149
    pkiAttributes: *ref_150
    getkeyManagementServices: *ref_151
    getSinglekeyManagementService: *ref_152
    getKeyManagementServiceResponse: *ref_153
    getNBKmsDetails: *ref_154
    getKeyManagementServiceData: *ref_46
    certHealthCheckStatusAttributes: *ref_155
    getKeyManagementServiceAttributes: *ref_53
    getKeyManagementServiceDefinition: *ref_156
    updateKmsDatabaseRequest: *ref_157
    validationResponseKms: *ref_56
    createKeyRequest: *ref_158
    keyUpdateRequest: *ref_159
    keygroupCreateRequest: *ref_160
    keygroupUpdateRequest: *ref_161
    importKeyRequest: *ref_162
    exportKeyRequest: *ref_163
    recoverKeyRequest: *ref_164
    getKeygroupResponse: *ref_52
    getKeygroupAttributes: *ref_165
    createKeyResponse: *ref_166
    createKeyAttributes: *ref_49
    keyUpdateAttributes: *ref_167
    keygroupCreateAttributes: *ref_168
    keygroupUpdateAttributes: *ref_169
    importKeyAttributes: *ref_170
    importKeysResponse: *ref_171
    exportKeyAttributes: *ref_172
    exportKeyDetails: *ref_173
    recoverKeyAttributes: *ref_174
    keyDetailsResponse:
      type: object
      description: Returns keys and their details.
      required:
        - data
      properties:
        data:
          type: array
          items: &ref_177
            type: object
            required:
              - type
              - id
              - attributes
            properties:
              type:
                type: string
                enum:
                  - keyDetailsResponse
              id:
                description: The response identifier.
                type: string
              attributes:
                type: object
                required:
                  - key
                  - keyAttributes
                properties:
                  key:
                    type: string
                    description: The key used for encryption and decryption.
                  keyAttributes: *ref_175
    keyAttributeDetailsResponse: *ref_176
    keyDetails: *ref_177
    keyAttributeDetails: *ref_178
    keyAttributes: *ref_175
    keyGroupInfo: *ref_179
    encryptKeyRequest:
      type: object
      description: Encrypt the data using KMS key.
      properties:
        data:
          type: object
          properties:
            type:
              type: string
              enum:
                - kmsEncryptRequest
            attributes: &ref_180
              type: object
              properties:
                keyId:
                  type: string
                  description: |
                    Specifies the Key ID of the KMS key.
                    NBKMS/EKMS - Specify the KeyGroupName as Key ID.
                    CKMS - KMS Key ID provided by service provider.
                plainText:
                  type: string
                  description: |
                    Data to be encrypted in a Base64-encoded format.
                    This encrypted data will be decrypted by only decrypt API.
                aad:
                  type: string
                  description: >
                    Additional authentication data. If you specify additional
                    authentication data (aad) to encrypt data,

                    you must specify the same additional authentication data to
                    decrypt the data.
              required:
                - keyId
                - plainText
      required:
        - data
    encryptKeyAttributes: *ref_180
    encryptKeyResponse:
      type: object
      properties:
        data:
          type: object
          properties:
            type:
              type: string
              enum:
                - kmsEncryptResponse
            id:
              type: string
              description: The KMS key Id that was used to encrypt the plaintext.
            attributes:
              type: object
              properties:
                cipherText:
                  type: string
                  description: >
                    The encrypted plaintext in a Base64-encoded format. This
                    encrypted data will be decrypted by only decrypt API
          required:
            - type
            - id
            - attributes
      required:
        - data
    decryptKeyRequest:
      type: object
      description: Decrypts the ciphertext that was encrypted using KMS key.
      properties:
        data:
          type: object
          properties:
            type:
              type: string
              enum:
                - kmsDecryptRequest
            attributes: &ref_181
              type: object
              properties:
                cipherText:
                  type: string
                  description: Data to be decrypted in Base64-encoded format.
                aad:
                  type: string
                  description: >
                    Additional authentication data. Specify the same additional
                    authentication data (aad), which was used to encrypt the
                    data.
              required:
                - cipherText
      required:
        - data
    decryptKeyAttributes: *ref_181
    decryptKeyResponse:
      type: object
      properties:
        data:
          type: object
          properties:
            type:
              type: string
              enum:
                - kmsDecryptResponse
            attributes:
              type: object
              properties:
                plainText:
                  type: string
                  description: The decrypted plaintext in Base64-encoded format.
          required:
            - type
            - attributes
      required:
        - data
    getSecPropertyResponse: *ref_43
    handshakeIntervalInMinutes: *ref_38
    externalCaUsage: *ref_62
    cacpivEnabled: *ref_19
    cacpivADLDAPDomainMapping: *ref_20
    cacpivCertMappingAttribute: *ref_21
    cacpivUserDomainName: *ref_22
    cacpivOcspUri: *ref_23
    cacpivMSADCNMappingAttribute: *ref_24
    cacpivMSADUPNMappingAttribute: *ref_25
    cacpivLDAPCNMappingAttribute: *ref_26
    cacpivLDAPUPNMappingAttribute: *ref_27
    externalCertificateIdentityField: *ref_29
    getPerformAdminUserCheck: *ref_182
    postPerformAdminUserCheck: *ref_183
    cliAccessSettings: *ref_30
    userJwtTokenValidityInSeconds: *ref_39
    ssoEntityId: *ref_40
    blockClientProtection: *ref_31
    blockClientImageExpiration: *ref_32
    tlsSessionResumption: *ref_122
    tlsSessionResumptionEnable: *ref_184
    tlsSessionResumptionEnableUseDefault: *ref_185
    tlsSessionResumptionEnableUseCustom: *ref_186
    tlsSessionResumptionResponse: *ref_187
    tlsSessionResumptionCustomHandshakeResponse: *ref_188
    tlsSessionResumptionDefaultHandshakeResponse: *ref_189
    customHandshakeIntervalInMinutes: *ref_34
    default: *ref_35
    custom: *ref_33
    certificateAutoDeployLevelToHandshakeMappings: *ref_36
    tlsSessionResumptionDisableResponse: *ref_190
    tlsSessionResumptionDisable: *ref_191
    enable: *ref_15
    disable: *ref_37
    defaultCLIAccessToOSAdmins: *ref_192
    cliSessionMaxExpiryInSec: *ref_193
    mfaPostConfigurationSettings: *ref_194
    mfaGetConfigurationSettings: *ref_195
    hashAlgorithm: *ref_196
    otpLength: *ref_197
    randomBits: *ref_198
    auditRetentionPeriodInDays: *ref_42
    postCreateTokenRequest: *ref_199
    tokenType: *ref_58
    postCreateTokenResponse: *ref_200
    getTokenResponse: *ref_59
    getTokenDataList: *ref_201
    getTokenData: *ref_60
    postDeleteTokenRequest: *ref_61
    secCredDef: *ref_202
    credIsSetResponse: *ref_203
    getServerTimeResponse: *ref_204
    getServerInfoResponse: *ref_205
    apiKeyCreationRequest: *ref_206
    apiKeyCreationResponse: *ref_65
    apiKeyUpdateRequest: *ref_207
    apiKeyReissueRequest: *ref_208
    apiKeyRevokeRequest: *ref_209
    getAPIKeyDetails: *ref_210
    getAllAPIKeyDetails: *ref_211
    apiKeyDetails: *ref_64
    externalCACertDetail: *ref_212
    externalCACertDetails: *ref_66
    caCertData: *ref_67
    postCaCertErrorResponse: *ref_213
    fileUploadErrors: *ref_214
    linkObject: *ref_215
    postNBCAMigrationRequest: *ref_216
    postMigrationSetupNewCAResponse: *ref_217
    getNBCAResponse: *ref_218
    getAllNBCAResponse: *ref_219
    nbcaDetails: *ref_68
    getTrustVersionData: *ref_220
    getMigrationSummaryResponse: *ref_221
    associatedNbcaDetails: *ref_69
    nbcaFingerprintIdentifierObject: *ref_222
    getAllTrustVersionsResponse: *ref_223
    singleTrustVersionDetailsResponse: *ref_224
    getHostsPendingTrustPropagation: *ref_225
    hostPendingTrustPropagation: *ref_226
    configIdpDatabaseRequest: *ref_227
    createServicePrincipalRequest: *ref_228
    configIdpDatabaseResponse: *ref_229
    configIdpDatabaseResponseDefinition: *ref_230
    updateIdpDatabaseRequest: *ref_231
    getAllIdpDatabaseResponse: *ref_232
    getIdpDatabaseResponse: *ref_233
    getIdpDatabaseResponseDefinition: *ref_71
    createServicePrincipalResponse: *ref_234
    servicePrincipalConfigResponse: *ref_235
    getAllServicePrincipalsResponse: *ref_236
    getServicePrincipalResponse: *ref_237
    getServicePrincipalResponseDefinition: *ref_77
    servicePrincipalDetails:
      type: object
      description: The configuration details of the service principal.
      properties: *ref_238
      required: *ref_239
    accessDefinition: *ref_240
    servicePrincipalRelationships: *ref_76
    servicePrincipalApikeyResourceIdentifierObject: *ref_241
    servicePrincipalRoleResourceIdentifierObject: *ref_242
    nbcaMigrationActivateRequest: *ref_243
    nbcaMigrationCompleteRequest: *ref_244
    setPassphraseConstraintsRequest: *ref_245
    getAllPassphraseConstraintsResponse: *ref_246
    getPassphraseConstraintsResponse: *ref_247
    workflowTypeEnum: *ref_72
    passphraseConstraints: *ref_73
    validatePassphraseRequest: *ref_248
    postGenerateNBCASAMLRequest: *ref_249
    postGenerateExternalSAMLRequest: *ref_250
    postGenerateECASAMLRequest: *ref_251
    postGenerateECASAMLRequestKeystoreDetails: *ref_252
    anomalyConfigurationResponse: *ref_75
    anomalyConfigurationRequest: *ref_253
    anomalyConfigurationPatchRequest: *ref_254
    anomalyConfigurationPatchResponse: *ref_255
    anomalyconfigObj: *ref_74
    getAnomalyResponse: *ref_256
    getAnomalyDetailsResponse: *ref_257
    postAnomalyRequest:
      type: object
      required:
        - data
      properties:
        data:
          type: object
          required:
            - id
            - type
            - attributes
          description: The data specific to an anomaly.
          properties:
            type:
              type: string
              enum:
                - anomaly
            id:
              type: string
            attributes: *ref_258
    postBulkAnomalyRequest:
      type: object
      required:
        - data
      properties:
        data:
          type: array
          description: Details of a specific anomaly.
          items:
            type: object
            required:
              - id
              - type
              - attributes
            properties:
              type:
                type: string
                enum:
                  - anomaly
              id:
                type: string
              attributes: *ref_258
    anomalyPatchRequest: *ref_259
    anomalyAttributes: *ref_258
    anomalyExtensionAttributes: *ref_82
    anomalyPatchAttributes: *ref_78
    anomalyExtensionDetailAttributes: *ref_81
    anomalyExtensionDetailPatchRequestAttributes: &ref_281
      type: object
      properties:
        isEnabled:
          type: boolean
          description: The flag to identify whether user has enabled extension or not.
        isPrimaryOnly:
          type: boolean
          description: The flag to identify whether extension is for primary server or not.
        executedOnPlatform:
          type: string
          description: An enum to identify extension is running on which platform.
          enum:
            - PRIMARY_SERVER
            - MEDIA_SERVER
        executedOnHostName:
          type: string
          description: The host name of the server where extension is running.
        configuration:
          type: object
          description: The configuration of the existing extension.
    anomalyExtensionConfigurationAttributes: *ref_260
    anomalyExtensionConfigurationTemplateAttributes: *ref_261
    anomalyPatchResponse: *ref_262
    postAnomalyResponse:
      type: object
      required:
        - data
      properties:
        data:
          type: object
          required:
            - type
            - attributes
            - id
          description: The data specific to an anomaly.
          properties:
            type:
              type: string
              enum:
                - anomaly
            id:
              type: string
            attributes: *ref_258
    anomalySupportedFeatures:
      type: object
      required:
        - data
      properties:
        data:
          type: object
          required:
            - type
            - id
            - attributes
          properties:
            type:
              type: string
            id:
              type: string
            attributes:
              type: object
              properties:
                features:
                  type: array
                  items:
                    type: object
                    required:
                      - displayName
                      - value
                    properties:
                      displayName:
                        type: string
                        description: Feature for which anomaly detection works
                      value:
                        type: string
                        description: Value of the anomaly feature
    anomalyTelemetryData:
      type: object
      required:
        - data
      properties:
        data:
          type: object
          required:
            - type
            - id
            - attributes
          properties:
            type:
              type: string
              enum:
                - anomalyTelemetryData
            id:
              type: string
            attributes:
              type: object
              properties:
                highScoreAnomalies:
                  type: integer
                  default: 0
                  description: |
                    Total number of high score anomalies detected on a server.
                lowScoreAnomalies:
                  type: integer
                  default: 0
                  description: |
                    Total number of low score anomalies detected on a server.
                mediumScoreAnomalies:
                  type: integer
                  default: 0
                  description: |
                    Total number of medium score anomalies detected on a server.
                anomaliesNotReviewed:
                  type: integer
                  default: 0
                  description: |
                    Total number of not reviewed anomalies detected on a server.
                anomaliesFalsePositive:
                  type: integer
                  default: 0
                  description: >
                    Total number of false positive anomalies detected on a
                    server.
                anomaliesConfirmed:
                  type: integer
                  default: 0
                  description: |
                    Total number of confirmed anomalies detected on a server.
                anomaliesIgnored:
                  type: integer
                  default: 0
                  description: |
                    Total number of ignored anomalies detected on a server.
                anomaliesPerPolicy:
                  type: array
                  description: >
                    Count of anomalies based on severity and review status for a
                    given policy type.
                  items:
                    type: object
                    properties:
                      policyType:
                        type: integer
                        description: |
                          Policy type in integer format.
                      highScoreAnomalies:
                        type: integer
                        default: 0
                        description: >
                          Total number of high score anomalies detected per
                          policy.
                      lowScoreAnomalies:
                        type: integer
                        default: 0
                        description: >
                          Total number of low score anomalies detected per
                          policy.
                      mediumScoreAnomalies:
                        type: integer
                        default: 0
                        description: >
                          Total number of medium score anomalies detected per
                          policy.
                      anomaliesNotReviewed:
                        type: integer
                        default: 0
                        description: >
                          Total number of not reviewed anomalies detected per
                          policy.
                      anomaliesFalsePositive:
                        type: integer
                        default: 0
                        description: >
                          Total number of false positive anomalies detected per
                          policy.
                      anomaliesConfirmed:
                        type: integer
                        default: 0
                        description: >
                          Total number of confirmed anomalies detected per
                          policy.
                      anomaliesIgnored:
                        type: integer
                        default: 0
                        description: |
                          Total number of ignored anomalies detected per policy.
    anomalyImageEntropyPublishPostRequest:
      type: object
      required:
        - data
      properties:
        data:
          type: object
          required:
            - type
            - attributes
          properties:
            type:
              description: The request type.
              type: string
              enum:
                - anomalyImageEntropyPublishPostRequest
            attributes: &ref_263
              type: object
              required:
                - jobId
                - scheduleType
                - clientName
                - policyName
                - policyType
                - backupId
                - startTime
                - endTime
                - imageBytes
                - acceleratorBytes
                - entropyAverage
              properties:
                jobId:
                  description: The job identifier.
                  type: string
                scheduleType:
                  description: The backup job schedule type.
                  type: string
                clientName:
                  description: The client name.
                  type: string
                policyName:
                  description: The policy name.
                  type: string
                policyType:
                  description: The policy type.
                  type: string
                backupId:
                  description: The backup image identifier.
                  type: string
                startTime:
                  description: The backup start time of image in Epoch of UTC.
                  type: string
                endTime:
                  description: The backup end time of image in Epoch of UTC.
                  type: string
                imageBytes:
                  description: The size of backup image in bytes.
                  type: string
                acceleratorBytes:
                  description: The size of accelerator enabled backup image in bytes.
                  type: string
                entropyAverage:
                  description: The average entropy value of backup image.
                  type: string
            links:
              type: object
              properties:
                self:
                  type: object
                  properties:
                    href:
                      type: string
    anomalyImageEntropyAttributes: *ref_263
    anomalyBackupPolicyMetadataPublishPostRequest:
      type: object
      required:
        - data
      properties:
        data:
          type: object
          required:
            - type
            - attributes
          properties:
            type:
              description: The request type.
              type: string
              enum:
                - anomalyBackupPolicyMetadataPublishPostRequest
            attributes: &ref_264
              type: object
              required:
                - jobId
                - scheduleType
                - clientName
                - policyName
                - policyType
                - backupId
                - startTime
                - endTime
                - imageBytes
                - acceleratorBytes
                - entropyAverage
                - flistHash
              properties:
                jobId:
                  description: The job identifier.
                  type: string
                scheduleType:
                  description: The backup job schedule type.
                  type: string
                clientName:
                  description: The client name.
                  type: string
                policyName:
                  description: The policy name.
                  type: string
                policyType:
                  description: The policy type.
                  type: string
                backupId:
                  description: The backup image identifier.
                  type: string
                startTime:
                  description: The backup start time of image in Epoch of UTC.
                  type: string
                endTime:
                  description: The backup end time of image in Epoch of UTC.
                  type: string
                imageBytes:
                  description: The size of backup image in bytes.
                  type: string
                acceleratorBytes:
                  description: The size of accelerator enabled backup image in bytes.
                  type: string
                entropyAverage:
                  description: The KL-Divergence of the latest backup image.
                  type: string
                flistHash:
                  description: Hash of the file list in the stream
                  type: string
                backupSelection:
                  description: backupSelection for the stream
                  type: string
                entropyMu:
                  description: Average of KL-divergence values of the backup images.
                  type: string
                entropySigma:
                  description: >-
                    Standard deviation of KL-divergence values of the backup
                    images.
                  type: string
                modelFlag:
                  description: The flag for the machine learning model.
                  type: string
                anomalyDetails:
                  description: The additional message when an anomaly is detected.
                  type: string
                baselineHistograms:
                  description: |
                    The baseline histograms.
                    - fileAtimeHistogram
                    - fileCtimeHistogram
                    - fileMtimeHistogram
                    - fileExtensionHistogram
                    - filePermissionHistogram
                    - fileSizeHistogram
                  type: string
    anomalyBackupPolicyMetadataPublishAttributes: *ref_264
    anomalyBackupPolicyMetadataPostRequest:
      type: object
      required:
        - data
      properties:
        data:
          type: object
          required:
            - type
            - attributes
          properties:
            type:
              description: The request type.
              type: string
              enum:
                - anomalyBackupPolicyMetadataPostRequest
            attributes:
              allOf:
                - &ref_265
                  type: object
                  properties:
                    clientName:
                      description: The client name.
                      type: string
                    policyName:
                      description: The policy name.
                      type: string
                    flistHash:
                      description: Hash of the file list in the stream
                      type: string
                    backupSelection:
                      description: backupSelection for the stream
                      type: string
                    policyType:
                      description: The policy type.
                      type: string
                    modelFlag:
                      description: The flag for the machine learning model.
                      type: number
                    modelParameters:
                      description: >-
                        The additional attributes for the machine learning
                        model.
                      type: string
                    updatedOn:
                      description: >-
                        The ISO 8601 formatted time when this record was last
                        updated.
                      type: string
                      format: date-time
              required:
                - clientName
                - policyName
                - flistHash
                - policyType
                - modelFlag
                - modelParameters
    anomalyBackupPolicyMetadataPostResponse:
      type: object
      required:
        - data
      properties:
        data:
          type: object
          required:
            - type
            - id
            - attributes
          properties:
            type:
              description: The response type.
              type: string
              enum:
                - anomalyBackupPolicyMetadataPostResponse
            id:
              description: The record identifier.
              type: string
            attributes:
              type: object
              required:
                - recordId
              properties:
                recordId:
                  description: The record identifier.
                  type: string
    anomalyBackupPolicyMetadataGetResponse:
      type: object
      required:
        - data
      properties:
        data:
          type: object
          required:
            - type
            - id
            - attributes
          properties:
            type:
              description: The response type.
              type: string
              enum:
                - anomalyBackupPolicyMetadataGetResponse
            id:
              description: The record identifier.
              type: string
            attributes:
              allOf:
                - *ref_265
              required:
                - clientName
                - policyName
                - flistHash
                - policyType
                - modelFlag
                - modelParameters
                - updatedOn
    anomalyBackupPolicyMetadataPatchRequest:
      type: object
      required:
        - data
      properties:
        data:
          type: object
          required:
            - type
            - attributes
          properties:
            type:
              description: The request type.
              type: string
              enum:
                - anomalyBackupPolicyMetadataPatchRequest
            attributes: *ref_265
    anomalyBackupPolicyMetadataAttributes: *ref_265
    anomalyFeedbackPatchRequest: *ref_266
    anomalyFeedbackAttributes: *ref_267
    anomalyBackupPolicyMetadataRemovePostRequest:
      type: object
      required:
        - data
      properties:
        data:
          type: object
          required:
            - type
            - attributes
          properties:
            type:
              description: The request type.
              type: string
              enum:
                - anomalyBackupPolicyMetadataRemovePostRequest
            attributes: &ref_268
              type: object
              oneOf:
                - properties:
                    policyName:
                      description: The policy name.
                      type: string
                - properties:
                    daysPast:
                      description: >-
                        The number of days had passed since a record was
                        updated.
                      type: string
    anomalyBackupPolicyMetadataRemoveAttributes: *ref_268
    anomalyRulesAttributes: *ref_86
    anomalyRulesPatchAttributes: *ref_269
    anomalyRulesArrayResponse: *ref_270
    getAnomalyRulesResponse: *ref_271
    anomalyRulesPatchRequest: *ref_272
    anomalyRulesResponse: *ref_273
    anomalyResultAttributes: &ref_274
      type: object
      required:
        - ruleId
        - version
        - resultDescription
        - executionTime
        - createdDateTime
        - extendedAttributes
      properties:
        ruleId:
          type: string
          description: The ruleId of anomaly result.
        version:
          type: integer
          description: The version of anomaly result.
        resultDescription:
          type: string
          description: The result description of the anomaly result.
          enum:
            - IMPACTED
            - NOT_IMPACTED
        executionTime:
          type: string
          format: date-time
          description: >-
            The ISO 8601 formatted time. The timestamp of the anomaly result was
            executed.
        createdDateTime:
          type: string
          format: date-time
          description: >-
            The ISO 8601 formatted time. The timestamp of the anomaly result was
            created.
        extendedAttributes:
          type: object
          description: >-
            The additional attributes for generated anomaly result. It is of
            type KEY-VALUE pair.
    anomalyResultsArrayResponse:
      type: object
      required:
        - links
        - data
        - meta
      properties:
        links: *ref_54
        data:
          type: array
          items: &ref_275
            type: object
            required:
              - type
              - id
            description: The data specific to an anomaly result.
            properties:
              type:
                type: string
                enum:
                  - ruleExecutionResult
              id:
                type: string
              attributes: *ref_274
        meta:
          type: object
          properties:
            pagination: *ref_55
    getAnomalyResultResponse: *ref_275
    anomalyResultRequest:
      type: object
      required:
        - data
      properties:
        data:
          type: object
          required:
            - type
            - attributes
            - id
          description: The data specific to an anomaly result.
          properties:
            type:
              type: string
              enum:
                - ruleExecutionResult
            id:
              type: string
            attributes: *ref_274
    anomalyResultResponse:
      type: object
      required:
        - data
      properties:
        data:
          type: object
          required:
            - type
            - attributes
            - id
          description: The data specific to an anomaly result.
          properties:
            type:
              type: string
              enum:
                - ruleExecutionResult
            id:
              type: string
            attributes:
              allOf:
                - *ref_274
                - type: object
    anomalyExtensionRequest: *ref_276
    anomalyExtensionResponse: *ref_277
    getAnomalyFileExtensionArrayResponse:
      type: object
      required:
        - links
        - data
        - meta
      properties:
        links: *ref_54
        data:
          type: array
          items: &ref_278
            type: object
            required:
              - type
              - id
            description: The data specific to an anomaly.
            properties:
              type:
                type: string
                enum:
                  - anomalyFileExtension
              id:
                type: string
              attributes: &ref_279
                type: object
                required:
                  - jobId
                  - ransomwareExtensions
                properties:
                  jobId:
                    type: integer
                    description: The jobId of anomaly file extension.
                  ransomwareExtensions:
                    type: object
                    description: An object mapping ransomware file extensions to counts.
        meta:
          type: object
          properties:
            pagination: *ref_55
    getAnomalyFileExtensionResponse: *ref_278
    anomalyFileExtensionRequest:
      description: The data specific to a ransomware file extension against a job id.
      type: object
      required:
        - data
      properties:
        data:
          type: object
          properties:
            type:
              type: string
              enum:
                - anomalyFileExtension
            attributes: *ref_279
    anomalyFileExtensionResponse:
      type: object
      required:
        - data
      properties:
        data:
          type: object
          required:
            - type
            - attributes
            - id
          description: The data specific to a ransomware file extension against a job id.
          properties:
            type:
              type: string
              enum:
                - anomalyFileExtension
            id:
              type: string
            attributes:
              allOf:
                - *ref_279
                - type: object
    anomalyFileExtensionAttributes: *ref_279
    anomalyExtensionArrayResponse: *ref_280
    anomalyExtensionDetailRequest:
      type: object
      required:
        - data
      properties:
        data:
          type: object
          required:
            - type
            - attributes
            - id
          description: The data specific to an extension.
          properties:
            type:
              type: string
              enum:
                - anomalyExtensionDetailDto
            id:
              type: string
            attributes: *ref_81
    anomalyExtensionDetailPatchRequest:
      type: object
      required:
        - data
      properties:
        data:
          type: object
          required:
            - type
            - attributes
            - id
          description: The data specific to an extension.
          properties:
            type:
              type: string
              enum:
                - anomalyExtensionDetailPatchRequest
            id:
              type: string
            attributes: *ref_281
    anomalyExtensionDetailResponse: *ref_282
    anomalyExtensionDetailArrayResponse: *ref_283
    anomalyExtensionConfigurationRequest:
      type: object
      required:
        - data
      properties:
        data:
          type: object
          required:
            - type
            - attributes
            - id
          description: The data specific to an extension configuration.
          properties:
            type:
              type: string
              enum:
                - anomalyExtensionConfiguration
            id:
              type: string
            attributes: *ref_260
    anomalyExtensionConfigurationTemplateRequest:
      type: object
      required:
        - data
      properties:
        data:
          type: object
          required:
            - type
            - attributes
            - id
          description: The data specific to an extension configuration template.
          properties:
            type:
              type: string
              enum:
                - anomalyExtensionConfigurationTemplate
            id:
              type: string
            attributes: *ref_261
    anomalyExtensionConfigurationTemplateResponse: *ref_284
    anomalyExtensionConfigurationResponse: *ref_285
    exportNBCADataRequest:
      type: object
      description: Export the NetBackup CA artifacts to a file.
      properties:
        data:
          type: object
          required:
            - type
            - attributes
          properties:
            type:
              type: string
              enum:
                - exportNBCADataRequest
            attributes:
              type: object
              properties:
                fileLocation:
                  type: string
                  description: The path of the file accessible to the NetBackup CA.
              required:
                - fileLocation
      required:
        - data
    siemToolConfigRequest: *ref_286
    siemToolConfig: *ref_84
    siemToolConfigResponse: *ref_287
    siemToolConfigListResponse: *ref_288
    auditCategoryConfiguration: *ref_85
    cloudProviderEnum: *ref_83
    rateLimitRequest: *ref_96
    rateLimitConfigResponse: *ref_95
    rateLimitConfigResources: *ref_289
    rateLimitConfig: *ref_94
    mfaTOTPDeleteRequest: *ref_290
    mfaStatusResponse: *ref_291
    mfaTOTPRequest: *ref_292
    mfaTOTPResponse: *ref_293
    mfaOTPValidateRequest: *ref_294
    mfaOTPValidateResponse:
      type: object
      properties:
        data:
          type: object
          required:
            - type
            - id
            - attributes
          properties:
            id:
              type: string
            type:
              type: string
              enum:
                - mfaOTPValidateResponse
            attributes:
              type: object
              properties:
                isOTPValid:
                  type: boolean
                  description: Returns OTP code validation status.
              required:
                - isOTPValid
      required:
        - data
    mfaTokenRequest:
      type: object
      properties:
        data:
          type: object
          required:
            - type
            - attributes
          properties:
            type:
              type: string
              enum:
                - mfaTokenRequest
            attributes:
              type: object
              properties:
                userIdentifier:
                  type: string
                  description: >
                    The user identifier must be in the following format:
                    domainName:userName:domainType:userId
      required:
        - data
    mfaTokenResponse:
      type: object
      properties:
        data:
          type: object
          required:
            - type
            - id
            - attributes
          properties:
            id:
              type: string
            type:
              type: string
              enum:
                - mfaTokenResponse
            attributes:
              type: object
              properties:
                token:
                  type: string
              required:
                - token
      required:
        - data
    mfaUsersResponse: *ref_295
    anomalyExtensionType: *ref_296
    getWebCertificateResponse:
      type: object
      properties:
        data:
          type: array
          items:
            type: object
            enum:
              - webCertificates
            properties:
              type:
                type: string
                description: The type of the response.
              id:
                type: string
                description: 'Certificate ID (1:NBCA, 2:ECAAPP, 3:ECAWEB)'
                enum:
                  - 1
                  - 2
                  - 3
              attributes:
                type: object
                properties:
                  certChainDetails:
                    type: array
                    items:
                      type: object
                      properties:
                        webserverCertType:
                          type: string
                          description: >-
                            Type of webserver certificate NBCA / ECAWEB /
                            ECAAPP.
                          enum:
                            - NBCA
                            - ECAWEB
                            - ECAAPP
                        level:
                          type: string
                          description: >-
                            Level in certificate chain Leaf Certificate /
                            Intermediate CA / Root CA.
                          enum:
                            - LEAF_CERTIFICATE
                            - INTERMEDIATE_CA
                            - ROOT_CA
                        notBefore:
                          type: string
                          format: date-time
                          description: >-
                            Retrieves the date and time when the certificate
                            becomes valid. ISO 8601 (UTC) is the format of this
                            field.
                        notAfter:
                          type: string
                          format: date-time
                          description: >-
                            Retrieves the date and time when the certificate
                            becomes invalid. ISO 8601 (UTC) is the format of
                            this field.
                        subjectName:
                          type: string
                          description: Subject name of the certificate.
                        fingerprint:
                          type: object
                          description: of SHA-1 and SHA-256 fingerprint.
                          properties:
                            SHA-1:
                              type: string
                              description: Identifier of the certificate in SHA-1.
                            SHA-256:
                              type: string
                              description: Identifier of the certificate in SHA-256.
                        issuedBy:
                          type: string
                          description: Name of the issuer of the certificate.
                        subjectAlternativeNames:
                          type: array
                          items:
                            type: string
                            description: Array of alternative subject names.
                        expiryUnixTime:
                          type: integer
                          format: int64
                          description: >-
                            Retrieves the date and time when the certificate
                            becomes invalid. The number of milliseconds since
                            the Epoch, 1970-01-01 00:00:00 +0000.
                        serialNumber: *ref_7
                        expiryDate:
                          type: string
                          format: date-time
                          description: >-
                            Retrieves the date and time when the certificate
                            becomes invalid in GMT Time format.
                        keyStrength:
                          type: integer
                          description: Certificate encoding key strength.
      required:
        - data
      example:
        data:
          - type: webCertificates
            id: 2
            attributes:
              certChainDetails:
                - type: ECAAPP
                  level: Leaf Certificate
                  notBefore: 2023-08-18T03:38:39.000Z
                  notAfter: 2043-08-13T04:53:39.000Z
                  subjectName: subjectName
                  fingerprint:
                    SHA-1: SHA 1 Fingerprint
                    SHA-256: SHA 256 Fingerprint
                  issuedBy: issued by
                  subjectAlternativeNames:
                    - subjectAlternativeName
                  expiredUnixTime: 1723870677
                  serialNumber: 1234
                  expiredDate: 'Aug 17 04:57:57 2024 GMT'
                  keyStrength: 2048
                - type: ECAAPP
                  level: Intermediate CA
                  notBefore: 2024-02-14T11:13:03.000Z
                  notAfter: 2025-02-18T11:13:03.000Z
                  subjectName: subjectName
                  fingerprint:
                    SHA-1: SHA 1 Fingerprint
                    SHA-256: SHA 256 Fingerprint
                  issuedBy: issued by
                  subjectAlternativeNames:
                    - subjectAlternativeName
                  expiredUnixTime: 1723870677
                  serialNumber: 1234
                  expiredDate: 'Aug 17 04:57:57 2024 GMT'
                  keyStrength: 2048
                - type: ECAAPP
                  level: Root CA
                  notBefore: 2024-02-14T11:13:03.000Z
                  notAfter: 2025-02-18T11:13:03.000Z
                  subjectName: subjectName
                  fingerprint:
                    SHA-1: SHA 1 Fingerprint
                    SHA-256: SHA 256 Fingerprint
                  issuedBy: issued by
                  subjectAlternativeNames:
                    - subjectAlternativeName
                  expiredUnixTime: 1723870677
                  serialNumber: 1234
                  expiredDate: 'Aug 17 04:57:57 2024 GMT'
                  keyStrength: 2048
    anomalyBulkUpdateRequest: *ref_297
    anomalyExtensionBulkUpdateRequest: *ref_298
    bulkAnomalyPatchRequest: *ref_299
    bulkAnomalyExtensionPatchRequest: *ref_300
    anomalyExtensionPatchAttributes: *ref_301
    anomalyAggregateArrayResponse: *ref_302
    anomalyAggregateBulkUpdateRequest: *ref_303
    bulkAnomalyAggregatePatchRequest: *ref_304
    anomalyAggregatePatchAttributes: *ref_305
    singleAggregateAnomalyPatchRequest: *ref_306
    singleAggregateAnomalyPatchAttributes: *ref_307
    anomalyAggregateRequest:
      type: object
      required:
        - data
      properties:
        data:
          type: object
          required:
            - type
            - attributes
            - id
          description: The data specific to an aggregate anomaly.
          properties:
            type:
              type: string
              enum:
                - anomalyAggregate
            id:
              type: string
            attributes: *ref_101
    anomalyAggregateResponse: *ref_308
    anomalyAggregateAttributes: *ref_101
    vxatConfProperties:
      type: object
      description: >-
        Update the configuration of Veritas NetBackup Authentication Service
        (AT).
      properties:
        data:
          type: object
          required:
            - type
            - id
            - attributes
          properties:
            type:
              type: string
              enum:
                - vxatConfProperties
            id:
              type: string
              enum:
                - vxatConfProperties
            attributes:
              type: object
              properties:
                disableTLSProtocol:
                  type: string
                  description: >-
                    User can disable specific version of the TLS protocol for
                    Veritas NetBackup Authentication Service (AT)
                    communications.
                enableFipsMode:
                  type: boolean
                  description: >-
                    User can configure FIPS mode for Veritas NetBackup
                    Authentication Service (AT).
      required:
        - data
    domainConfigurations:
      type: object
      description: Update the domain configuration settings.
      properties:
        data:
          type: object
          required:
            - type
            - id
            - attributes
          properties:
            type:
              type: string
              enum:
                - domainConfigurations
            id:
              description: The name of the domain.
              type: string
            attributes:
              type: object
              properties:
                ldapDomain:
                  type: object
                  properties:
                    disableTLSProtocol:
                      type: string
                      description: >
                        Disables the specified and all the earlier versions of
                        the TLS protocol for LDAP server and Veritas NetBackup
                        Authentication Service (AT) communications.
                    cipherSuiteList:
                      description: >-
                        List of TLS cipher suites to be used for the given LDAP
                        server and Veritas NetBackup Authentication Service (AT)
                        communications.
                      type: array
                      items:
                        type: string
      required:
        - data
    userDefinedExtensionChecklistRequest: *ref_309
    userDefinedExtensionChecklistResponse: *ref_103
    userDefinedExtension: *ref_102
    systemDefinedExtensionChecklistRequest:
      type: object
      required:
        - data
      properties:
        data:
          type: object
          required:
            - type
            - attributes
          properties:
            type:
              type: string
              enum:
                - systemDefinedExtensionChecklistRequest
            attributes:
              type: object
              properties:
                systemDefinedExtensions:
                  type: array
                  description: It is a system defined list of ransomware extension names.
                  example:
                    - lockbit
    systemDefinedExtensionChecklistResponse: *ref_310
    userDefinedExtensionChecklistPatchRequest: *ref_311
    executeTicketsRequest: *ref_312
    executeTicketsResponse: *ref_313
    extensionChecklistResponse: *ref_314
    ransomwareFilesResponse:
      type: object
      required:
        - data
        - meta
      properties:
        data:
          type: object
          required:
            - type
            - id
            - attributes
          properties:
            type:
              type: string
              enum:
                - ransomwareFilesResponse
            id:
              type: string
            attributes:
              type: object
              properties:
                file:
                  type: string
                  description: File path of given file extension.
                clientName:
                  type: string
                  description: Name of the client associated with file paths.
                name:
                  description: The name of the file.
                  type: string
                backupTime:
                  type: string
                  format: date-time
                  description: >-
                    The ISO 8601 timestamp that indicates when the file record
                    was backed up.
        meta:
          type: object
          properties:
            pagination: *ref_55
security:
  - apiKeyAuth: []
  - cookieAuth: []
  - jwtAuth: []
