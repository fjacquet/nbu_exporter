openapi: 3.0.0
info:
  title: NetBackup Malware API
  version: '13.0'
  description: >
    The NetBackup Malware detection API provides ability to configure malware
    scan hosts and scan pool, perform on demand scans, and capture the scan
    results.
externalDocs:
  description: Getting Started Guide
  url: >-
    http://sort.veritas.com/public/documents/nbu/11.0/windowsandunix/productguides/html/getting-started/
servers:
  - url: 'https://<masterserver>:1556/netbackup'
    description: NetBackup Master
paths:
  /malware/scan-hosts:
    post:
      description: >
        Configures the malware scan host in NetBackup.


        Note: If multi-factor authorization is enabled for this operation, the
        response returns an HTTP 202 status code. The ticket link

        is mentioned in the location header of the HTTP response, and the ticket
        ID is provided in the X-NetBackup-MPA-Ticket header.

        For more information, refer to the [multi-person
        authorization](http://sort.veritas.com/public/documents/nbu/11.0/windowsandunix/productguides/html/getting-started#user-content-multi-person-authorization)
        documentation.


        **API Versioned:**\

        A breaking change has been made to this API starting with version 11.0.
        Requests made using the previous format will fail.\

        See the [Getting Started
        Guide](http://sort.veritas.com/public/documents/nbu/11.0/windowsandunix/productguides/html/getting-started)
        for full details on what has changed and general information about API
        versioning.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/11.0/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|MANAGE|MALWARE|SCAN-HOST|`\

        Requires Operation: `|OPERATIONS|ADD|`
      tags:
        - Scan Host
      requestBody:
        content:
          application/vnd.netbackup+json;version=13.0:
            schema: &ref_39
              description: >-
                The request body that contains the parameters used to create the
                scan host.
              type: object
              required:
                - data
              properties:
                data:
                  type: object
                  properties:
                    type:
                      type: string
                      description: The resource type for the scan host configuration.
                      enum:
                        - createScanHost
                    attributes:
                      type: object
                      required:
                        - hostName
                        - state
                      properties:
                        hostName:
                          type: string
                          description: The unique FQDN name of the scan host.
                        maxNoOfParallelScans:
                          type: integer
                          description: Specifies the number of parallel scans.
                        state:
                          type: string
                          description: It indicates the state of the scan host.
                          enum:
                            - ACTIVE
                            - INACTIVE
                        scanHostCredentialName:
                          type: string
                          description: >-
                            Shows the scan host credential name for the scan
                            host.
                        mediaServerName:
                          type: string
                          description: >-
                            The unique FQDN name of the media server to perform
                            validate operation.
                        scanHostType:
                          type: string
                          description: >-
                            If MALWARE_SCAN_HOST is selected, then scan host
                            with no NetBackup entity can be added to the pool.If
                            NBU_SCAN_HOST is selected, then NetBackup client can
                            be added as scan host in the pool.
                          enum:
                            - MALWARE_SCAN_HOST
                            - NBU_SCAN_HOST
                          default: MALWARE_SCAN_HOST
                    relationships:
                      type: object
                      properties:
                        malwareTool:
                          type: object
                          properties:
                            data: &ref_0
                              type: object
                              required:
                                - id
                                - type
                              properties:
                                type:
                                  type: string
                                  enum:
                                    - malwareTool
                                id:
                                  type: string
                        scanHostPool:
                          type: object
                          properties:
                            data: &ref_1
                              type: object
                              required:
                                - id
                                - type
                              properties:
                                type:
                                  type: string
                                  enum:
                                    - scanHostPool
                                id:
                                  type: string
                  required:
                    - type
                    - attributes
                    - relationships
        description: The configuration details for the scan host.
        required: true
      responses:
        '201':
          description: Successfully configured the scan host.
          headers:
            Location:
              description: The link to a newly created scan host configuration.
              schema:
                type: string
          content:
            application/vnd.netbackup+json;version=13.0:
              schema: &ref_30
                type: object
                properties:
                  data: &ref_34
                    description: The response returned the scan host configuration.
                    type: object
                    required:
                      - type
                      - id
                      - attributes
                      - relationships
                    properties:
                      links:
                        type: object
                      type:
                        description: The scan host creation response.
                        type: string
                        enum:
                          - scanHost
                      id:
                        type: string
                        description: >-
                          The scan host id. This is a unique id mapped per Scan
                          host configuration.
                      attributes:
                        description: >-
                          The attributes of the scan host configuration creation
                          response.
                        type: object
                        required:
                          - hostName
                          - state
                        properties:
                          hostName:
                            type: string
                            description: The unique name of the scan host.
                          maxNoOfParallelScans:
                            type: integer
                            description: Specifies the number of parallel scans.
                          state:
                            type: string
                            description: >-
                              It indicate state of the scan Host if it is active
                              or not.
                            enum:
                              - ACTIVE
                              - INACTIVE
                          scanHostCredentialName:
                            type: string
                            description: Shows the credential name for the scan host.
                          configInfo:
                            type: object
                            description: >-
                              The information retrieved from the scan host
                              during validation. It contains the Id of the user
                              provided while adding scan host.
                            properties:
                              userId:
                                type: string
                                description: >-
                                  User Id of the user used for validation
                                  fetched from the host.
                          scanHostType:
                            type: string
                            description: >-
                              If MALWARE_SCAN_HOST is selected, then scan host
                              with no NetBackup entity can be added to the pool.
                              If NBU_SCAN_HOST is selected, then NetBackup
                              client can be added as scan host in the pool.
                            enum:
                              - MALWARE_SCAN_HOST
                              - NBU_SCAN_HOST
                            default: MALWARE_SCAN_HOST
                      relationships:
                        type: object
                        properties:
                          malwareTool: &ref_37
                            type: object
                            description: The malware tool.
                            properties:
                              links:
                                type: object
                                properties:
                                  related:
                                    type: object
                                    properties:
                                      href:
                                        type: string
                              data: *ref_0
                            required:
                              - data
                              - links
                          scanHostPool: &ref_38
                            type: object
                            description: The scan host pool.
                            properties:
                              links:
                                type: object
                                properties:
                                  related:
                                    type: object
                                    properties:
                                      href:
                                        type: string
                              data: *ref_1
                            required:
                              - data
                              - links
                required:
                  - data
        '202':
          description: >-
            The request was successfully received by the server and is awaiting
            MPA approval.
          headers:
            X-NetBackup-MPA-Ticket:
              description: >-
                The ticket ID of newly-generated multi-person authorization
                ticket.
              schema:
                type: string
            Location:
              description: >-
                The link to the newly-generated multi-person authorization
                ticket.
              schema:
                type: string
        '400': &ref_3
          description: Bad request.
          content:
            application/vnd.netbackup+json;version=13.0:
              schema: &ref_2
                type: object
                properties:
                  errorCode:
                    type: integer
                    format: int64
                    description: The NetBackup error code.
                  errorMessage:
                    type: string
                    description: The NetBackup error code description.
                  attributeErrors:
                    type: object
                    description: >
                      Maps the attributes with the invalid values to an error
                      that describes why the value is invalid, to provide more
                      context to the nature of the error.
                  errorDetails:
                    type: array
                    description: >-
                      A list that contains additional information about the
                      error.
                    items:
                      type: string
                  fileUploadErrors:
                    type: array
                    description: >
                      If an API is supporting content-type multipart/form-data,
                      then this holds a list of objects that contains names of
                      failed files and associated error messages.
                    items:
                      type: object
                required:
                  - errorCode
                  - errorMessage
        '401': &ref_4
          description: >
            The `Authorization` header is missing, the token is invalid, or you
            do not have permission for this action.
          content:
            application/vnd.netbackup+json;version=13.0:
              schema: *ref_2
        '406': &ref_5
          description: >-
            Invalid `Accept` type. Make sure your `Accept` header matches what
            this API produces.
          content:
            application/vnd.netbackup+json;version=13.0:
              schema: *ref_2
        '409':
          description: The specified scan host is already configured.
          content:
            application/vnd.netbackup+json;version=13.0:
              schema: *ref_2
        '415': &ref_9
          description: >
            Unsupported Media Type. The media type specified in the
            `Content-Type` header is not supported by this API.
          content:
            application/vnd.netbackup+json;version=13.0:
              schema: *ref_2
        '500': &ref_6
          description: An unexpected system error occurred.
          content:
            application/vnd.netbackup+json;version=13.0:
              schema: *ref_2
    get:
      description: >
        Return details of all configured malware scan hosts in the database
        based on the specified filters.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/11.0/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|MANAGE|MALWARE|SCAN-HOST|`\

        Requires Operation: `|OPERATIONS|VIEW|`\

        OR\

        Requires Operation: `|OPERATIONS|ADD|`
      tags:
        - Scan Host
      parameters:
        - name: filter
          description: >
            Filter criteria syntax is based on OData standards. Filtering is
            supported on the following attributes:

            |Name|Supported Operators|Description|Schema|

            |---|---|---|---|

            |hostName|eq contains |The name of the scan host.|string|

            |state|eq contains|The active state  of the scan host.|string|
          in: query
          required: false
          schema:
            type: string
        - name: include
          description: >
            Appends included section in the response payload with details of
            relationships that are specified in the include query.
          in: query
          required: false
          schema:
            type: string
            enum:
              - malwareTool
        - &ref_10
          in: query
          name: 'page[offset]'
          description: The number of records to skip before starting the page.
          schema:
            type: integer
            default: 0
            minimum: 0
        - &ref_11
          in: query
          name: 'page[limit]'
          description: The number of records to include in the page.
          schema:
            type: integer
            default: 10
            minimum: 0
            maximum: 100
        - name: sort
          description: >
            Sort in ascending order on the specified property. Prefix with "-"
            for descending order.

            Sorting is supported on the following attributes:

            |Name|

            |---|

            |state|

            |hostName|
          in: query
          required: false
          schema:
            type: string
            default: '-state'
      responses:
        '200':
          description: Successfully retrieved the list of scan hosts.
          content:
            application/vnd.netbackup+json;version=13.0:
              schema: &ref_41
                description: >-
                  The response returns all the scan hosts that are present in
                  the database.
                type: object
                properties:
                  data:
                    type: array
                    items: &ref_7
                      description: The response returns the scan host configuration.
                      type: object
                      required:
                        - type
                        - id
                        - attributes
                        - links
                      properties:
                        links:
                          type: object
                        type:
                          description: The scan host configuration response.
                          type: string
                          enum:
                            - scanHost
                        id:
                          type: string
                          description: >-
                            The scan host id. This is a unique id mapped per
                            Scan host configuration.
                        attributes: &ref_42
                          type: object
                          properties:
                            hostName:
                              type: string
                              description: The unique name of the scan host.
                            maxNoOfParallelScans:
                              type: integer
                              description: Specifies the number of parallel scans.
                            state:
                              type: string
                              description: >-
                                It indicate state of the scan Host if it is
                                active or not.
                              enum:
                                - ACTIVE
                                - INACTIVE
                            scanHostCredentialName:
                              type: string
                              description: Shows the credential name for the scan host.
                            scanHostType:
                              type: string
                              description: >-
                                If MALWARE_SCAN_HOST is selected, then scan host
                                with no NetBackup entity can be added to the
                                pool.If NBU_SCAN_HOST is selected, then
                                NetBackup client can be added as scan host in
                                the pool.
                              enum:
                                - MALWARE_SCAN_HOST
                                - NBU_SCAN_HOST
                              default: MALWARE_SCAN_HOST
                          required:
                            - hostName
                            - state
                        relationships: &ref_43
                          type: object
                          properties:
                            malwareTool:
                              type: object
                              properties:
                                links:
                                  type: object
                                  properties:
                                    related:
                                      type: object
                                      properties:
                                        href:
                                          type: string
                                data:
                                  type: array
                                  items: *ref_0
                            scanHostPool:
                              type: object
                              properties:
                                links:
                                  type: object
                                  properties:
                                    related:
                                      type: object
                                      properties:
                                        href:
                                          type: string
                                data:
                                  type: array
                                  items: *ref_1
                  included:
                    type: array
                    items: &ref_8
                      description: The response returned the tool configuration.
                      type: object
                      properties:
                        type:
                          type: string
                          enum:
                            - malwareTool
                        id:
                          type: string
                          description: The unique identifier associated with the entity.
                        attributes:
                          description: >-
                            The attributes of the malware tool configuration
                            creation response.
                          type: object
                          required:
                            - malwareToolName
                          properties:
                            malwareToolName:
                              type: string
                              description: malware tool name.
                  links: &ref_12
                    type: object
                    properties:
                      self:
                        type: object
                        description: Link to the current page.
                        properties:
                          href:
                            type: string
                      first:
                        type: object
                        description: Link to the first page.
                        properties:
                          href:
                            type: string
                      last:
                        type: object
                        description: Link to the last page.
                        properties:
                          href:
                            type: string
                      next:
                        type: object
                        description: Link to the next page.
                        properties:
                          href:
                            type: string
                      prev:
                        type: object
                        description: Link to the previous page.
                        properties:
                          href:
                            type: string
                  meta:
                    type: object
                    properties:
                      pagination: &ref_13
                        type: object
                        properties:
                          count:
                            type: integer
                            description: Total number of records.
                          pages:
                            type: integer
                            description: Total number of pages.
                          page:
                            type: integer
                            description: The current page number.
                          offset:
                            type: integer
                            description: The offset value for the current page.
                          limit:
                            type: integer
                            description: The number of records per page.
                          first:
                            type: integer
                            description: The offset value for the first page.
                          last:
                            type: integer
                            description: The offset value for the last page.
                          next:
                            type: integer
                            description: The offset value for the next page.
                          prev:
                            type: integer
                            description: The offset value for the previous page.
                required:
                  - data
        '400': *ref_3
        '401': *ref_4
        '406': *ref_5
        '500': *ref_6
  '/malware/scan-hosts/{scanHostId}':
    get:
      description: >
        Return the details of a malware scan host for the specified scan host
        ID.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/11.0/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|MANAGE|MALWARE|SCAN-HOST|`\

        Requires Operation: `|OPERATIONS|VIEW|`\

        OR\

        Requires Operation: `|OPERATIONS|ADD|`
      tags:
        - Scan Host
      parameters:
        - name: scanHostId
          in: path
          description: The unique scan host ID.
          required: true
          schema:
            type: string
        - name: include
          description: >-
            Appends included section in the response payload with details of
            relationships that are specified in the include query.
          in: query
          required: false
          schema:
            type: string
            enum:
              - malwareTool
      responses:
        '200':
          description: >-
            Successfully returned the details of the scan host with the
            specified id.
          content:
            application/vnd.netbackup+json;version=13.0:
              schema: &ref_33
                type: object
                properties:
                  data: *ref_7
                  included:
                    type: array
                    items: *ref_8
                required:
                  - data
        '401': *ref_4
        '404':
          description: The scan host ID does not exist.
          content:
            application/vnd.netbackup+json;version=13.0:
              schema: *ref_2
        '500': *ref_6
    patch:
      description: >
        Update malware scan host information for a scan host id.


        Note: If multi-factor authorization is enabled for this operation, the
        response returns an HTTP 202 status code. The ticket link

        is mentioned in the location header of the HTTP response, and the ticket
        ID is provided in the X-NetBackup-MPA-Ticket header.

        For more information, refer to the [multi-person
        authorization](http://sort.veritas.com/public/documents/nbu/11.0/windowsandunix/productguides/html/getting-started#user-content-multi-person-authorization)
        documentation.

         **Access Control**\
        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/11.0/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|MANAGE|MALWARE|SCAN-HOST|`\

        Requires Operation: `|OPERATIONS|UPDATE|`

        OR\

        Requires Operation: `|OPERATIONS|ADD|`
      tags:
        - Scan Host
      parameters:
        - name: scanHostId
          in: path
          description: The unique scan host id.
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/vnd.netbackup+json;version=13.0:
            schema: &ref_44
              description: >-
                The request that contains the parameters to update the scan
                host.
              type: object
              properties:
                data:
                  type: object
                  properties:
                    type:
                      type: string
                      description: update can host configuration.
                      enum:
                        - updateScanHost
                    id:
                      type: string
                      description: >-
                        The scan host id. This is a unique id mapped per Scan
                        host configuration.
                    attributes:
                      type: object
                      properties:
                        maxNoOfParallelScans:
                          type: integer
                          description: Specifies the number of parallel scans.
                        state:
                          type: string
                          description: >-
                            It indicate state of the scan Host if it is active
                            or not.
                          enum:
                            - ACTIVE
                            - INACTIVE
                        scanHostCredentialName:
                          type: string
                          description: Shows the credential name for the scan host
                        mediaServerName:
                          type: string
                          description: >-
                            The unique FQDN name of the media server to perform
                            validate operation.
                        scanHostType:
                          type: string
                          description: >-
                            If MALWARE_SCAN_HOST is selected, then scan host
                            with no NetBackup entity can be added to the pool.
                            If NBU_SCAN_HOST is selected, then NetBackup client
                            can be added as scan host in the pool.
                          enum:
                            - MALWARE_SCAN_HOST
                            - NBU_SCAN_HOST
                        userId:
                          type: string
                          description: >
                            The ID of the user which would be used for scan
                            operation. The same user would be granted IA mount
                            permission for accessing the files mounted. 


                            For more information, refer to the "Prerequisites
                            for a scan host" section in the NetBackup Security
                            and Encryption Guide.
                    relationships:
                      type: object
                      properties:
                        malwareTool:
                          type: object
                          properties:
                            data: *ref_0
                        scanHostPool:
                          type: object
                          properties:
                            data: *ref_1
                  required:
                    - type
                    - id
              required:
                - data
        required: true
      responses:
        '200':
          description: Successfully updated the attributes for the scan host.
          headers:
            Location:
              description: The link to the updated scan host configuration.
              schema:
                type: string
          content:
            application/vnd.netbackup+json;version=13.0:
              schema: &ref_31
                type: object
                properties:
                  data: &ref_35
                    description: The response returned after updating scan host.
                    type: object
                    required:
                      - type
                      - id
                      - attributes
                      - relationships
                    properties:
                      links:
                        type: object
                      type:
                        description: >-
                          The response received after scan host is updated
                          successfully.
                        type: string
                        enum:
                          - updateScanHost
                      id:
                        type: string
                        description: >-
                          The scan host id. This is a unique id mapped per scan
                          host configuration.
                      attributes:
                        description: >-
                          The attributes of the scan host configuration creation
                          response.
                        type: object
                        required:
                          - state
                        properties:
                          state:
                            type: string
                            description: >-
                              Indicates the state of the scan host if it is
                              active or not.
                            enum:
                              - ACTIVE
                              - INACTIVE
                          configInfo:
                            type: object
                            description: >-
                              The information retrieved from the scan host
                              during validation. It contains the Id of the user
                              provided while adding scan host.
                            properties:
                              userId:
                                type: string
                                description: >-
                                  User id of the user used for validation
                                  fetched from the host.
                required:
                  - data
        '202':
          description: >-
            The request was successfully received by the server and is awaiting
            MPA approval.
          headers:
            X-NetBackup-MPA-Ticket:
              description: >-
                The ticket ID of newly-generated multi-person authorization
                ticket.
              schema:
                type: string
            Location:
              description: >-
                The link to the newly-generated multi-person authorization
                ticket.
              schema:
                type: string
        '400': *ref_3
        '401': *ref_4
        '404':
          description: The scan host ID does not exist.
          content:
            application/vnd.netbackup+json;version=13.0:
              schema: *ref_2
        '415': *ref_9
        '500': *ref_6
    delete:
      description: >
        Delete the malware scan host with specified scan host id if it's not
        associated with any malware scan result.


        Note: If multi-factor authorization is enabled for this operation, the
        response returns an HTTP 202 status code. The ticket link

        is mentioned in the location header of the HTTP response, and the ticket
        ID is provided in the X-NetBackup-MPA-Ticket header.

        For more information, refer to the [multi-person
        authorization](http://sort.veritas.com/public/documents/nbu/11.0/windowsandunix/productguides/html/getting-started#user-content-multi-person-authorization)
        documentation.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/11.0/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|MANAGE|MALWARE|SCAN-HOST|`\

        Requires Operation: `|OPERATIONS|DELETE|`
      tags:
        - Scan Host
      parameters:
        - name: scanHostId
          in: path
          description: The unique scan host id.
          required: true
          schema:
            type: string
      responses:
        '202':
          description: >-
            The request was successfully received by the server and is awaiting
            MPA approval.
          headers:
            X-NetBackup-MPA-Ticket:
              description: >-
                The ticket ID of newly-generated multi-person authorization
                ticket.
              schema:
                type: string
            Location:
              description: >-
                The link to the newly-generated multi-person authorization
                ticket.
              schema:
                type: string
        '204':
          description: Request accepted for the delete scan host.
        '401': *ref_4
        '404':
          description: The scan host does not exist.
          content:
            application/vnd.netbackup+json;version=13.0:
              schema: *ref_2
        '500': *ref_6
  '/malware/scan-hosts/{scanHostId}/scan-host-pools/{poolId}':
    delete:
      description: >
        Deletes the specified mapping of scan host and the malware scan host
        pool.


        Note: If multi-factor authorization is enabled for this operation, the
        response returns an HTTP 202 status code. The ticket link

        is mentioned in the location header of the HTTP response, and the ticket
        ID is provided in the X-NetBackup-MPA-Ticket header.

        For more information, refer to the [multi-person
        authorization](http://sort.veritas.com/public/documents/nbu/11.0/windowsandunix/productguides/html/getting-started#user-content-multi-person-authorization)
        documentation.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/11.0/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|MANAGE|MALWARE|SCAN-HOST|`\

        Requires Operation: `|OPERATIONS|DELETE|`
      tags:
        - Scan Host
      parameters:
        - name: scanHostId
          in: path
          description: The unique scan host id.
          required: true
          schema:
            type: string
        - name: poolId
          in: path
          description: The unique scan host pool id.
          required: true
          schema:
            type: string
      responses:
        '202':
          description: >-
            The request was successfully received by the server and is awaiting
            MPA approval.
          headers:
            X-NetBackup-MPA-Ticket:
              description: >-
                The ticket ID of newly-generated multi-person authorization
                ticket.
              schema:
                type: string
            Location:
              description: >-
                The link to the newly-generated multi-person authorization
                ticket.
              schema:
                type: string
        '204':
          description: Request accepted for the delete scan host.
        '401': *ref_4
        '404':
          description: The scan host does not exist.
          content:
            application/vnd.netbackup+json;version=13.0:
              schema: *ref_2
        '500': *ref_6
  /malware/scan-hosts/validate:
    post:
      deprecated: true
      description: >
        **This API has been removed.**


        This API is no longer used for validating scan host and has been removed
        from the product.

        Replacements of this functionality: `POST /malware/scan-hosts` and
        `PATCH /malware/scan-hosts`. Scan host is now being validated as part of
        these APIs before adding or modifying it respectively.
      tags:
        - Scan Host
      requestBody:
        content:
          application/vnd.netbackup+json;version=13.0:
            schema: &ref_40
              description: >-
                The request body that contains the parameters used to validate
                the scan host.
              type: object
              required:
                - data
              properties:
                data:
                  type: object
                  properties:
                    type:
                      type: string
                      description: The resource type for the scan host validation.
                      enum:
                        - validateScanHostRequest
                    attributes:
                      type: object
                      required:
                        - hostName
                        - shareType
                      properties:
                        hostName:
                          type: string
                          description: The unique FQDN name of the scan host.
                        mediaServerName:
                          type: string
                          description: >-
                            The unique FQDN name of the media server to perform
                            validate operation.
                        scanHostCredentialName:
                          type: string
                          description: >-
                            Shows the scan host credential name for the scan
                            host.
                        shareType:
                          type: string
                          description: >-
                            Share Type for which validation of the scan host is
                            to be performed.
                  required:
                    - type
                    - attributes
        description: The validation details for the scan host.
        required: true
      responses:
        '200':
          description: Successfully validated the scan host.
          content:
            application/vnd.netbackup+json;version=13.0:
              schema: &ref_32
                type: object
                properties:
                  data: &ref_36
                    description: The response returned on scan host validation.
                    type: object
                    required:
                      - type
                      - id
                      - attributes
                    properties:
                      type:
                        description: The scan host validation response.
                        type: string
                        enum:
                          - validateScanHost
                      id:
                        type: string
                        description: >-
                          The scan host id. This is a unique id mapped per Scan
                          host configuration.
                      attributes:
                        description: The attributes of the scan host validation response.
                        type: object
                        required:
                          - hostName
                          - isValid
                          - configInfo
                          - error
                        properties:
                          hostName:
                            type: string
                            description: The unique name of the scan host.
                          isValid:
                            type: boolean
                            default: true
                            description: It indicates if the scan Host is valid or not.
                          configInfo:
                            type: object
                            description: >-
                              The information retrieved from the scan host
                              during validation. It contains malware tools
                              installed on the host along with their versions,
                              system specifications of the host.
                            properties:
                              userUuid:
                                type: string
                                description: >-
                                  UID of the user used for validation fetched
                                  from the host.
                              malwareTools:
                                type: array
                                description: >-
                                  List of malware tools with their names along
                                  with respective versions.
                                items:
                                  type: object
                                  description: >-
                                    Malware tool object containing tool name and
                                    its verison.
                                  properties:
                                    malwareToolName:
                                      type: string
                                      description: Name of the malware tool
                                    version:
                                      type: string
                                      description: Malware tool version
                              systemInfo:
                                type: object
                                description: >-
                                  System specifications of the host such as
                                  OS-name, OS-version, etc.
                                properties:
                                  osName:
                                    type: string
                                    description: Operating system name.
                                  osVersion:
                                    type: string
                                    description: Operating system version.
                                  cpus:
                                    type: string
                                    description: Number of CPU(s) on the host.
                                  systemArchitecture:
                                    type: string
                                    description: System architecture of the host.
                                  totalMemory:
                                    type: string
                                    description: Total memory installed on the host in GB.
                          error:
                            type: object
                            description: >-
                              Error message to be displayed if configuration
                              info can not be retrieved.
                            properties:
                              operation:
                                type: string
                                description: Operation that caused the failure.
                              errorCode:
                                type: string
                                description: Error code.
                              errorMessage:
                                type: string
                                description: Related error message.
                required:
                  - data
        '400': *ref_3
        '401': *ref_4
        '404':
          description: The scan host does not exist.
          content:
            application/vnd.netbackup+json;version=13.0:
              schema: *ref_2
        '406': *ref_5
        '415': *ref_9
        '500': *ref_6
  /malware/tools:
    get:
      description: >
        Returns the details of all the malware tool configurations based on
        specified filters.


        **Access Control(need to conlude this not yet decided)**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/11.0/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|MANAGE|MALWARE|SCAN-TOOL|`\

        Requires Operation: `|OPERATIONS|VIEW|`

        OR\

        Requires Operation: `|OPERATIONS|ADD|`
      tags:
        - Malware Tool
      parameters:
        - name: filter
          description: >
            Filter criteria syntax is based on OData standards. Filtering is
            supported on the following attributes:

            |Name|Supported Operators|Description|Schema|

            |---|---|---|---|

            |malwareToolName|eq contains|The malware tool name.|string|
          in: query
          required: false
          schema:
            type: string
        - *ref_10
        - *ref_11
        - name: sort
          description: >
            Sort in ascending order on the specified property. Prefix with "-"
            for descending order.

            Sorting is supported on the following attributes:

            |Name|

            |---|

            |malwareToolId|

            |malwareToolName|
          in: query
          required: false
          schema:
            type: string
            default: '-malwareToolId'
      responses:
        '200':
          description: Successfully retrieved the list of malware tool.
          content:
            application/vnd.netbackup+json;version=13.0:
              schema: &ref_47
                description: >-
                  The response returns all the malware tools that are present in
                  the database.
                type: object
                properties:
                  data:
                    type: array
                    items: &ref_46
                      description: The response returned the malware tool.
                      type: object
                      required:
                        - type
                        - id
                        - attributes
                      properties:
                        links:
                          type: object
                        type:
                          description: The malware tool creation response.
                          type: string
                          enum:
                            - malwareTool
                        id:
                          type: string
                          description: >-
                            The malware tool id. This is a unique id mapped per
                            malware tool configuration.
                        attributes:
                          description: >-
                            The attributes of the malware tool configuration
                            creation response.
                          type: object
                          required:
                            - malwareToolName
                          properties:
                            malwareToolName:
                              type: string
                              description: malware tool name.
                  links: *ref_12
                  meta:
                    type: object
                    properties:
                      pagination: *ref_13
                required:
                  - data
        '400': *ref_3
        '401': *ref_4
        '406': *ref_5
        '500': *ref_6
  /malware/jobs:
    get:
      description: >
        Returns all the malware jobs that are present in the database.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/11.0/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|MANAGE|MALWARE|`\

        Requires Operation: `|OPERATIONS|MANAGE|MALWARE|VIEW-SCAN-RESULT|`
      tags:
        - Malware Job
      parameters:
        - *ref_10
        - *ref_11
      responses:
        '200':
          description: Successfully retrieved the list of malware jobs
          content:
            application/vnd.netbackup+json;version=13.0:
              schema: &ref_74
                description: >-
                  The reponse returns all the malware jobs that are present in
                  the databse.
                type: object
                properties:
                  data:
                    type: array
                    items: &ref_14
                      description: The response returns the malware job data.
                      type: object
                      required:
                        - type
                        - id
                        - attributes
                      properties:
                        type:
                          description: The malware job response.
                          type: string
                          enum:
                            - malwareJob
                        id:
                          type: string
                          description: >-
                            The malwre job id. This is unique id mapped per
                            malware job.
                        attributes: &ref_76
                          type: object
                          properties:
                            numberOfBackupImagesReceived:
                              type: integer
                              description: >-
                                The count of backup images received for
                                scanning.
                            numberOfBackupProcessed:
                              type: integer
                              description: >-
                                The count of backup images accepted for
                                scanning.
                            createdTime:
                              type: string
                              description: >-
                                The time at which the job is accepted in ISO
                                8601 format.|date-time|
                            scanResult:
                              type: string
                              description: Indicates the result of a scanning job.
                              enum:
                                - NOT_SCANNED
                                - IMPACTED
                                - CLEAN
                                - NOT_SUPPORTED
                            scanState:
                              type: string
                              description: Indicates the state of a scanning job.
                              enum:
                                - PENDING
                                - SCAN_COMPLETED
                                - IN_PROGRESS
                                - SCAN_FAILED
                                - CANCELLED
                                - CANCEL_IN_PROGRESS
                                - QUEUING_IN_PROGRESS
                                - RECOVERY_TRIGGERED
                                - SCAN_REVIEW_PENDING
                                - ON_DEMAND_SCAN
                                - PREPARING_RESTORE_LIST_FOR_RECOVERY
                                - PREPARING_RESTORE_LIST_COMPLETED
                                - CLEAN_RECOVERY_BATCH_IN_PROGRESS
                                - CLEAN_RECOVERY_BATCH_COMPLETED
                            scanAndRecoveryOption:
                              type: string
                              description: Indicates the type of scan and recovery option.
                              enum:
                                - RECOVER_ONLY_CLEAN_FILES
                                - DO_NOT_RECOVER_IF_INFECTED
                                - ALLOW_RECOVERY_OF_INFECTED_FILES
                                - RECOVER_CLEAN_COPIES_IN_DATE_RANGE
                            selectionsPath:
                              type: string
                              description: >-
                                A string representation of JSON array of the
                                files to be restored with their path and backup
                                time in ISO 8601 format.
                            recoveryRequest:
                              type: string
                              description: >-
                                A string representation of json containing
                                recovery request payload.
                            recoveryScenarioType:
                              type: string
                              description: >-
                                The type of restore scenario based on the
                                workload to be used to recover image.
                            recoveryRequestUrl:
                              type: string
                              description: URL containing recovery request endpoint.
                            policyType:
                              type: string
                              description: Policy Type.
                              enum:
                                - STANDARD
                                - MS_WINDOWS
                            clientName:
                              type: string
                              description: Client Name.
                            assetId:
                              type: string
                              description: The Asset Id
                            backupTimeFrom:
                              type: string
                              description: >-
                                Start backup time of the backup images in ISO
                                8601 format.|date-time|
                            backupTimeTo:
                              type: string
                              description: >-
                                End backup time of the backup images in ISO 8601
                                format.|date-time|
                            numberOfFilesInfected:
                              type: integer
                              description: The number of files infected
                            numberOfFilesScanned:
                              type: integer
                              description: >-
                                Indicates the scan progress by showing number of
                                files scanned.
                            numberOfFilesSkipped:
                              type: integer
                              description: The number of files skipped during the scan.
                            totalNumberOfFiles:
                              type: integer
                              description: Total number of files to be scanned.
                            result:
                              type: string
                              description: Detailed scan result.
                            currentImageIndex:
                              type: integer
                              description: >-
                                Holds the page offset index of the backup images
                                fetched from the database.
                            nbuRecoveryJobId:
                              type: string
                              description: >-
                                Represents the recovery job id which is
                                displayed in activity monitor.
                            nbuMalwareJobId:
                              type: string
                              description: >-
                                Represents the malware job id which is displayed
                                in activity monitor.
                            scanHostPool:
                              type: object
                              properties:
                                links:
                                  type: object
                                  properties:
                                    related:
                                      type: object
                                      properties:
                                        href:
                                          type: string
                                data: &ref_20
                                  type: object
                                  properties:
                                    type:
                                      type: string
                                      description: >-
                                        The resource type for the scan host pool
                                        configuration.
                                      enum:
                                        - scanHostPool
                                    id:
                                      type: string
                                      description: >-
                                        The scan host pool id. This is a unique
                                        id mapped per scan host pool
                                        configuration.
                        links:
                          type: object
                          properties:
                            self:
                              type: object
                              properties:
                                href:
                                  type: string
                  links: *ref_12
                  meta:
                    type: object
                    properties:
                      pagination: *ref_13
                required:
                  - data
        '400': *ref_3
        '401': *ref_4
        '406': *ref_5
        '500': *ref_6
  '/malware/jobs/{jobId}':
    get:
      description: >
        Returns the details of a malware job for the specified malware job Id.

         **Access Control**\
        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/11.0/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|MANAGE|MALWARE|`\

        Requires Operation: `|OPERATIONS|MANAGE|MALWARE|VIEW-SCAN-RESULT|`
      tags:
        - Malware Job
      parameters:
        - name: jobId
          in: path
          description: The unique malware job id
          required: true
          schema:
            type: string
      responses:
        '200':
          description: >-
            Successfully returned the details of the malware job with the
            specified id.
          content:
            application/vnd.netbackup+json;version=13.0:
              schema: &ref_75
                description: >-
                  The response returns the details of a malware job present in
                  the databse
                type: object
                properties:
                  data: *ref_14
        '401': *ref_4
        '404':
          description: The malware job with given id does not exist.
          content:
            application/vnd.netbackup+json;version=13.0:
              schema: *ref_2
        '406': *ref_5
        '500': *ref_6
  /malware/scan-host-pools:
    post:
      description: >
        Configures a scan host pool in NetBackup.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/11.0/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|MANAGE|MALWARE|SCAN-HOST-POOL|`\

        Requires Operation: `|OPERATIONS|ADD|`
      tags:
        - Scan Host Pool
      requestBody:
        content:
          application/vnd.netbackup+json;version=13.0:
            schema: &ref_48
              description: >-
                The request that contains the parameters to create the scan host
                pool.
              type: object
              required:
                - data
              properties:
                data:
                  type: object
                  properties:
                    type:
                      type: string
                      description: The resource type for the scan host pool configuration.
                      enum:
                        - createScanHostPool
                    attributes:
                      type: object
                      properties:
                        poolName:
                          type: string
                          description: The unique name of the scan host pool.
                        shareType:
                          type: string
                          description: >-
                            Indicates the type of share that scan hosts supports
                            in this pool.
                          enum:
                            - SMB
                            - NFS
                        activeDirectoryUser:
                          type: string
                          description: Active Directory User name.
                        activeDirectoryGroup:
                          type: string
                          description: Active Directory User group name.
                        malwareToolCredentialName:
                          type: string
                          description: The credential name for the malware tool.
                        scanHostType:
                          type: string
                          description: >-
                            If MALWARE_SCAN_HOST is selected, then scan host
                            with no NetBackup entity can be added to the pool.If
                            NBU_SCAN_HOST is selected, then NetBackup client can
                            be added as scan host in the pool.
                          enum:
                            - MALWARE_SCAN_HOST
                            - NBU_SCAN_HOST
                          default: MALWARE_SCAN_HOST
                      required:
                        - poolName
                        - shareType
                        - activeDirectoryUser
                        - activeDirectoryGroup
                        - malwareToolCredentialName
                    relationships:
                      type: object
                      properties:
                        malwareTool:
                          type: object
                          properties:
                            data: &ref_15
                              type: object
                              properties:
                                type:
                                  type: string
                                  description: >-
                                    The resource type for the malware tool
                                    configuration.
                                  enum:
                                    - malwareTool
                                id:
                                  type: string
                                  description: >-
                                    The malware tool id. This is a unique id
                                    mapped per malware tool configuration.
                  required:
                    - type
                    - attributes
                    - relationships
        description: The configuration details for the scan host pool.
        required: true
      responses:
        '201':
          description: Successfully configured the scan host pool.
          headers:
            Location:
              description: The link to a newly created scan host pool configuration..
              schema:
                type: string
          content:
            application/vnd.netbackup+json;version=13.0:
              schema: &ref_51
                type: object
                properties:
                  data: &ref_52
                    description: The response returns the scan host pool configuration.
                    type: object
                    required:
                      - type
                      - id
                      - attributes
                      - links
                    properties:
                      links:
                        type: object
                      type:
                        description: The scan host pool creation response.
                        type: string
                        enum:
                          - scanHostPool
                      id:
                        type: string
                        description: >-
                          The scan host pool id. This is a unique id mapped per
                          Scan host pool.
                      attributes: &ref_16
                        type: object
                        properties:
                          poolName:
                            type: string
                            description: The unique name of the scan host pool.
                          shareType:
                            type: string
                            description: >-
                              Indicates the type of share that scan hosts
                              supports in this pool.
                            enum:
                              - SMB
                              - NFS
                          activeDirectoryUser:
                            type: string
                            description: Active Directory User name.
                          activeDirectoryGroup:
                            type: string
                            description: Active Directory User group name.
                          malwareToolCredentialName:
                            type: string
                            description: The credential name for the malware tool.
                          createdTime:
                            type: string
                            description: The Scan Host Pool creation time.
                          lastModifiedTime:
                            type: string
                            description: The Scan Host Pool last modification time.
                          scanHostType:
                            type: string
                            description: >-
                              If MALWARE_SCAN_HOST is selected, then scan host
                              with no NetBackup entity can be added to the
                              pool.If NBU_SCAN_HOST is selected, then NetBackup
                              client can be added as scan host in the pool.
                            enum:
                              - MALWARE_SCAN_HOST
                              - NBU_SCAN_HOST
                            default: MALWARE_SCAN_HOST
                        required:
                          - poolName
                          - shareType
                          - activeDirectoryUser
                          - activeDirectoryGroup
                          - malwareToolCredentialName
                      relationships: &ref_17
                        type: object
                        properties:
                          malwareTool:
                            type: object
                            properties:
                              links:
                                type: object
                                properties:
                                  related:
                                    type: object
                                    properties:
                                      href:
                                        type: string
                              data: *ref_15
                          scanHost:
                            type: object
                            properties:
                              links:
                                type: object
                                properties:
                                  related:
                                    type: object
                                    properties:
                                      href:
                                        type: string
                              data:
                                type: array
                                items: &ref_19
                                  type: object
                                  properties:
                                    type:
                                      type: string
                                      description: >-
                                        The resource type for the scan host
                                        configuration.
                                      enum:
                                        - scanHost
                                    id:
                                      type: string
                                      description: >-
                                        The scan host id. This is a unique id
                                        mapped per scan host configuration.
                required:
                  - data
        '400': *ref_3
        '401': *ref_4
        '406': *ref_5
        '415': *ref_9
        '500': *ref_6
    get:
      description: >
        Returns the details of all the scan host pool configurations based on
        specified filters.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/11.0/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|MANAGE|MALWARE|SCAN-HOST-POOL|`\

        Requires Operation: `|OPERATIONS|VIEW|`

        OR\

        Requires Operation: `|OPERATIONS|ADD|`
      tags:
        - Scan Host Pool
      parameters:
        - name: filter
          description: >
            Filter criteria syntax is based on OData standards. Filtering is
            supported on the following attributes:

            |Name|Supported Operators|Description|Schema|

            |---|---|---|---|

            |poolName|eq contains |The name of the scan host pool.|string|

            |malwareTool/malwareToolName|eq contains |The name of the malware
            tool.|string|

            |shareType|eq contains|The share type of the scan host.|string|
          in: query
          required: false
          schema:
            type: string
        - *ref_10
        - *ref_11
        - name: sort
          description: >
            Sort in ascending order on the specified property. Prefix with "-"
            for descending order.

            Sorting is supported on the following attributes:

            |Name|

            |---|

            |poolName|

            |malwareTool.malwareToolName|

            |shareType|

            |createdTime|

            |lastModifiedTime|
          in: query
          required: false
          schema:
            type: string
            default: '-createdTime'
        - name: include
          description: Relationships to include
          in: query
          required: false
          schema:
            type: string
            enum:
              - malwareTool
              - scanHost
      responses:
        '200':
          description: Successfully retrieved the list of Scan host pool.
          content:
            application/vnd.netbackup+json;version=13.0:
              schema: &ref_53
                description: >-
                  The response returns all the scan host pools that are present
                  in the database.
                type: object
                properties:
                  data:
                    type: array
                    items: &ref_18
                      description: The response returns the scan host pool configuration.
                      type: object
                      required:
                        - type
                        - id
                        - attributes
                      properties:
                        links:
                          type: object
                        type:
                          description: The scan host pool creation response.
                          type: string
                          enum:
                            - scanHostPool
                        id:
                          type: string
                          description: >-
                            The scan host pool id. This is a unique id mapped
                            per Scan host pool.
                        attributes: *ref_16
                        relationships: *ref_17
                  included:
                    type: array
                    items: *ref_8
                  links: *ref_12
                  meta:
                    type: object
                    properties:
                      pagination: *ref_13
                required:
                  - data
        '400': *ref_3
        '401': *ref_4
        '406': *ref_5
        '500': *ref_6
  '/malware/scan-host-pools/{poolId}':
    get:
      description: >
        Returns the details of a scan host pool configuration for the specified
        pool Id.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/11.0/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|MANAGE|MALWARE|SCAN-HOST-POOL|`\

        Requires Operation: `|OPERATIONS|VIEW|`

        OR\

        Requires Operation: `|OPERATIONS|ADD|`
      tags:
        - Scan Host Pool
      parameters:
        - name: poolId
          in: path
          description: The unique scan host pool id.
          required: true
          schema:
            type: string
        - name: include
          description: Relationships to include
          in: query
          required: false
          schema:
            type: string
            enum:
              - malwareTool
              - scanHost
      responses:
        '200':
          description: >-
            Successfully returned the details of the scan host pool with the
            specified id.
          content:
            application/vnd.netbackup+json;version=13.0:
              schema: &ref_54
                type: object
                properties:
                  data: *ref_18
                  included:
                    type: array
                    items: *ref_8
                required:
                  - data
        '401': *ref_4
        '404':
          description: The scan host pool id does not exist.
          content:
            application/vnd.netbackup+json;version=13.0:
              schema: *ref_2
        '500': *ref_6
    delete:
      description: >
        Delete a scan host pool configuration for the specified scan host pool
        id.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/11.0/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|MANAGE|MALWARE|SCAN-HOST-POOL|`\

        Requires Operation: `|OPERATIONS|DELETE|`
      tags:
        - Scan Host Pool
      parameters:
        - name: poolId
          in: path
          description: The unique scan host pool id.
          required: true
          schema:
            type: string
      responses:
        '204':
          description: Successfully deleted the scan host pool.
        '401': *ref_4
        '404':
          description: The scan host pool does not exist.
          content:
            application/vnd.netbackup+json;version=13.0:
              schema: *ref_2
        '500': *ref_6
  /malware/scan-results:
    get:
      description: >
        Returns all the scan results that are present in the database, based on
        specified filters.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/11.0/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|MANAGE|MALWARE|`\

        Requires Operation: `|OPERATIONS|MANAGE|MALWARE|VIEW-SCAN-RESULT|`
      tags:
        - Scan Result
      parameters:
        - name: filter
          description: >
            Filter criteria syntax is based on OData standards. Filtering is
            supported on the following attributes:

            |Name|Supported Operators|Description|Schema|

            |---|---|---|---|

            |client|eq contains |The name of the client.|string|

            |malwareTool/malwareToolName|eq contains |The name of the malware
            tool.|string|

            |scanResult|eq contains|The scan result.|string|

            |scanState|eq contains|The scan state.|string|

            |scanHost/hostName|eq contains|The scan host name.|string|

            |dateOfScan|eq ne lt gt le ge|Date of scan.|date-time|

            |endDateOfScan|eq ne lt gt le ge|End date of scan.|date-time|

            |backupTime|eq ne lt gt le ge|Backup Time.|integer|

            |parentScanResult/id|eq|Parent scan result id.|integer|

            |hierarchyLevel|eq|Hierarchy level for NAS_DATA_PROTECTION
            policy.|integer|
          in: query
          required: false
          schema:
            type: string
        - *ref_10
        - *ref_11
        - name: sort
          description: >
            Sort in ascending order on the specified property. Prefix with "-"
            for descending order.

            Sorting is supported on the following attributes:

            |Name|

            |---|

            |dateOfScan|

            |malwareTool.malwareToolName|

            |scanResult|

            |scanState|

            |scanHost.hostName|

            |client|

            |backupTime|

            |noOfFilesImpacted|
          in: query
          required: false
          schema:
            type: string
            default: '-dateOfScan'
        - name: include
          description: Relationships to include
          in: query
          required: false
          schema:
            type: string
            enum:
              - malwareTool
              - scanHost
      responses:
        '200':
          description: Successfully retrieved the list of scan results.
          content:
            application/vnd.netbackup+json;version=13.0:
              schema: &ref_23
                description: >-
                  The response returns all the scan results that are present in
                  the database.
                type: object
                properties:
                  data:
                    type: array
                    items: &ref_21
                      description: The response returns the scan result data.
                      type: object
                      required:
                        - type
                        - id
                        - attributes
                      properties:
                        links:
                          type: object
                        type:
                          description: The scan result response.
                          type: string
                          enum:
                            - scanResult
                        id:
                          type: string
                          description: >-
                            The scan result id. This is a unique id mapped per
                            scan result.
                        attributes: &ref_64
                          type: object
                          properties:
                            scanState:
                              type: string
                              description: Indicates the state of a scanning job.
                              enum:
                                - PENDING
                                - SCAN_COMPLETED
                                - IN_PROGRESS
                                - SCAN_FAILED
                                - CANCELLED
                                - CANCEL_IN_PROGRESS
                                - SCAN_STARTED
                                - CLEANUP_IN_PROGRESS
                                - CANCELLATION_INITIATED
                            scanResult:
                              type: string
                              description: Indicates the result of a scanning job.
                              enum:
                                - NOT_SCANNED
                                - IMPACTED
                                - CLEAN
                                - NOT_SUPPORTED
                            policyType:
                              type: string
                              description: Policy Type.
                              enum:
                                - STANDARD
                                - MS-WINDOWS
                            backupType:
                              type: string
                              description: Backup Type.
                              enum:
                                - FULL
                                - DIFFERENTIAL_INCREMENTAL
                                - CUMULATIVE_INCREMENTAL
                            signature:
                              type: string
                              description: Malware tool signature details.
                            dateOfScan:
                              type: string
                              description: Date of scan.
                            endDateOfScan:
                              type: string
                              description: End date of scan.
                            numberOfFilesImpacted:
                              type: integer
                              description: No of Files Impacted.
                            result:
                              type: string
                              description: Detailed scan result.
                            client:
                              type: string
                              description: Client Name.
                            backupTime:
                              type: integer
                              description: Backup Time.
                            displayName:
                              type: string
                              description: The display name of client.
                            providerGeneratedId:
                              type: string
                              description: >-
                                The provider identifier, which is unique within
                                the workloadType context that is provided by the
                                workload.
                            triggerMethod:
                              type: string
                              description: >-
                                The trigger method, identifies who has triggered
                                the scan.
                              enum:
                                - AUTOMATIC
                                - MANUAL
                              default: MANUAL
                            malwareScannerVersion:
                              type: string
                              description: Version of malware tool.
                            mediaServerName:
                              type: string
                              description: >-
                                Host name of Media Server through which scan got
                                triggered on Scan Host.
                            numberOfFilesScanned:
                              type: integer
                              description: >-
                                Indicates the scan progress by showing number of
                                files scanned.
                            totalNumberOfFiles:
                              type: integer
                              description: Total number of files to be scanned.
                            startDateOfScan:
                              type: string
                              description: Start date of scan. (ISO 8601 standard)
                            hierarchyLevel:
                              type: integer
                              description: >-
                                Hierarchy level information for
                                NAS_DATA_PROTECTION policy.
                            iaCreateJobId:
                              type: integer
                              description: >-
                                instant access creation job id created for scan
                                result.
                            iaDisplayName:
                              type: string
                              description: >-
                                Display name of the instant access associated
                                with the scan result.
                            policyName:
                              type: string
                              description: >-
                                Policy name of the backup image associated with
                                the scan result.
                            scanContext:
                              type: string
                              description: >-
                                Additional context information associated with
                                the scan result.
                            malwareInfo:
                              type: string
                              description: >-
                                Information related to Malware identified in
                                infected files.
                          required:
                            - scanState
                            - policyType
                            - backupType
                            - malwareToolId
                            - signature
                            - scanHostId
                        relationships: &ref_49
                          type: object
                          properties:
                            malwareTool:
                              type: object
                              properties:
                                links:
                                  type: object
                                  properties:
                                    related:
                                      type: object
                                      properties:
                                        href:
                                          type: string
                                data: *ref_15
                            scanHost:
                              type: object
                              properties:
                                links:
                                  type: object
                                  properties:
                                    related:
                                      type: object
                                      properties:
                                        href:
                                          type: string
                                data: *ref_19
                            scanHostPool:
                              type: object
                              properties:
                                links:
                                  type: object
                                  properties:
                                    related:
                                      type: object
                                      properties:
                                        href:
                                          type: string
                                data: *ref_20
                            parentScanResult:
                              type: object
                              properties:
                                links:
                                  type: object
                                  properties:
                                    related:
                                      type: object
                                      properties:
                                        href:
                                          type: string
                                data: &ref_50
                                  type: object
                                  properties:
                                    type:
                                      type: string
                                      description: >-
                                        The resource type for the parent scan
                                        result.
                                      enum:
                                        - scanResult
                                    id:
                                      type: string
                                      description: >-
                                        The scan result id. This is a unique id
                                        mapped per scan result.
                  included:
                    type: array
                    items: *ref_8
                  links: *ref_12
                  meta:
                    type: object
                    properties:
                      pagination: *ref_13
                required:
                  - data
        '400': *ref_3
        '401': *ref_4
        '406': *ref_5
        '500': *ref_6
  '/malware/scan-results/{scanResultId}':
    get:
      description: >
        Returns the details of a scan result for the specified scan result Id.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/11.0/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|MANAGE|MALWARE|`\

        Requires Operation: `|OPERATIONS|MANAGE|MALWARE|VIEW-SCAN-RESULT|`
      tags:
        - Scan Result
      parameters:
        - &ref_22
          name: scanResultId
          in: path
          description: The unique scan result id.
          required: true
          schema:
            type: integer
        - name: include
          description: Relationships to include
          in: query
          required: false
          schema:
            type: string
            enum:
              - malwareTool
              - scanHost
      responses:
        '200':
          description: >-
            Successfully returned the details of the scan result with the
            specified id.
          content:
            application/vnd.netbackup+json;version=13.0:
              schema: &ref_65
                description: >-
                  The response returns the details of a scan result that is
                  present in the database for the specified scan result Id.
                type: object
                properties:
                  data: *ref_21
                  included:
                    type: array
                    items: *ref_8
                required:
                  - data
        '401': *ref_4
        '404':
          description: The scan result id does not exist.
          content:
            application/vnd.netbackup+json;version=13.0:
              schema: *ref_2
        '500': *ref_6
    delete:
      description: >
        Delete scan result with specified id only if scan job is
        failed/cancelled.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/11.0/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|MANAGE|MALWARE|SCAN-RESULT|`\

        Requires Operation: `|OPERATIONS|DELETE|`
      tags:
        - Scan Result
      parameters:
        - *ref_22
      responses:
        '204':
          description: Successfully deleted scan result with specified id.
        '401': *ref_4
        '404':
          description: The scan result for the specified id does not exist.
          content:
            application/vnd.netbackup+json;version=13.0:
              schema: *ref_2
        '500': *ref_6
  /malware/latest-scan-results:
    get:
      description: >
        Returns the latest completed scan result per backup image, based on
        specified filters.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/11.0/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|MANAGE|MALWARE|`\

        Requires Operation: `|OPERATIONS|MANAGE|MALWARE|VIEW-SCAN-RESULT|`
      tags:
        - Scan Result
      parameters:
        - name: filter
          description: >
            Filter criteria syntax is based on OData standards. Filtering is
            supported on the following attributes:

            |Name|Supported Operators|Description|Schema|

            |---|---|---|---|

            |client|eq contains |The name of the client.|string|

            |malwareTool/malwareToolName|eq contains |The name of the malware
            tool.|string|

            |scanResult|eq contains|The scan result.|string|

            |scanHost/hostName|eq contains|The scan host name.|string|

            |backupTime|eq ne lt gt le ge|Backup Time.|integer|

            |parentScanResult/id|eq|Parent scan result id.|integer|

            |hierarchyLevel|eq|Hierarchy level for NAS_DATA_PROTECTION
            policy.|integer|
          in: query
          required: false
          schema:
            type: string
        - *ref_10
        - *ref_11
        - name: sort
          description: >
            Sort in ascending order on the specified property. Prefix with "-"
            for descending order.

            Sorting is supported on the following attributes:

            |Name|

            |---|

            |dateOfScan|

            |malwareTool.malwareToolName|

            |scanResult|

            |scanState|

            |scanHost.hostName|

            |client|

            |backupTime|

            |numberOfFilesImpacted|
          in: query
          required: false
          schema:
            type: string
            default: '-dateOfScan'
        - name: include
          description: Relationships to include
          in: query
          required: false
          schema:
            type: string
            enum:
              - malwareTool
              - scanHost
      responses:
        '200':
          description: Successfully retrieved the list of scan results.
          content:
            application/vnd.netbackup+json;version=13.0:
              schema: *ref_23
        '400': *ref_3
        '401': *ref_4
        '406': *ref_5
        '500': *ref_6
  '/malware/export-scan-results/{scanResultId}':
    get:
      description: >
        Downloads the infected file list for the specified scan result Id in csv
        format.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/11.0/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|MANAGE|MALWARE|`\

        Requires Operation: `|OPERATIONS|MANAGE|MALWARE|VIEW-SCAN-RESULT|`
      tags:
        - Scan Result
      parameters:
        - *ref_22
      responses:
        '200':
          description: Successfully downloaded infected file list.
          content:
            text/vnd.netbackup+csv;version=13.0:
              schema:
                type: string
                format: binary
        '400': *ref_3
        '401': *ref_4
        '404': &ref_24
          description: No entity found.
          content:
            application/vnd.netbackup+json;version=13.0:
              schema: *ref_2
        '406':
          description: >-
            Invalid `Accept` type. Make sure your Accept header matches what
            this API produces.
          content:
            text/vnd.netbackup+csv;version=13.0:
              schema:
                type: string
        '500': *ref_6
  '/malware/export-skipped-files/{scanResultId}':
    get:
      description: >
        Downloads the skipped file list for the specified scan result Id in csv
        format.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/11.0/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|MANAGE|MALWARE|`\

        Requires Operation: `|OPERATIONS|MANAGE|MALWARE|VIEW-SCAN-RESULT|`
      tags:
        - Scan Result
      parameters:
        - *ref_22
      responses:
        '200':
          description: Successfully downloaded skipped file list.
          content:
            text/vnd.netbackup+csv;version=13.0:
              schema:
                type: string
                format: binary
        '400': *ref_3
        '401': *ref_4
        '404': *ref_24
        '406':
          description: >-
            Invalid `Accept` type. Make sure your Accept header matches what
            this API produces.
          content:
            text/vnd.netbackup+csv;version=13.0:
              schema:
                type: string
        '500': *ref_6
  /malware/export-scan-results:
    get:
      description: >
        Downloads the infected file list of the latest completed scan result per
        backup image based on specified filters in CSV format.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/11.0/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|MANAGE|MALWARE|`\

        Requires Operation: `|OPERATIONS|MANAGE|MALWARE|VIEW-SCAN-RESULT|`
      tags:
        - Scan Result
      parameters:
        - name: filter
          description: >
            Filter criteria syntax is based on OData standards. Filtering is
            supported on the following attributes:

            |Name|Supported Operators|Description|Schema|

            |---|---|---|---|

            |client|eq contains |The name of the client.|string|

            |malwareTool/malwareToolName|eq contains |The name of the malware
            tool.|string|

            |scanResult|eq contains|The scan result.|string|

            |scanHost/hostName|eq contains|The scan host name.|string|

            |backupTime|eq ne lt gt le ge|Backup Time.|integer|

            |parentScanResult/id|eq|Parent scan result id.|integer|

            |hierarchyLevel|eq|Hierarchy level for NAS_DATA_PROTECTION
            policy.|integer|
          in: query
          required: false
          schema:
            type: string
      responses:
        '200':
          description: Successfully downloaded infected file list.
          content:
            text/vnd.netbackup+csv;version=13.0:
              schema:
                type: string
                format: binary
        '400': *ref_3
        '401': *ref_4
        '404': *ref_24
        '406': *ref_5
        '500': *ref_6
  /malware/impact-analysis:
    get:
      description: >
        Creates the impact report including the list of clients, their
        corresponding backup images, and the infected files in those backup
        images for the number of days mentioned in bp.conf file with
        MALWARE_HASH_RETENTION_DAYS as the key.

        If not specified default retention period is 30 days.

        This API requires the File Hash Server to be configured.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/11.0/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|MANAGE|MALWARE|`\

        Requires Operation: `|OPERATIONS|MANAGE|MALWARE|VIEW-SCAN-RESULT|`
      tags:
        - Impact Analysis
      parameters:
        - name: filter
          description: >
            Filter criteria syntax is based on OData standards. Filtering is
            supported on the following attributes:

            |Name|Supported Operators|Description|Schema|

            |---|---|---|---|

            |backupTime|ge le |Backup time|date-time|

            |clientName|eq contains startswith endswith |The name of the
            client|string|
          in: query
          required: false
          schema:
            type: string
        - name: sort
          description: >
            Sort in ascending order on the specified property. Prefix with "-"
            for descending order.

            Sorting is supported on the following attributes:

            |Name|

            |---|

            |clientName|

            |backupTime|
          in: query
          required: false
          schema:
            type: string
            default: '-backupTime'
      responses:
        '200':
          description: Successfully retrieved the list of impacted clients.
          content:
            application/vnd.netbackup+json;version=13.0:
              schema: &ref_66
                type: object
                properties:
                  data:
                    type: array
                    items: &ref_56
                      type: object
                      required:
                        - type
                        - id
                        - attributes
                      properties:
                        type:
                          description: >-
                            The impact analysis response for malware infected
                            files.
                          type: string
                          enum:
                            - impactAnalysis
                        id:
                          type: string
                          description: >-
                            The impact analysis ID. This is a unique ID mapped
                            per result.
                        attributes: &ref_57
                          type: object
                          properties:
                            summary:
                              type: string
                              description: Condensed summary of the impact analysis report.
                            analysisStatus:
                              type: string
                              description: >
                                NO_INFECTION_DETECTED: No infected files were
                                found through file hash search.

                                INFECTION_DETECTED: User will receive details
                                like file hashes list, client names, images and
                                file names.

                                SEVERE_INFECTION_DETECTED: User will get list of
                                client names only.
                              enum:
                                - NO_INFECTION_DETECTED
                                - INFECTION_DETECTED
                                - SEVERE_INFECTION_DETECTED
                            impactReport:
                              type: object
                              description: >
                                If the analysis status is,
                                NO_INFECTION_DETECTED: A list of infected
                                clients will be empty. INFECTION_DETECTED: A
                                list of infected clients along with the
                                associated images and files would be returned.
                                SEVERE_INFECTION_DETECTED: A list of only
                                infected client names would be returned. When
                                the impact is severe, the list of impacted
                                images and files may be too large to be returned
                                in an API response.
                              oneOf:
                                - &ref_58
                                  type: object
                                  required:
                                    - hashes
                                    - clients
                                  properties:
                                    hashes:
                                      type: array
                                      items: &ref_60
                                        type: object
                                        properties:
                                          hash:
                                            type: string
                                            description: Hash of the impacted file
                                          malwareInfo:
                                            type: string
                                            description: >-
                                              Information related to malware
                                              identified in infected files.
                                    clients:
                                      type: array
                                      items: &ref_61
                                        type: object
                                        properties:
                                          clientName:
                                            type: string
                                            description: Name of the impacted client
                                          images:
                                            type: array
                                            items: &ref_62
                                              type: object
                                              properties:
                                                backupId:
                                                  type: string
                                                  description: >-
                                                    Backup image name along with the epoch
                                                    time
                                                backupTime:
                                                  type: integer
                                                  description: Backup date-time
                                                fileDetails:
                                                  type: array
                                                  items: &ref_63
                                                    type: object
                                                    properties:
                                                      filePath:
                                                        type: string
                                                        description: >-
                                                          The absolute file path of the infected
                                                          file
                                                      malwareInfo:
                                                        type: string
                                                        description: >-
                                                          Information related to Malware
                                                          identified in infected files.
                                - &ref_59
                                  type: object
                                  required:
                                    - clients
                                  properties:
                                    clients:
                                      type: array
                                      items:
                                        type: object
                                        properties:
                                          clientName:
                                            type: string
                                            description: Name of the impacted client
                required:
                  - data
        '400': *ref_3
        '401': *ref_4
        '404': *ref_24
        '406': *ref_5
        '500': *ref_6
        '503':
          description: File Hash Server is not configured.
          content:
            application/vnd.netbackup+json;version=13.0:
              schema: *ref_2
  /malware/on-demand-scan:
    post:
      description: >
        Create worklist item for malware scan for given backupId and copyNumber.

         **Access Control**\
        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/11.0/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|MANAGE|MALWARE|`\

        Requires Operation: `|OPERATIONS|MANAGE|MALWARE|ON-DEMAND-SCAN|`
      tags:
        - Malware On Demand Scan
      requestBody:
        content:
          application/vnd.netbackup+json;version=13.0:
            schema: &ref_28
              description: >-
                The request that contains backupId and copyNumber to be scanned
                for malware.
              type: object
              required:
                - data
              properties:
                data:
                  description: Contains the on demand scan request data.
                  type: object
                  required:
                    - type
                    - attributes
                  properties:
                    type:
                      description: The resource type for on demand scan.
                      type: string
                      enum:
                        - onDemandScanRequest
                      default: onDemandScanRequest
                    attributes:
                      description: Contains the on demand scan request attributes.
                      type: object
                      required:
                        - backupIds
                        - scanHostPool
                      properties:
                        backupIds:
                          type: array
                          items: &ref_71
                            description: the response returned the backup image list.
                            type: object
                            properties:
                              backupId:
                                type: string
                              copyNumber:
                                type: integer
                          description: Image backup id List.
                        scanHostPool:
                          type: integer
                          description: ScanHostPool for the onDemandRequest.
        description: The scan result details.
        required: true
      responses:
        '201':
          description: Successfully added backupId for malware Scan.
          headers:
            Location:
              description: The link to the newly aded scan result of given backupId.
              schema:
                type: string
          content:
            application/vnd.netbackup+json;version=13.0:
              schema: &ref_29
                description: The on demand scan response.
                type: object
                required:
                  - data
                properties:
                  data:
                    description: The response returns on demand scan with scan result.
                    type: object
                    required:
                      - type
                      - id
                      - attributes
                      - relationships
                    properties:
                      type:
                        description: The response type.
                        type: string
                        enum:
                          - onDemandScanResponse
                        default: onDemandScanResponse
                      id:
                        description: The response identifier.
                        type: string
                      attributes:
                        description: Contains the on demand scan response attributes.
                        type: object
                        required:
                          - msg
                          - status
                        properties:
                          msg:
                            description: The response message.
                            type: string
                          status:
                            description: on demand scan enum.
                            type: string
                            enum:
                              - SUCCESS
                              - FAIL
                              - PARTIAL_SUCCESSFUL
                            default: SUCCESS
                      relationships:
                        description: >-
                          Contains the resources related to the on demand scan
                          operation, such as `scanResult`.
                        type: object
                        required:
                          - scanResult
                        properties:
                          scanResult:
                            description: >-
                              Represents the scan result created by this on
                              demand scan operation.
                            type: object
                            required:
                              - links
                              - data
                            properties:
                              links:
                                description: >-
                                  Contains the links to get the scan result
                                  details.
                                type: object
                                required:
                                  - related
                                  - self
                                properties:
                                  related:
                                    description: Gets a list of scan results.
                                    type: array
                                    items: &ref_25
                                      description: The response returned the href list.
                                      type: object
                                      properties:
                                        href:
                                          type: string
                                  self:
                                    description: >-
                                      Gets a list of details about this scan
                                      result.
                                    type: array
                                    items: *ref_25
                              data:
                                type: object
                                description: Contains the scan result data.
                                required:
                                  - type
                                  - id
                                properties:
                                  type:
                                    description: The resource type. Set to `scanResult`.
                                    type: string
                                  id:
                                    description: The scan result identifier.
                                    type: string
        '400': *ref_3
        '401': *ref_4
        '406': *ref_5
        '415': *ref_9
        '500': *ref_6
  /malware/on-demand-scan/test-malware-scan:
    post:
      description: >
        Test scan API is used to validate the configuration for malware scan. A
        maximum of 5 files can be scanned from the selected backup image.

         **Access Control**\
        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/11.0/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|MANAGE|MALWARE|`\

        Requires Operation: `|OPERATIONS|MANAGE|MALWARE|ON-DEMAND-SCAN|`
      tags:
        - Malware On Demand Scan
      requestBody:
        content:
          application/vnd.netbackup+json;version=13.0:
            schema: &ref_67
              description: >-
                The request which contains the backupId and copyNumber to be
                scanned.
              type: object
              required:
                - data
              properties:
                data:
                  description: Contains the on demand test scan request data.
                  type: object
                  required:
                    - type
                    - attributes
                  properties:
                    type:
                      description: The resource type for on demand test scan.
                      type: string
                      enum:
                        - onDemandTestScanRequest
                      default: onDemandTestScanRequest
                    attributes:
                      description: Contains the on demand test scan request attributes.
                      type: object
                      required:
                        - backupId
                        - copyNumber
                        - scanHost
                        - scanHostPool
                      properties:
                        backupId:
                          type: string
                          description: Image backup id to be scanned for testing.
                        copyNumber:
                          type: integer
                          description: >-
                            Copy number of the backup id to be scanned for
                            testing.
                        scanHost:
                          type: integer
                          description: >-
                            Id of ScanHost on which malware scan of given backup
                            image must run.
                        scanHostPool:
                          type: integer
                          description: ScanHostPool for the onDemandRequest.
        description: The scan request details.
        required: true
      responses:
        '201':
          description: Successfully initiated malware test scan.
          headers:
            Location:
              description: The link to the newly added scan result of given backupId.
              schema:
                type: string
          content:
            application/vnd.netbackup+json;version=13.0:
              schema: &ref_70
                description: The on demand test scan response.
                type: object
                required:
                  - data
                properties:
                  data:
                    description: The response returns on demand test scan with scan result.
                    type: object
                    required:
                      - type
                      - id
                      - attributes
                      - relationships
                    properties:
                      type:
                        description: The response type.
                        type: string
                        enum:
                          - onDemandScanResponse
                        default: onDemandScanResponse
                      id:
                        description: The response identifier.
                        type: string
                      attributes:
                        description: Contains the on demand scan response attributes.
                        type: object
                        required:
                          - msg
                          - status
                        properties:
                          msg:
                            description: The response message.
                            type: string
                          status:
                            description: on demand test scan enum.
                            type: string
                            enum:
                              - SUCCESS
                              - FAIL
                            default: SUCCESS
                      relationships:
                        description: >-
                          Contains the resources related to the on demand scan
                          operation, such as `scanResult`.
                        type: object
                        required:
                          - scanResult
                        properties:
                          scanResult:
                            description: >-
                              Represents the scan result created by this on
                              demand scan operation.
                            type: object
                            required:
                              - links
                              - data
                            properties:
                              links:
                                description: >-
                                  Contains the links to get the scan result
                                  details.
                                type: object
                                required:
                                  - related
                                  - self
                                properties:
                                  related:
                                    description: Gets a list of scan results.
                                    type: array
                                    items: *ref_25
                                  self:
                                    description: >-
                                      Gets a list of details about this scan
                                      result.
                                    type: array
                                    items: *ref_25
                              data:
                                type: object
                                description: Contains the scan result data.
                                required:
                                  - type
                                  - id
                                properties:
                                  type:
                                    description: The resource type. Set to `scanResult`.
                                    type: string
                                  id:
                                    description: The scan result identifier.
                                    type: string
        '400': *ref_3
        '401': *ref_4
        '406': *ref_5
        '415': *ref_9
        '500': *ref_6
  /malware/cancel-scan-jobs:
    post:
      description: >
        Cancel the specified malware scan jobs.

         **Access Control**\
        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/11.0/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|MANAGE|MALWARE|`\

        Requires Operation: `|OPERATIONS|MANAGE|MALWARE|ON-DEMAND-SCAN|`
      tags:
        - Malware Cancel Scan Jobs
      requestBody:
        content:
          application/vnd.netbackup+json;version=13.0:
            schema: &ref_68
              description: The request that contains scan ids to be cancelled for scanning.
              type: object
              required:
                - data
              properties:
                data:
                  description: Contains the scan ids cancel request data.
                  type: object
                  required:
                    - type
                    - attributes
                  properties:
                    type:
                      description: The resource type for cancel scan.
                      type: string
                      enum:
                        - cancelScanJobRequest
                      default: cancelScanJobRequest
                    attributes:
                      description: Contains the scan ids cancel request attributes.
                      type: object
                      required:
                        - scanResultIds
                      properties:
                        scanResultIds:
                          type: array
                          items: &ref_72
                            description: The scan result id list.
                            type: object
                            properties:
                              scanResultId:
                                type: string
                          description: Scan result id list.
        description: The malware scan Cancellation request details.
        required: true
      responses:
        '200':
          description: Successfully cancelled the malware scan.
          headers:
            Location:
              description: The link to cancel the scan.
              schema:
                type: string
          content:
            application/vnd.netbackup+json;version=13.0:
              schema: &ref_69
                description: The cancel scan id response.
                type: object
                required:
                  - data
                properties:
                  data:
                    description: The response returns cancel scan id.
                    type: object
                    required:
                      - type
                      - id
                      - attributes
                    properties:
                      type:
                        description: The response type.
                        type: string
                        enum:
                          - cancelScanJobResponse
                        default: cancelScanJobResponse
                      id:
                        description: The response identifier.
                        type: string
                      attributes:
                        description: Contains the scan id cancel response attributes.
                        type: object
                        required:
                          - msg
                          - status
                        properties:
                          msg:
                            description: The response message.
                            type: string
                          status:
                            description: cancel id enum.
                            type: string
                            enum:
                              - SUCCESS
                              - FAIL
                              - PARTIAL_SUCCESSFUL
                            default: SUCCESS
        '400': *ref_3
        '401': *ref_4
        '406': *ref_5
        '415': *ref_9
        '500': *ref_6
  /malware/config:
    get:
      description: >
        Retrieves the malware detection configuration. 


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/11.0/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|MANAGE|MALWARE|CONFIG|`\

        Requires Operation: `|OPERATIONS|VIEW|`
      tags:
        - Malware Configuration
      responses:
        '200':
          description: Successfully retrieved malware detection configuration.
          content:
            application/vnd.netbackup+json;version=13.0:
              schema: &ref_78
                description: The response returns all the malware detection configurations.
                type: object
                properties:
                  data:
                    type: array
                    items: &ref_26
                      description: The response returns the malware configuration.
                      type: object
                      required:
                        - type
                        - id
                        - attributes
                      properties:
                        links:
                          type: object
                        type:
                          description: The malware configuration response.
                          type: string
                          enum:
                            - malwareConfig
                        id:
                          type: string
                          description: >-
                            The configuration key. This is a unique id mapped
                            per malware configuration.
                        attributes: &ref_79
                          type: object
                          properties:
                            configValue:
                              type: string
                              description: The value of the malware configuration.
                            configInfo:
                              type: object
                              description: Details of the malware configuration.
                              required:
                                - description
                                - displayName
                              properties:
                                description:
                                  type: string
                                  description: Description of the malware configuration.
                                displayName:
                                  type: string
                                  description: Display name of the malware configuration.
                            validationInfo:
                              type: object
                              description: >-
                                Validation information of the malware
                                configuration.
                              required:
                                - defaultValue
                                - dataType
                                - required
                                - readOnly
                              properties:
                                defaultValue:
                                  type: string
                                  description: Default value of the malware configuration.
                                dataType:
                                  type: string
                                  description: Data type of the malware configuration.
                                pattern:
                                  type: string
                                  description: >-
                                    Validation pattern (regex) for the malware
                                    configuration.
                                minValue:
                                  type: integer
                                  description: >-
                                    Specifies the minimum value for the malware
                                    configuration.
                                maxValue:
                                  type: integer
                                  description: >-
                                    Specifies the maximum value for the malware
                                    configuration.
                                required:
                                  type: boolean
                                  description: >-
                                    Indicates if malware configuration is
                                    required or not.
                                readOnly:
                                  type: boolean
                                  description: >-
                                    Indicates if malware configuration is read
                                    only.
                          required:
                            - configInfo
                            - validationInfo
                required:
                  - data
        '400': *ref_3
        '401': *ref_4
        '415': *ref_9
        '500': *ref_6
  '/malware/config/{configKey}':
    get:
      description: >
        Retrieves the malware detection configuration details for the specified
        configuration key.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/11.0/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|MANAGE|MALWARE|CONFIG|`\

        Requires Operation: `|OPERATIONS|VIEW|`
      tags:
        - Malware Configuration
      parameters:
        - name: configKey
          in: path
          description: The configuration key.
          required: true
          schema:
            type: string
      responses:
        '200':
          description: >-
            Successfully returned the malware detection configuration details
            for the specified configuration key.
          content:
            application/vnd.netbackup+json;version=13.0:
              schema: &ref_27
                type: object
                properties:
                  data: *ref_26
                required:
                  - data
        '401': *ref_4
        '404':
          description: The configuration key does not exist.
          content:
            application/vnd.netbackup+json;version=13.0:
              schema: *ref_2
        '415': *ref_9
        '500': *ref_6
    patch:
      description: >
        Updates the malware detection configuration.


        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/11.0/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `||MANAGE|MALWARE|CONFIG|`\

        Requires Operation: `|OPERATIONS|UPDATE|`
      tags:
        - Malware Configuration
      parameters:
        - name: configKey
          in: path
          description: The configuration key.
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/vnd.netbackup+json;version=13.0:
            schema: &ref_77
              description: Updates the malware detection configuration.
              type: object
              properties:
                data:
                  type: object
                  properties:
                    type:
                      type: string
                      description: update malware configuration.
                      enum:
                        - updateMalwareConfig
                    id:
                      type: string
                      description: The unique configuration key.
                    attributes:
                      type: object
                      properties:
                        configValue:
                          type: string
                          description: The value of the malware configuration.
                  required:
                    - type
                    - id
              required:
                - data
        required: true
      responses:
        '200':
          description: Successfully updated malware detection configuration.
          content:
            application/vnd.netbackup+json;version=13.0:
              schema: *ref_27
        '400': *ref_3
        '401': *ref_4
        '404':
          description: The configuration key does not exist.
          content:
            application/vnd.netbackup+json;version=13.0:
              schema: *ref_2
        '415': *ref_9
        '500': *ref_6
  /malware/forensics/on-demand-scan:
    post:
      description: >
        Create worklist item for forensics scan for given backupId and
        copyNumber.

         **Access Control**\
        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/11.0/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|MANAGE|FORENSIC|`\

        Requires Operation: `|OPERATIONS|MANAGE|FORENSIC|ON-DEMAND-SCAN|`
      tags:
        - Forensics On Demand Scan
      requestBody:
        content:
          application/vnd.netbackup+json;version=13.0:
            schema: *ref_28
        description: The scan request details.
        required: true
      responses:
        '201':
          description: Successfully added backupId for forensics Scan.
          headers:
            Location:
              description: The link to the newly added scan result of given backupId.
              schema:
                type: string
          content:
            application/vnd.netbackup+json;version=13.0:
              schema: *ref_29
        '400': *ref_3
        '401': *ref_4
        '406': *ref_5
        '415': *ref_9
        '500': *ref_6
  '/malware/forensics/status-scan/{id}/files':
    post:
      description: >
        Uploads infected or skipped file list for given worklistId.        

        **Access Control**\

        Enforcement Type:
        [API-Level](http://sort.veritas.com/public/documents/nbu/11.0/windowsandunix/productguides/html/getting-started#user-content-api-level-enforcement)\

        Namespace: `|FORENSIC|STATUS_SCAN|`\

        Requires Operation: `|OPERATIONS|FORENSIC|STATUS_SCAN|`
      tags:
        - Forensics Update On Status Scan
      parameters:
        - name: id
          in: path
          description: The unique worklist id
          required: true
          schema:
            type: string
      requestBody:
        content:
          multipart/vnd.netbackup+form-data;version=13.0:
            schema:
              type: object
              required:
                - data
                - file
              properties:
                data:
                  type: object
                  required:
                    - type
                    - attributes
                  properties:
                    type:
                      type: string
                      enum:
                        - infectedOrSkippedFileUploadRequest
                    attributes:
                      type: object
                      required:
                        - fileType
                      properties:
                        fileType:
                          description: >-
                            Whether the file contains infected or skipped file
                            details.
                          type: string
                          enum:
                            - infected
                            - skipped
                file:
                  description: >
                    The file contents csv data containing infected or skipped
                    files details.
                  type: string
                  format: binary
      responses:
        '204':
          description: Successfully updated scan result for forensic scan.
        '400': *ref_3
        '401': *ref_4
        '406': *ref_5
        '415': *ref_9
        '500': *ref_6
components:
  securitySchemes:
    apiKeyAuth:
      type: apiKey
      in: header
      name: Authorization
    cookieAuth:
      type: apiKey
      in: cookie
      name: Authorization
    jwtAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
  schemas:
    postScanHostResponse: *ref_30
    patchScanHostResponse: *ref_31
    validateScanHostResponse: *ref_32
    getScanHostIdResponse: *ref_33
    scanHostResponse: *ref_34
    updateScanHostResponse: *ref_35
    scanHostValidateResponse: *ref_36
    associatedTool: *ref_37
    associatedScanHostPool: *ref_38
    scanHostCreateRequest: *ref_39
    scanHostValidateRequest: *ref_40
    scanHostPool: *ref_1
    tool: *ref_0
    getAllScanHostResponse: *ref_41
    scanHostBaseResponse: *ref_7
    scanHostBaseAttributes: *ref_42
    scanHostRelationShips: *ref_43
    includedToolObj:
      type: array
      items: *ref_8
    includedTool: *ref_8
    updateScanHostRequest: *ref_44
    toolCreateRequest:
      type: object
      properties:
        data: &ref_45
          description: The request that contains the parameters to create the malware tool.
          type: object
          properties:
            type:
              type: string
              description: The resource type for the malware tool configuration.
              enum:
                - malwareTool
            attributes:
              type: object
              properties:
                malwareToolName:
                  type: string
                  description: malware tool name.
              required:
                - malwareToolName
          required:
            - type
            - attributes
      required:
        - data
    toolCreationRequest: *ref_45
    toolCreateResponse:
      type: object
      properties:
        data: *ref_46
      required:
        - data
    toolResponse: *ref_46
    getAllToolResponse: *ref_47
    scanHostPoolCreateRequest: *ref_48
    scanHostPoolRelation: *ref_17
    resultScanHostPoolRelation: *ref_49
    malwareToolRelation: *ref_15
    scanHostRelation: *ref_19
    parentScanResultRelation: *ref_50
    scanHostPoolRelations: *ref_20
    getScanHostPoolCreateResponse: *ref_51
    scanHostPoolCreateResponse: *ref_52
    scanHostPoolBaseResponse: *ref_18
    scanHostPoolBaseAttributes: *ref_16
    getAllScanHostPoolResponse: *ref_53
    getScanHostPoolResponse: *ref_54
    getScanHostIncludedResponse:
      type: array
      items: &ref_55
        description: The response returned the scan host configuration.
        type: object
        required:
          - type
          - id
          - attributes
        properties:
          type:
            description: The scan host creation response.
            type: string
            enum:
              - scanHost
          id:
            type: string
            description: >-
              The scan host id. This is a unique id mapped per Scan host
              configuration.
          attributes:
            description: The attributes of the scan host configuration creation response.
            type: object
            required:
              - hostName
              - state
            properties:
              hostName:
                type: string
                description: The unique name of the scan host.
              maxNoOfParallelScans:
                type: integer
                description: Specifies the number of parallel scans.
              state:
                type: string
                description: It indicate state of the scan Host if it is active or not.
                enum:
                  - ACTIVE
                  - INACTIVE
              scanHostCredentialName:
                type: string
                description: Shows the credential name for the scan host.
    scanHostIncludedResponse: *ref_55
    scanResultCreateRequest:
      description: The request that contains the parameters to create the scan result.
      type: object
      required:
        - data
      properties:
        data:
          type: object
          properties:
            type:
              type: string
              description: The resource type for the adding a scan result.
              enum:
                - scanResult
            attributes:
              type: object
              properties:
                scanState:
                  type: string
                  description: Indicates the state of a scanning job.
                  enum:
                    - PENDING
                    - SCAN_COMPLETED
                    - IN_PROGRESS
                    - SCAN_FAILED
                    - CANCELLED
                    - CANCEL_IN_PROGRESS
                    - SCAN_STARTED
                    - CLEANUP_IN_PROGRESS
                    - CANCELLATION_INITIATED
                scanResult:
                  type: string
                  description: Indicates the result of a scanning job.
                  enum:
                    - NOT_SCANNED
                    - IMPACTED
                    - CLEAN
                    - NOT_SUPPORTED
                  default: NOT_SCANNED
                policyType:
                  type: string
                  description: Policy Type.
                  enum:
                    - STANDARD
                    - MS-WINDOWS
                backupType:
                  type: string
                  description: Backup Type.
                  enum:
                    - FULL
                    - DIFFERENTIAL_INCREMENTAL
                    - CUMULATIVE_INCREMENTAL
                signature:
                  type: string
                  description: Malware tool signature details.
                displayName:
                  type: string
                  description: The display name of client.
                providerGeneratedId:
                  type: string
                  description: >-
                    The provider identifier, which is unique within the
                    workloadType context that is provided by the workload.
                client:
                  type: string
                  description: Client Name.
                backupTime:
                  type: integer
                  description: Backup Time.
              required:
                - scanState
                - scanResult
                - policyType
                - backupType
                - signature
                - client
                - backupTime
            relationships:
              type: object
              properties:
                malwareTool:
                  type: object
                  properties:
                    data: *ref_15
                scanHost:
                  type: object
                  properties:
                    data: *ref_19
          required:
            - type
            - attributes
            - relationships
    scanResultBaseResponse: *ref_21
    impactAnalysisResponseData: *ref_56
    impactAnalysisAttributes: *ref_57
    impactReportDetails: *ref_58
    impactReportSummary: *ref_59
    impactAnalysisHash: *ref_60
    impactAnalysisClient: *ref_61
    impactAnalysisClientImages: *ref_62
    impactAnalysisClientBackupFileDetails: *ref_63
    getScanResultBaseResponse:
      description: The response returns the scan result data.
      type: object
      required:
        - type
        - id
        - attributes
        - links
      properties:
        links:
          type: object
        type:
          description: The scan result response.
          type: string
          enum:
            - scanResult
        id:
          type: string
          description: The scan result id. This is a unique id mapped per scan result.
        attributes: *ref_64
        relationships: *ref_17
    scanResultBaseAttributes: *ref_64
    scanResultSummary:
      description: The on demand scan response.
      type: object
      required:
        - data
      properties:
        data:
          description: The response returns on demand scan with scan result.
          type: object
          required:
            - type
            - id
            - attributes
          properties:
            type:
              type: string
              enum:
                - scanResultSummary
            id:
              type: string
              description: Unique identifier for the response
            attributes:
              description: >-
                The object contains scanCountByStatus list which includes scan
                result and it's count in each item.
              type: object
              required:
                - scanCountByStatus
              properties:
                scanCountByStatus:
                  description: >-
                    List of scan statuses with total count of it over given
                    period of time
                  type: array
                  items: &ref_73
                    description: The response returns list of scan status with count info.
                    type: object
                    required:
                      - scanStatus
                      - totalCount
                    properties:
                      scanStatus:
                        type: string
                        enum:
                          - CLEAN
                          - IMPACTED
                          - NOT_SCANNED
                          - PENDING
                          - SCAN_COMPLETED
                          - IN_PROGRESS
                          - SCAN_FAILED
                      totalCount:
                        type: integer
                        description: >-
                          Total count of scan statuses representing count over
                          queried period.
    getScanResultResponse:
      description: >-
        The response returns the details of a scan result that is present in the
        database for the specified scan result Id.
      type: object
      properties:
        data: *ref_21
      required:
        - data
    getScanResultByIdResponse: *ref_65
    getInfectedFilesByMalwareJobIdResponse:
      description: >-
        The response returns list of infected files for the specified malware
        job id.
      type: object
      properties:
        data:
          type: object
          required:
            - type
            - id
            - attributes
          properties:
            type:
              type: string
              enum:
                - infectedFiles
            id:
              type: string
              description: The specified malware job id
            attributes:
              description: The object contains infected file list based on malware job id
              type: object
              required:
                - infectedFiles
              properties:
                infectedFiles:
                  type: array
                  items:
                    type: string
    getAllScanResultResponse: *ref_23
    getImpactAnalysisResponse: *ref_66
    updateScanResultRequest:
      description: The request that contains the parameters to update the scan result.
      type: object
      properties:
        data:
          type: object
          properties:
            type:
              type: string
              description: update can scan result configuration.
              enum:
                - scanPatchResult
            id:
              type: string
              description: >-
                The scan result id. This is a unique id mapped per scan result
                configuration.
            attributes:
              type: object
              properties:
                scanState:
                  type: string
                  description: Indicates the state of a scanning job.
                  enum:
                    - PENDING
                    - SCAN_COMPLETED
                    - IN_PROGRESS
                    - SCAN_FAILED
                    - CANCELLED
                    - CANCEL_IN_PROGRESS
                    - SCAN_STARTED
                    - CLEANUP_IN_PROGRESS
                    - CANCELLATION_INITIATED
                scanResult:
                  type: string
                  description: Indicates the result of a scanning job.
                  enum:
                    - NOT_SCANNED
                    - IMPACTED
                    - CLEAN
                    - NOT_SUPPORTED
                dateOfScan:
                  type: string
                  description: Date of scan.
                numberOfFilesImpacted:
                  type: integer
                  description: No of Files Impacted.
                result:
                  type: string
                  description: Detailed scan result.
                signature:
                  type: string
                  description: Malware tool signature details.
          required:
            - type
            - id
      required:
        - data
    onDemandScanRequest: *ref_28
    onDemandTestScanRequest: *ref_67
    cancelJobRequest: *ref_68
    cancelJobResponse: *ref_69
    onDemandTestScanResponse: *ref_70
    onDemandScanResponse: *ref_29
    onDemandScanBackupIds: *ref_71
    scanResultIds: *ref_72
    onDemandScanRelatedAndSelfLinks: *ref_25
    scanStatusRequest:
      description: >-
        The request that contains status, scanResult, numberOfFilesImpacted,
        malwareToolSignature and result to be updated on scan result based on
        worklistId.
      type: object
      required:
        - data
      properties:
        data:
          description: Contains the on scan status request data.
          type: object
          required:
            - type
            - attributes
          properties:
            type:
              description: The resource type for scan status.
              type: string
              enum:
                - scanStatusRequest
              default: scanStatusRequest
            attributes:
              description: Contains the on scan status request attributes.
              type: object
              required:
                - worklistId
                - status
                - scanResult
                - numberOfFilesImpacted
                - malwareToolSignature
                - result
              properties:
                worklistId:
                  type: string
                  description: Work List id.
                status:
                  type: string
                  description: ScanStateEnum for representing change in worklist status
                  enum:
                    - PENDING
                    - SCAN_COMPLETED
                    - IN_PROGRESS
                    - SCAN_FAILED
                    - MOUNT_FAILED
                scanResult:
                  type: string
                  description: Indicates the result of a scanning job.
                  enum:
                    - NOT_SCANNED
                    - IMPACTED
                    - CLEAN
                  default: NOT_SCANNED
                numberOfFilesImpacted:
                  type: integer
                  description: value for representing no of files affected in scan.
                malwareToolSignature:
                  type: string
                  description: Indicates the signature to be updated in scan result.
                result:
                  type: string
                  description: Indicates the final result of a scanning job.
                numberOfFilesScanned:
                  type: integer
                  description: >-
                    Indicates the scan progress by showing number of files
                    scanned.
                retry:
                  type: boolean
                  description: >-
                    Indicates whether scan is retryable due to configuration
                    issues.
                malwareInfo:
                  type: string
                  description: Information related to Malware identified in infected files.
    scanStatusResponse:
      description: The scan status response.
      type: object
      required:
        - data
      properties:
        data:
          description: The response returns on scan status with scan result.
          type: object
          required:
            - type
            - id
            - attributes
            - relationships
          properties:
            type:
              description: The response type.
              type: string
              enum:
                - scanStatusResponse
              default: scanStatusResponse
            id:
              description: The response identifier.
              type: string
            attributes:
              description: Contains the scan status response attributes.
              type: object
              required:
                - msg
              properties:
                msg:
                  description: The response message.
                  type: string
            relationships:
              description: >-
                Contains the resources related to the scan status operation,
                such as `scanResult`.
              type: object
              required:
                - scanResult
              properties:
                scanResult:
                  description: >-
                    Represents the scan result created by this scan status
                    operation.
                  type: object
                  required:
                    - links
                    - data
                  properties:
                    links:
                      description: Contains the links to get the scan result details.
                      type: object
                      required:
                        - self
                        - related
                      properties:
                        self:
                          description: Gets the details about this scan result.
                          type: string
                        related:
                          description: Gets a list of scan results.
                          type: string
                    data:
                      type: object
                      description: Contains the scan result data.
                      required:
                        - type
                        - id
                      properties:
                        type:
                          description: The resource type. Set to `scanResult`.
                          type: string
                        id:
                          description: The scan result identifier.
                          type: string
    scanCountByStatus: *ref_73
    malwareScanJobResponse:
      description: The malware scan job response.
      type: object
      required:
        - data
        - relationships
      properties:
        data:
          description: Contains the malware scan job response data.
          type: object
          required:
            - type
            - id
            - attributes
          properties:
            type:
              description: The response type.
              type: string
              default: malwareScanJobResponse
            id:
              description: The response identifier.
              type: integer
              format: int64
            attributes:
              description: Contains the malware scan job response attributes.
              type: object
              required:
                - msg
              properties:
                msg:
                  description: The response message.
                  type: string
        relationships:
          description: >-
            Contains the resources related to the malware scan job, such as
            `malwareScanJob`.
          type: object
          required:
            - malwareScanJob
          properties:
            malwareScanJob:
              description: >-
                Represents the malware scan job created by this scan and
                recovery operation.
              type: object
              required:
                - links
                - data
              properties:
                links:
                  description: Contains the links to get the job details.
                  type: object
                  required:
                    - self
                    - related
                  properties:
                    self:
                      description: Gets the details about this malware scan job.
                      type: string
                    related:
                      description: Gets a list of recent jobs.
                      type: string
                data:
                  type: object
                  description: Contains the malware scan job data.
                  required:
                    - type
                    - id
                  properties:
                    type:
                      description: The resource type. Set to `job`.
                      type: string
                    id:
                      description: The job identifier.
                      type: integer
                      format: int64
      example:
        data:
          type: malwareScanJobResponse
          id: 12
          attributes:
            msg: Successfully created malware scan job.
        relationships:
          malwareScanJob:
            links:
              related: /admin/jobs
              self: /admin/jobs/12
            data:
              type: job
              id: 12
    getAllMalwareJobResponse: *ref_74
    getMalwareJobByIdResponse: *ref_75
    malwareJobBaseResponse: *ref_14
    malwareJobBaseAttributes: *ref_76
    preCheckRequest:
      description: The request that contains list of backup ids.
      type: object
      required:
        - data
      properties:
        data:
          description: Contains the pre-check request data.
          type: object
          required:
            - type
            - attributes
          properties:
            type:
              description: The resource type for pre-check.
              type: string
              enum:
                - preCheckRequest
            attributes:
              description: Contains the pre-check request attributes.
              type: object
              properties:
                backupIds:
                  type: array
                  description: List of backup ids for pre-check.
                  items:
                    type: string
                    description: backup id to be scanned.
    updateMalwareConfigRequest: *ref_77
    getMalwareConfigByKeyResponse: *ref_27
    getAllMalwareConfigResponse: *ref_78
    MalwareConfigBaseResponse: *ref_26
    malwareConfigBaseAttributes: *ref_79
    preCheckResponse:
      description: >-
        The response returns the list of backup ids against its instant access
        compatibility.
      type: object
      required:
        - data
      properties:
        data:
          description: Contains the pre-check response data.
          type: object
          required:
            - type
            - id
            - attributes
          properties:
            type:
              description: The resource type for pre-check.
              type: string
              enum:
                - preCheckResponse
            id:
              type: string
              description: The pre-check response id.
            attributes:
              description: Contains the pre-check response attributes.
              type: object
              properties:
                backupIdResult:
                  type: array
                  description: List of backup ids along with status.
                  items:
                    type: object
                    description: >-
                      Pre-check response object containing backup id and its
                      status.
                    properties:
                      backupId:
                        type: string
                        description: backup id to be scanned.
                      status:
                        type: string
                        description: instant access compatible status.
                        enum:
                          - IA_COMPATIBLE
                          - IA_INCOMPATIBLE
                          - NOT_FOUND
    scanAndRecoverAdditionalAttributes:
      description: Additional attributes for scan and recover.
      type: object
      required:
        - client
        - policyType
      properties:
        id:
          type: integer
          description: Scan and recover identifier.
        client:
          type: string
          description: Client name.
        policyType:
          type: string
          description: Policy type.
        startDate:
          type: string
          description: Start date of the recovery date range.
        endDate:
          type: string
          description: End date of the recovery date range.
        recoveryPoint:
          type: string
          description: The recovery point identifier.
  parameters:
    scanResultId: *ref_22
security:
  - apiKeyAuth: []
  - cookieAuth: []
  - jwtAuth: []
